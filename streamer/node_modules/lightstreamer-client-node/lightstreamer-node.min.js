/**
 * @preserve
 * LIGHTSTREAMER - www.lightstreamer.com
 * Lightstreamer Node.js Client
 * Version 9.2.2+20250131
 * Copyright (c) Lightstreamer Srl. All Rights Reserved.
 * Contains: LightstreamerClient, Subscription, ConsoleLogLevel,
 * ConsoleLoggerProvider, Logger, LoggerProvider, ClientListener,
 * ClientMessageListener, ItemUpdate, SubscriptionListener
 * CJS
 */
"use strict";var t=function(){};t.prototype={fatal:function(t,e){},isFatalEnabled:function(){},error:function(t,e){},isErrorEnabled:function(){},warn:function(t,e){},isWarnEnabled:function(){},info:function(t,e){},isInfoEnabled:function(){},debug:function(t,e){},isDebugEnabled:function(){},trace:function(t,e){},isTraceEnabled:function(){}};var e=function(){};function s(){}function i(){}e.prototype={getLogger:function(t){}},s.prototype={onServerError:function(t,e){},onStatusChange:function(t){},onPropertyChange:function(t){},onListenStart:function(){},onListenEnd:function(){}},i.prototype={onAbort:function(t,e){},onError:function(t){},onDiscarded:function(t){},onDeny:function(t,e,s){},onProcessed:function(t,e){}};var n=function(){};n.prototype={getItemName:function(){},getItemPos:function(){},getValue:function(t){},getValueAsJSONPatchIfAvailable:function(t){return null},isValueChanged:function(t){},isSnapshot:function(){},forEachChangedField:function(t){},forEachField:function(t){}};var r=function(){};r.prototype={onItemUpdate:function(t){},onItemLostUpdates:function(t,e,s){},onCommandSecondLevelItemLostUpdates:function(t,e){},onEndOfSnapshot:function(t,e){},onClearSnapshot:function(t,e){},onSubscription:function(){},onUnsubscription:function(){},onSubscriptionError:function(t,e){},onCommandSecondLevelSubscriptionError:function(t,e,s){},onListenStart:function(){},onListenEnd:function(){},onRealMaxFrequency:function(t){}};var a={};!function(s){var i,o=function(){return ls.__string_rec(this,"")},h=h||{};function c(t,e){var s=Object.create(t);for(var i in e)s[i]=e[i];return e.toString!==Object.prototype.toString&&(s.toString=e.toString),s}var l=function(t,e){this.r=new RegExp(t,e.split("u").join(""))};l.__name__=!0,l.prototype={match:function(t){return this.r.global&&(this.r.lastIndex=0),this.r.m=this.r.exec(t),this.r.s=t,null!=this.r.m},__class__:l};var u=function(){};u.__name__=!0,u.dateStr=function(t){var e=t.getMonth()+1,s=t.getDate(),i=t.getHours(),n=t.getMinutes(),r=t.getSeconds();return t.getFullYear()+"-"+(e<10?"0"+e:""+e)+"-"+(s<10?"0"+s:""+s)+" "+(i<10?"0"+i:""+i)+":"+(n<10?"0"+n:""+n)+":"+(r<10?"0"+r:""+r)},u.cca=function(t,e){var s=t.charCodeAt(e);if(s==s)return s},u.substr=function(t,e,s){if(null==s)s=t.length;else if(s<0){if(0!=e)return"";s=t.length+s}return t.substr(e,s)},u.remove=function(t,e){var s=t.indexOf(e);return-1!=s&&(t.splice(s,1),!0)},u.now=function(){return Date.now()};var _=function(t,e){this.min=t,this.max=e};_.__name__=!0,_.prototype={hasNext:function(){return this.min<this.max},next:function(){return this.min++},__class__:_};var d=function(){};d.__name__=!0,d.has=function(t,e){for(var s=ms(t);s.hasNext();)if(s.next()==e)return!0;return!1},d.exists=function(t,e){for(var s=ms(t);s.hasNext();)if(e(s.next()))return!0;return!1},d.count=function(t,e){var s=0;if(null==e)for(var i=ms(t);i.hasNext();)i.next(),++s;else for(var n=ms(t);n.hasNext();)e(n.next())&&++s;return s},d.empty=function(t){return!ms(t).hasNext()},d.find=function(t,e){for(var s=ms(t);s.hasNext();){var i=s.next();if(e(i))return i}return null},Math.__name__=!0;var f=function(){};f.__name__=!0,f.field=function(t,e){try{return t[e]}catch(t){return null}},f.fields=function(t){var e=[];if(null!=t){var s=Object.prototype.hasOwnProperty;for(var i in t)"__id__"!=i&&"hx__closures__"!=i&&s.call(t,i)&&e.push(i)}return e},f.copy=function(t){if(null==t)return null;for(var e={},s=0,i=f.fields(t);s<i.length;){var n=i[s];++s,e[n]=f.field(t,n)}return e};var m=function(){};m.__name__=!0,m.string=function(t){return ls.__string_rec(t,"")},m.parseInt=function(t){var e=parseInt(t);return isNaN(e)?null:e},m.random=function(t){return t<=0?0:Math.floor(Math.random()*t)};var g=function(){this.b=""};g.__name__=!0,g.prototype={__class__:g};var p=function(){};p.__name__=!0,p.startsWith=function(t,e){return t.length>=e.length&&0==t.lastIndexOf(e,0)},p.endsWith=function(t,e){var s=e.length,i=t.length;return i>=s&&t.indexOf(e,i-s)==i-s},p.isSpace=function(t,e){var s=u.cca(t,e);return s>8&&s<14||32==s},p.ltrim=function(t){for(var e=t.length,s=0;s<e&&p.isSpace(t,s);)++s;return s>0?u.substr(t,s,e-s):t},p.rtrim=function(t){for(var e=t.length,s=0;s<e&&p.isSpace(t,e-s-1);)++s;return s>0?u.substr(t,0,e-s):t},p.trim=function(t){return p.ltrim(p.rtrim(t))},p.replace=function(t,e,s){return t.split(e).join(s)};var v=function(){};v.__name__=!0,v.enumEq=function(t,e){if(t==e)return!0;try{var s=t.__enum__;if(null==s||s!=e.__enum__)return!1;if(t._hx_index!=e._hx_index)return!1;for(var i=h[s].__constructs__[t._hx_index].__params__,n=0;n<i.length;){var r=i[n];if(++n,!v.enumEq(t[r],e[r]))return!1}}catch(n){return!1}return!0};var S=a.LSConnectionDetails=function(t){this.serverAddress=ws,this.client=t,this.lock=t.lock};S.__name__=!0,S.prototype={getServerAddress:function(){return this.serverAddress},setServerAddress:function(t){var e=ye.fromString(t);if(e!=this.serverAddress){Fs.isInfoEnabled()&&Fs.info("serverAddress changed: "+e);var s=this.serverAddress;this.serverAddress=e,this.client.eventDispatcher.onPropertyChange("serverAddress"),s!=e&&this.client.machine.evtServerAddressChanged()}},getAdapterSet:function(){return this.adapterSet},setAdapterSet:function(t){t!=this.adapterSet&&(Fs.isInfoEnabled()&&Fs.info("adapterSet changed: "+t),this.adapterSet=t,this.client.eventDispatcher.onPropertyChange("adapterSet"))},getUser:function(){return this.user},setUser:function(t){t!=this.user&&(Fs.isInfoEnabled()&&Fs.info("user changed: "+t),this.user=t,this.client.eventDispatcher.onPropertyChange("user"))},setPassword:function(t){t!=this.password&&(Fs.isInfoEnabled()&&Fs.info("password changed"),this.password=t,this.client.eventDispatcher.onPropertyChange("password"))},getSessionId:function(){return this.sessionId},setSessionId:function(t){t!=this.sessionId&&(this.sessionId=t,this.client.eventDispatcher.onPropertyChange("sessionId"))},getServerInstanceAddress:function(){return this.serverInstanceAddress},setServerInstanceAddress:function(t){t!=this.serverInstanceAddress&&(this.serverInstanceAddress=t,this.client.eventDispatcher.onPropertyChange("serverInstanceAddress"))},getServerSocketName:function(){return this.serverSocketName},setServerSocketName:function(t){t!=this.serverSocketName&&(this.serverSocketName=t,this.client.eventDispatcher.onPropertyChange("serverSocketName"))},getClientIp:function(){return this.clientIp},setClientIp:function(t){t!=this.clientIp&&(this.clientIp=t,this.client.eventDispatcher.onPropertyChange("clientIp"))},toString:function(){var t=Ht._new();return Ht.set(t,"serverAddress",this.serverAddress),Ht.set(t,"adapterSet",this.adapterSet),Ht.set(t,"user",this.user),Ht.set(t,"sessionId",this.sessionId),Ht.set(t,"serverInstanceAddress",this.serverInstanceAddress),Ht.set(t,"serverSocketName",this.serverSocketName),Ht.set(t,"clientIp",this.clientIp),Ht.set(t,"libVersion",w.LIB_NAME+" "+w.LIB_VERSION),is.stringify(t.h)},__class__:S};var y=a.LSConnectionOptions=function(t){this.cookieHandlingRequired=!1,this.slowingEnabled=!1,this.serverInstanceAddressIgnored=!1,this.httpExtraHeadersOnSessionCreationOnly=!1,this.stalledTimeout=2e3,this.sessionRecoveryTimeout=15e3,this.reverseHeartbeatInterval=0,this.retryDelay=4e3,this.reconnectTimeout=3e3,this.pollingInterval=0,this.realMaxBandwidth=null,this.requestedMaxBandwidth=be.BWUnlimited,this.keepaliveInterval=0,this.idleTimeout=19e3,this.httpExtraHeaders=null,this.forcedTransport=null,this.firstRetryMaxDelay=100,this.contentLength=5e7,this.client=t,this.lock=t.lock};y.__name__=!0,y.prototype={getContentLength:function(){return this.contentLength},setContentLength:function(t){var e=ve.fromIntGt0(t);e!=this.contentLength&&(Fs.isInfoEnabled()&&Fs.info("contentLength changed: "+e),this.contentLength=e,this.client.eventDispatcher.onPropertyChange("contentLength"))},getFirstRetryMaxDelay:function(){return this.firstRetryMaxDelay},setFirstRetryMaxDelay:function(t){var e=pe.fromIntGt0(t);e!=this.firstRetryMaxDelay&&(Fs.isInfoEnabled()&&Fs.info("firstRetryMaxDelay changed: "+e),this.firstRetryMaxDelay=e,this.client.eventDispatcher.onPropertyChange("firstRetryMaxDelay"))},getForcedTransport:function(){return this.forcedTransport},setForcedTransport:function(t){var e=Se.fromString(t);e!=this.forcedTransport&&(Fs.isInfoEnabled()&&Fs.info("forcedTransport changed: "+e),this.forcedTransport=e,this.client.eventDispatcher.onPropertyChange("forcedTransport"),this.client.machine.evtExtSetForcedTransport())},getHttpExtraHeaders:function(){return null==this.httpExtraHeaders?null:Qt.fromMapToDynamicAccess(this.httpExtraHeaders)},setHttpExtraHeaders:function(t){var e=null!=t?Qt.toHaxe(t):null;this.mapEq(e,this.httpExtraHeaders)||(Fs.isInfoEnabled()&&Fs.info("httpExtraHeaders changed: "+(null==e?"null":is.stringify(e.h))),this.httpExtraHeaders=e,this.client.eventDispatcher.onPropertyChange("httpExtraHeaders"))},mapEq:function(t,e){if(t==e)return!0;if(null==t||null==e)return!1;if(d.count(t)!=d.count(e))return!1;for(var s=t.h,i=Object.keys(s),n=i.length,r=0;r<n;){var a=i[r++];if(s[a]!=e.h[a])return!1}return!0},getIdleTimeout:function(){return this.idleTimeout},setIdleTimeout:function(t){var e=pe.fromIntGtEq0(t);e!=this.idleTimeout&&(Fs.isInfoEnabled()&&Fs.info("idleTimeout changed: "+e),this.idleTimeout=e,this.client.eventDispatcher.onPropertyChange("idleTimeout"))},getKeepaliveInterval:function(){return this.keepaliveInterval},setKeepaliveInterval:function(t){var e=pe.fromIntGtEq0(t);e!=this.keepaliveInterval&&(Fs.isInfoEnabled()&&Fs.info("keepaliveInterval changed: "+e),this.keepaliveInterval=e,this.client.eventDispatcher.onPropertyChange("keepaliveInterval"))},getRequestedMaxBandwidth:function(){return Ee.toString(this.requestedMaxBandwidth)},setRequestedMaxBandwidth:function(t){null!=t&&(t=null==t?"null":""+t);var e=Ee.fromString(t);v.enumEq(e,this.requestedMaxBandwidth)||(Fs.isInfoEnabled()&&Fs.info("requestedMaxBandwidth changed: "+Ee.toString(e)),this.requestedMaxBandwidth=e,this.client.eventDispatcher.onPropertyChange("requestedMaxBandwidth"),this.client.machine.evtExtSetRequestedMaxBandwidth())},getRealMaxBandwidth:function(){return Ne.toString(this.realMaxBandwidth)},setRealMaxBandwidth:function(t){Ne.eq(t,this.realMaxBandwidth)||(this.realMaxBandwidth=t,this.client.eventDispatcher.onPropertyChange("realMaxBandwidth"))},getPollingInterval:function(){return this.pollingInterval},setPollingInterval:function(t){var e=pe.fromIntGtEq0(t);e!=this.pollingInterval&&(Fs.isInfoEnabled()&&Fs.info("pollingInterval changed: "+e),this.pollingInterval=e,this.client.eventDispatcher.onPropertyChange("pollingInterval"))},getReconnectTimeout:function(){return this.reconnectTimeout},setReconnectTimeout:function(t){var e=pe.fromIntGt0(t);e!=this.reconnectTimeout&&(Fs.isInfoEnabled()&&Fs.info("reconnectTimeout changed: "+e),this.reconnectTimeout=e,this.client.eventDispatcher.onPropertyChange("reconnectTimeout"))},getRetryDelay:function(){return this.retryDelay},setRetryDelay:function(t){var e=pe.fromIntGt0(t);e!=this.retryDelay&&(Fs.isInfoEnabled()&&Fs.info("retryDelay changed: "+e),this.retryDelay=e,this.client.eventDispatcher.onPropertyChange("retryDelay"))},getReverseHeartbeatInterval:function(){return this.reverseHeartbeatInterval},setReverseHeartbeatInterval:function(t){var e=pe.fromIntGtEq0(t);e!=this.reverseHeartbeatInterval&&(Fs.isInfoEnabled()&&Fs.info("reverseHeartbeatInterval changed: "+e),this.reverseHeartbeatInterval=e,this.client.eventDispatcher.onPropertyChange("reverseHeartbeatInterval"),this.client.machine.evtExtSetReverseHeartbeatInterval())},getSessionRecoveryTimeout:function(){return this.sessionRecoveryTimeout},setSessionRecoveryTimeout:function(t){var e=pe.fromIntGtEq0(t);e!=this.sessionRecoveryTimeout&&(Fs.isInfoEnabled()&&Fs.info("sessionRecoveryTimeout changed: "+e),this.sessionRecoveryTimeout=e,this.client.eventDispatcher.onPropertyChange("sessionRecoveryTimeout"))},getStalledTimeout:function(){return this.stalledTimeout},setStalledTimeout:function(t){var e=pe.fromIntGt0(t);e!=this.stalledTimeout&&(Fs.isInfoEnabled()&&Fs.info("stalledTimeout changed: "+e),this.stalledTimeout=e,this.client.eventDispatcher.onPropertyChange("stalledTimeout"))},isHttpExtraHeadersOnSessionCreationOnly:function(){return this.httpExtraHeadersOnSessionCreationOnly},setHttpExtraHeadersOnSessionCreationOnly:function(t){t!=this.httpExtraHeadersOnSessionCreationOnly&&(Fs.isInfoEnabled()&&Fs.info("httpExtraHeadersOnSessionCreationOnly changed: "+(null==t?"null":""+t)),this.httpExtraHeadersOnSessionCreationOnly=t,this.client.eventDispatcher.onPropertyChange("httpExtraHeadersOnSessionCreationOnly"))},isServerInstanceAddressIgnored:function(){return this.serverInstanceAddressIgnored},setServerInstanceAddressIgnored:function(t){t!=this.serverInstanceAddressIgnored&&(Fs.isInfoEnabled()&&Fs.info("serverInstanceAddressIgnored changed: "+(null==t?"null":""+t)),this.serverInstanceAddressIgnored=t,this.client.eventDispatcher.onPropertyChange("serverInstanceAddressIgnored"))},setCookieHandlingRequired:function(t){t!=this.cookieHandlingRequired&&(Fs.isInfoEnabled()&&Fs.info("cookieHandlingRequired changed: "+(null==t?"null":""+t)),this.cookieHandlingRequired=t,this.client.eventDispatcher.onPropertyChange("cookieHandlingRequired"))},isCookieHandlingRequired:function(){return this.cookieHandlingRequired},isSlowingEnabled:function(){return this.slowingEnabled},setSlowingEnabled:function(t){t!=this.slowingEnabled&&(Fs.isInfoEnabled()&&Fs.info("slowingEnabled changed: "+(null==t?"null":""+t)),this.slowingEnabled=t,this.client.eventDispatcher.onPropertyChange("slowingEnabled"))},toString:function(){var t=Ht._new();return Ht.set(t,"forcedTransport",this.forcedTransport),Ht.set(t,"requestedMaxBandwidth",this.requestedMaxBandwidth),Ht.set(t,"realMaxBandwidth",this.realMaxBandwidth),Ht.set(t,"retryDelay",this.retryDelay),Ht.set(t,"firstRetryMaxDelay",this.firstRetryMaxDelay),Ht.set(t,"sessionRecoveryTimeout",this.sessionRecoveryTimeout),Ht.set(t,"reverseHeartbeatInterval",this.reverseHeartbeatInterval),Ht.set(t,"stalledTimeout",this.stalledTimeout),Ht.set(t,"reconnectTimeout",this.reconnectTimeout),Ht.set(t,"keepaliveInterval",this.keepaliveInterval),Ht.set(t,"pollingInterval",this.pollingInterval),Ht.set(t,"idleTimeout",this.idleTimeout),Ht.set(t,"contentLength",this.contentLength),Ht.set(t,"slowingEnabled",this.slowingEnabled),Ht.set(t,"serverInstanceAddressIgnored",this.serverInstanceAddressIgnored),Ht.set(t,"HTTPExtraHeadersOnSessionCreationOnly",this.httpExtraHeadersOnSessionCreationOnly),Ht.set(t,"HTTPExtraHeaders",this.httpExtraHeaders),Ht.set(t,"cookieHandlingRequired",this.cookieHandlingRequired),is.stringify(t.h)},__class__:y};var b=function(){this.listeners=[]};b.__name__=!0,b.prototype={addListener:function(t){return-1==this.listeners.indexOf(t)&&(this.listeners.push(t),!0)},removeListener:function(t){return u.remove(this.listeners,t)},getListeners:function(){return this.listeners},dispatchToAll:function(t){for(var e=0,s=this.listeners;e<s.length;)this.dispatchToOne(s[e++],t)},dispatchToOne:function(t,e){global.setImmediate((function(){try{e(t)}catch(t){var s=Gt.caught(t);Fs.isErrorEnabled()&&Fs.error("Uncaught exception\n"+s.details())}}))},__class__:b};var E=function(){b.call(this)};E.__name__=!0,E.__super__=b,E.prototype=c(b.prototype,{removeListenerAndFireOnListenEnd:function(t,e){this.removeListener(t)&&this.dispatchToOne(t,(function(t){null!=t.onListenEnd&&t.onListenEnd(e)}))},addListenerAndFireOnListenStart:function(t,e){this.addListener(t)&&this.dispatchToOne(t,(function(t){null!=t.onListenStart&&t.onListenStart(e)}))},onServerError:function(t,e){this.dispatchToAll((function(s){null!=s.onServerError&&s.onServerError(t,e)}))},onStatusChange:function(t){this.dispatchToAll((function(e){null!=e.onStatusChange&&e.onStatusChange(t)}))},onPropertyChange:function(t){this.dispatchToAll((function(e){null!=e.onPropertyChange&&e.onPropertyChange(t)}))},__class__:E});var w=a.LSLightstreamerClient=function(t,e){this.lock=new oe,this.eventDispatcher=new E,this.connectionDetails=new S(this),this.connectionOptions=new y(this),this.machine=new L(this,new ae(this)),null!=t&&this.connectionDetails.setServerAddress(t),null!=e&&this.connectionDetails.setAdapterSet(e)};w.__name__=!0,w.setLoggerProvider=function(t){Ye.setLoggerProvider(t)},w.addCookies=function(t,e){Mt.instance.addCookies(t,e)},w.getCookies=function(t){return Mt.instance.getCookies(t)},w.prototype={addListener:function(t){this.eventDispatcher.addListenerAndFireOnListenStart(t,this)},removeListener:function(t){this.eventDispatcher.removeListenerAndFireOnListenEnd(t,this)},getListeners:function(){return this.eventDispatcher.getListeners().slice()},connect:function(){this.machine.connect()},disconnect:function(){this.machine.disconnect()},getStatus:function(){return this.machine.getStatus()},sendMessage:function(t,e,s,i,n){null==n&&(n=!1),null==s&&(s=-1),this.machine.sendMessage(t,e,null!=s?s:-1,i,null!=n&&n)},subscribe:function(t){this.machine.subscribeExt(t)},unsubscribe:function(t){this.machine.unsubscribe(t)},getSubscriptions:function(){return this.machine.getSubscriptions().slice()},getSubscriptionWrappers:function(){for(var t=[],e=0,s=this.machine.getSubscriptions();e<s.length;){var i=s[e];++e,null!=i.wrapper&&t.push(i.wrapper)}return t.slice()},__class__:w};var T=h["com.lightstreamer.client._Subscription.SubscriptionState"]={__ename__:!0,__constructs__:null,Inactive:{_hx_name:"Inactive",_hx_index:0,__enum__:"com.lightstreamer.client._Subscription.SubscriptionState",toString:o},Active:{_hx_name:"Active",_hx_index:1,__enum__:"com.lightstreamer.client._Subscription.SubscriptionState",toString:o},Subscribed:{_hx_name:"Subscribed",_hx_index:2,__enum__:"com.lightstreamer.client._Subscription.SubscriptionState",toString:o}};T.__constructs__=[T.Inactive,T.Active,T.Subscribed];var R=function(){b.call(this)};R.__name__=!0,R.__super__=b,R.prototype=c(b.prototype,{onClearSnapshot:function(t,e){this.dispatchToAll((function(s){null!=s.onClearSnapshot&&s.onClearSnapshot(t,e)}))},onCommandSecondLevelItemLostUpdates:function(t,e){this.dispatchToAll((function(s){null!=s.onCommandSecondLevelItemLostUpdates&&s.onCommandSecondLevelItemLostUpdates(t,e)}))},onCommandSecondLevelSubscriptionError:function(t,e,s){this.dispatchToAll((function(i){null!=i.onCommandSecondLevelSubscriptionError&&i.onCommandSecondLevelSubscriptionError(t,e,s)}))},onEndOfSnapshot:function(t,e){this.dispatchToAll((function(s){null!=s.onEndOfSnapshot&&s.onEndOfSnapshot(t,e)}))},onItemLostUpdates:function(t,e,s){this.dispatchToAll((function(i){null!=i.onItemLostUpdates&&i.onItemLostUpdates(t,e,s)}))},onItemUpdate:function(t){this.dispatchToAll((function(e){null!=e.onItemUpdate&&e.onItemUpdate(t)}))},removeListenerAndFireOnListenEnd:function(t,e){this.removeListener(t)&&this.dispatchToOne(t,(function(t){null!=t.onListenEnd&&t.onListenEnd(e)}))},addListenerAndFireOnListenStart:function(t,e){this.addListener(t)&&this.dispatchToOne(t,(function(t){null!=t.onListenStart&&t.onListenStart(e)}))},onSubscription:function(){this.dispatchToAll((function(t){null!=t.onSubscription&&t.onSubscription()}))},onSubscriptionError:function(t,e){this.dispatchToAll((function(s){null!=s.onSubscriptionError&&s.onSubscriptionError(t,e)}))},onUnsubscription:function(){this.dispatchToAll((function(t){null!=t.onUnsubscription&&t.onUnsubscription()}))},onRealMaxFrequency:function(t){this.dispatchToAll((function(e){null!=e.onRealMaxFrequency&&e.onRealMaxFrequency(t)}))},__class__:R});var x=a.LSSubscription=function(t,e,s,i){this.lock=new oe,this.m_internal=!1,this.state=T.Inactive,this.eventDispatcher=new R,this.wrapper=i,this.mode=Oe.fromString(t),this.initSnapshot(),this.initItemsAndFields("string"==typeof e?[e].slice():e,s)};x.__name__=!0,x.prototype={initSnapshot:function(){this.snapshot="RAW"==this.mode?null:Re.SnpYes},initItemsAndFields:function(t,e){if(null!=t){if(null==e)throw new zt("Please specify a valid field list");if(this.items=ke.fromArray(jt.copy(t,t)),this.fields=Pe.fromArray(jt.copy(e,e)),"COMMAND"==this.mode&&-1==this.fields.indexOf("key"))throw new zt("Field 'key' is missing");if("COMMAND"==this.mode&&-1==this.fields.indexOf("command"))throw new zt("Field 'command' is missing")}else if(null!=e)throw new zt("Please specify a valid item or item list")},addListener:function(t){this.eventDispatcher.addListenerAndFireOnListenStart(t,this)},removeListener:function(t){this.eventDispatcher.removeListenerAndFireOnListenEnd(t,this)},getListeners:function(){return this.eventDispatcher.getListeners().slice()},isActive:function(){return this.state!=T.Inactive},isSubscribed:function(){return this.state==T.Subscribed},getDataAdapter:function(){return this.dataAdapter},setDataAdapter:function(t){this.checkActive(),this.dataAdapter=Me.fromString(t)},getMode:function(){return this.mode},getItems:function(){return null==this.items?null:this.items.slice()},fetchItems:function(){return this.items},setItems:function(t){this.checkActive(),this.items=ke.fromArray(null==t?null:jt.copy(t,t)),this.group=null},getItemGroup:function(){return this.group},setItemGroup:function(t){this.checkActive(),this.group=Me.fromString(t),this.items=null},getFields:function(){return null==this.fields?null:this.fields.slice()},fetchFields:function(){return this.fields},setFields:function(t){this.checkActive();var e=Pe.fromArray(null==t?null:jt.copy(t,t));if("COMMAND"==this.mode&&null!=e){if(-1==e.indexOf("command"))throw new zt("Field 'command' is missing");if(-1==e.indexOf("key"))throw new zt("Field 'key' is missing")}this.fields=e,this.schema=null},getFieldSchema:function(){return this.schema},setFieldSchema:function(t){this.checkActive(),this.schema=Me.fromString(t),this.fields=null},getRequestedBufferSize:function(){return Te.toString(this.bufferSize)},setRequestedBufferSize:function(t){null!=t&&(t=null==t?"null":""+t),this.checkActive(),this.bufferSize=Te.fromString(t)},getRequestedSnapshot:function(){return xe.toString(this.snapshot)},setRequestedSnapshot:function(t){null!=t&&(t=null==t?"null":""+t),this.checkActive();var e=xe.fromString(t);switch(this.mode){case"COMMAND":case"MERGE":if(null!=e&&null!=e&&2==e._hx_index)throw new zt("Snapshot length is not permitted if MERGE or COMMAND was specified as mode");break;case"RAW":if(null!=e)throw new zt("Snapshot is not permitted if RAW was specified as mode")}this.snapshot=e},getRequestedMaxFrequency:function(){return Ie.toString(this.requestedMaxFrequency)},setRequestedMaxFrequency:function(t){var e,s=this;null!=t&&(t=null==t?"null":""+t),this.lock.synchronized((function(){var i=Ie.fromString(t);switch(s.mode){case"COMMAND":case"DISTINCT":case"MERGE":break;default:throw new zt("The operation in only available on MERGE, DISTINCT and COMMAND Subscripitons")}if(s.isActive()&&(null==i||i==Ce.FreqUnfiltered||s.requestedMaxFrequency==Ce.FreqUnfiltered))throw new zt("Cannot change the frequency from/to 'unfiltered' or to null while the Subscription is active");return null!=s.subId&&As.isInfoEnabled()&&As.info("Subscription "+s.subId+" requested max frequency changed: "+t),s.requestedMaxFrequency=i,e=s.manager})),null!=e&&e.evtExtConfigure()},getSelector:function(){return this.selector},setSelector:function(t){this.checkActive(),this.selector=Me.fromString(t)},getCommandPosition:function(){if(this.checkCommand(),null==this.cmdIdx)throw new Yt("The position of the command field is currently unknown");return this.cmdIdx},getKeyPosition:function(){if(this.checkCommand(),null==this.keyIdx)throw new Yt("The position of the key field is currently unknown");return this.keyIdx},getCommandSecondLevelDataAdapter:function(){return this.dataAdapter2},setCommandSecondLevelDataAdapter:function(t){this.checkActive(),this.checkCommand(),this.dataAdapter2=Me.fromString(t)},getCommandSecondLevelFields:function(){return null==this.fields2?null:this.fields2.slice()},setCommandSecondLevelFields:function(t){this.checkActive(),this.checkCommand(),this.fields2=Pe.fromArray(null==t?null:jt.copy(t,t)),this.schema2=null},getCommandSecondLevelFieldSchema:function(){return this.schema2},setCommandSecondLevelFieldSchema:function(t){this.checkActive(),this.checkCommand(),this.schema2=Me.fromString(t),this.fields2=null},getValue:function(t,e){var s="number"==typeof t&&(0|t)===t,i="string"==typeof t,n="number"==typeof e&&(0|e)===e,r="string"==typeof e;if(s&&n)return this.getValuePosPos(t,e);if(s&&r)return this.getValuePosName(t,e);if(i&&n)return this.getValueNamePos(t,e);if(i&&r)return this.getValueNameName(t,e);throw new zt("Invalid argument type")},getCommandValue:function(t,e,s){var i="number"==typeof t&&(0|t)===t,n="string"==typeof t,r="number"==typeof s&&(0|s)===s,a="string"==typeof s;if(i&&r)return this.getCommandValuePosPos(t,e,s);if(i&&a)return this.getCommandValuePosName(t,e,s);if(n&&r)return this.getCommandValueNamePos(t,e,s);if(n&&a)return this.getCommandValueNameName(t,e,s);throw new zt("Invalid argument type")},getValuePosPos:function(t,e){var s,i=this;if(t<1||e<1)throw new zt("The specified position is out of bounds");return this.lock.synchronized((function(){return s=i.manager})),null!=s?s.getValue(t,e):null},getValuePosName:function(t,e){var s=this;return this.getValuePosPos(t,this.lock.synchronized((function(){return s.getFieldPos(e)})))},getValueNamePos:function(t,e){var s=this;return this.getValuePosPos(this.lock.synchronized((function(){return s.getItemPos(t)})),e)},getValueNameName:function(t,e){var s=this;return this.getValuePosPos(this.lock.synchronized((function(){return s.getItemPos(t)})),this.lock.synchronized((function(){return s.getFieldPos(e)})))},getCommandValuePosPos:function(t,e,s){var i,n=this;if(this.checkCommand(),t<1||s<1)throw new zt("The specified position is out of bounds");return this.lock.synchronized((function(){return i=n.manager})),null!=i?i.getCommandValue(t,e,s):null},getCommandValuePosName:function(t,e,s){var i=this;return this.getCommandValuePosPos(t,e,this.lock.synchronized((function(){return i.getFieldPos(s)})))},getCommandValueNamePos:function(t,e,s){var i=this;return this.getCommandValuePosPos(this.lock.synchronized((function(){return i.getItemPos(t)})),e,s)},getCommandValueNameName:function(t,e,s){var i=this;return this.getCommandValuePosPos(this.lock.synchronized((function(){return i.getItemPos(t)})),e,this.lock.synchronized((function(){return i.getFieldPos(s)})))},getItemPos:function(t){var e;if(null==this.items||-1==(e=ke.getPos(this.items,t)))throw new zt("Unknown item name");return e},getFieldPos:function(t){var e;if(null==this.fields||-1==(e=Pe.getPos(this.fields,t)))throw new zt("Unknown field name");return e},checkActive:function(){if(this.isActive())throw new Yt("Cannot modify an active Subscription. Please unsubscribe before applying any change")},checkCommand:function(){if("COMMAND"!=this.mode)throw new Yt("This method can only be used on COMMAND subscriptions")},fetch_items:function(){return this.items},fetch_fields:function(){return this.fields},fetch_fields2:function(){return this.fields2},fetch_mode:function(){return this.mode},fetch_requestedBufferSize:function(){return this.bufferSize},fetch_requestedSnapshot:function(){return this.snapshot},fetch_requestedMaxFrequency:function(){return this.requestedMaxFrequency},fetch_nItems:function(){return this.nItems},fetch_subManager:function(){return this.manager},setActive:function(){this.state=T.Active},setInactive:function(){this.state=T.Inactive,this.subId=null,this.cmdIdx=null,this.keyIdx=null,this.nItems=null,this.nFields=null},setSubscribed:function(t,e,s){this.state=T.Subscribed,this.subId=t,this.nItems=e,this.nFields=s},setSubscribedCMD:function(t,e,s,i,n){this.state=T.Subscribed,this.subId=t,this.cmdIdx=i,this.keyIdx=n,this.nItems=e,this.nFields=s},fetch_nFields:function(){return this.nFields},isInternal:function(){return this.m_internal},setInternal:function(){this.m_internal=!0},getItemName:function(t){return null!=this.items?this.items[t-1]:null},relate:function(t){this.manager=t},unrelate:function(t){this.manager==t&&(this.manager=null)},hasSnapshot:function(){return!(null==this.snapshot||this.snapshot==Re.SnpNo)},getItemNameOrPos:function(t){return null!=this.items?this.items[t-1]:""+t},fireOnSubscription:function(t){As.isInfoEnabled()&&As.info("Subscription "+t+" added"),this.eventDispatcher.onSubscription()},fireOnUnsubscription:function(t){As.isInfoEnabled()&&As.info("Subscription "+t+" deleted"),this.eventDispatcher.onUnsubscription()},fireOnSubscriptionError:function(t,e,s){As.isWarnEnabled()&&As.warn("Subscription "+t+" failed: "+e+" - "+s),this.eventDispatcher.onSubscriptionError(e,s)},fireOnEndOfSnapshot:function(t,e){As.isDebugEnabled()&&As.debug("Subscription "+e+":"+this.getItemNameOrPos(t)+": snapshot ended"),this.eventDispatcher.onEndOfSnapshot(this.getItemName(t),t)},fireOnClearSnapshot:function(t,e){As.isDebugEnabled()&&As.debug("Subscription "+e+":"+this.getItemNameOrPos(t)+": snapshot cleared"),this.eventDispatcher.onClearSnapshot(this.getItemName(t),t)},fireOnLostUpdates:function(t,e,s){As.isDebugEnabled()&&As.debug("Subscription "+s+":"+this.getItemNameOrPos(t)+": lost "+e+" updates"),this.eventDispatcher.onItemLostUpdates(this.getItemName(t),t,e)},fireOnItemUpdate:function(t,e){As.isDebugEnabled()&&As.debug("Subscription "+e+":"+this.getItemNameOrPos(t.getItemPos())+" update: "+m.string(t)),this.eventDispatcher.onItemUpdate(t)},fireOnRealMaxFrequency:function(t,e){As.isDebugEnabled()&&As.debug("Subscription "+e+" real max frequency changed: "+m.string(t)),this.eventDispatcher.onRealMaxFrequency(function(t){if(null==t)return"null";switch(t._hx_index){case 0:return""+t.freq;case 1:return"unlimited"}}(t))},fireOnSubscriptionError2Level:function(t,e,s,i,n){As.isWarnEnabled()&&As.warn("Subscription "+i+":"+this.getItemNameOrPos(n)+":"+t+" failed: "+e+" - "+s),this.eventDispatcher.onCommandSecondLevelSubscriptionError(e,s,t)},fireOnLostUpdates2Level:function(t,e,s,i){As.isDebugEnabled()&&As.debug("Subscription "+s+":"+this.getItemNameOrPos(i)+":"+t+": lost "+e+" updates"),this.eventDispatcher.onCommandSecondLevelItemLostUpdates(e,t)},toString:function(){var t=Ht._new();return Ht.set(t,"mode",this.mode),Ht.set(t,"items",null!=this.items?m.string(this.items):this.group),Ht.set(t,"fields",null!=this.fields?m.string(this.fields):this.schema),Ht.set(t,"dataAdapter",this.dataAdapter),Ht.set(t,"requestedBufferSize",this.bufferSize),Ht.set(t,"requestedSnapshot",this.snapshot),Ht.set(t,"requestedMaxFrequency",this.requestedMaxFrequency),Ht.set(t,"selector",this.selector),Ht.set(t,"secondLevelFields",null!=this.fields2?m.string(this.fields2):this.schema2),Ht.set(t,"secondLevelDataAdapter",this.dataAdapter2),is.stringify(t.h)},__class__:x};var C=function(){};C.__name__=!0,C.__isInterface__=!0,C.prototype={__class__:C};var I=function(t){this.frozen=!1};I.__name__=!0,I.__interfaces__=[C],I.newLoggingInstance=function(){return new I},I.prototype={startListening:function(){},stopListening:function(){},__class__:I};var L=function(t,e){this.slw_m=.5,this.slw_hugeDelayMs=2e4,this.slw_maxAvgDelayMs=7e3,this.slw_avgDelayMs=0,this.slw_refTime=0,this.rec_clientProg=0,this.rec_serverProg=0,this.subscriptionManagers=new Zt,this.messageManagers=new Ut,this.sequenceMap=new is,this.disabledTransports=new ue,this.suspendedTransports=new ue,this.ctrl_connectTs=0,this.recoverTs=0,this.connectTs=0,this.m_nextSubId=0,this.m_nextReqId=0,this.m_status="DISCONNECTED",this.delayCounter=new lt,this.state=new G,this.client=t,this.lock=t.lock,this.details=t.connectionDetails,this.options=t.connectionOptions,this.wsFactory=gs(e,e.createWsClient),this.httpFactory=gs(e,e.createHttpClient),this.ctrlFactory=gs(e,e.createCtrlClient),this.timerFactory=gs(e,e.createTimer),this.randomGenerator=gs(e,e.randomMillis),this.reachabilityFactory=gs(e,e.createReachabilityManager),this.frz_pageLifecycleFactory=gs(e,e.createPageLifecycleFactory),this.clientEventDispatcher=t.eventDispatcher,this.switchRequest=new A(this),this.constrainRequest=new W(this),this.delayCounter.reset(this.options.retryDelay)};L.__name__=!0,L.prototype={disposeSession:function(){this.disposeWS(),this.disposeHTTP(),this.disposeCtrl(),this.details.setServerInstanceAddress(null),this.details.setSessionId(null),this.details.setServerSocketName(null),this.details.setClientIp(null),this.options.setRealMaxBandwidth(null),this.lastKnownClientIp=null,this.resetSequenceMap(),this.rec_serverProg=0,this.rec_clientProg=0,this.bw_lastReqId=null,this.bw_requestedMaxBandwidth=null,this.swt_lastReqId=null},disposeClient:function(){this.sessionId=null,this.enableAllTransports(),this.resetCurrentRetryDelay(),this.resetSequenceMap(),this.cause=null},evtExtConnect:function(){this.traceEvent("connect");var t,e=!0;100==this.state.s_m&&(L.frz_globalPageLifecycle.frozen?(Hs.isWarnEnabled()&&Hs.warn("connection requested while page is frozen"),this.cause="page.frozen",this.resetCurrentRetryDelay(),this.doInstallPageLifecycle(),this.state.s_m=117,this.state.traceState(),e=this.evtExtConnect_NextRegion(),null!=(t=this.frz_pageLifecycle)&&t.startListening(),this.evtRetry(k.page_frozen)):(this.cause="api",this.resetCurrentRetryDelay(),this.doInstallPageLifecycle(),this.state.s_m=101,this.state.traceState(),e=this.evtExtConnect_NextRegion(),null!=(t=this.frz_pageLifecycle)&&t.startListening(),this.evtSelectCreate()));e&&this.evtExtConnect_NextRegion()},evtExtConnect_NextRegion:function(){return this.evtExtConnect_NetworkReachabilityRegion()},evtExtConnect_NetworkReachabilityRegion:function(){var t=this;if(1400==this.state.s_nr){var e=new qe(this.getServerAddress()).get_hostname();this.nr_reachabilityManager=this.reachabilityFactory(e),this.state.s_nr=1410,this.state.traceState(),this.nr_reachabilityManager.startListening((function(s){switch(s._hx_index){case 0:t.evtNetworkReachable(e);break;case 1:t.evtNetworkNotReachable(e)}}))}return!1},doInstallPageLifecycle:function(){var t=this;this.frz_pageLifecycle=this.frz_pageLifecycleFactory((function(e){switch(e._hx_index){case 0:t.evtPageFrozen();break;case 1:t.evtPageResumed()}}))},doUnistallPageLifecycle:function(){var t=this.frz_pageLifecycle;null!=t&&t.stopListening(),this.frz_pageLifecycle=null},evtPageFrozen:function(){switch(this.traceEvent("page.frozen"),this.state.s_m){case 110:case 111:case 112:case 113:case 114:case 115:case 116:this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.s_m=117,this.state.traceState(),this.cancel_evtRetryTimeout();break;case 120:case 121:case 122:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.s_m=117,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(k.page_frozen);break;case 130:case 140:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.s_m=117,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(k.page_frozen);break;case 150:var t=this.state.s_tr;if(null!=t)switch(t){case 210:this.sendDestroyWS("page.frozen"),this.closeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.clear_w(),this.state.goto_m_from_session(117),this.exit_w(),this.evtEndSession(),this.evtRetry(k.page_frozen);break;case 220:case 230:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.goto_m_from_session(117),this.cancel_evtTransportTimeout(),this.evtEndSession(),this.evtRetry(k.page_frozen);break;case 240:if(500==(null!=(i=this.state.s_ws)?i.m:null))this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.goto_m_from_ws(117),this.exit_ws_to_m(),this.evtRetry(k.page_frozen);else{var e;if(501!=(null!=(e=this.state.s_ws)?e.m:null))s=502==(null!=(e=this.state.s_ws)?e.m:null);else s=!0;if(s)i=!0;else i=503==(null!=(s=this.state.s_ws)?s.m:null);i&&(this.sendDestroyWS("page.frozen"),this.closeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.goto_m_from_ws(117),this.exit_ws_to_m(),this.evtRetry(k.page_frozen))}break;case 250:var s,i;if(600!=(null!=(s=this.state.s_wp)?s.m:null))i=601==(null!=(s=this.state.s_wp)?s.m:null);else i=!0;if(i)this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.goto_m_from_wp(117),this.exit_ws_to_m(),this.evtRetry(k.page_frozen);else 602==(null!=(i=this.state.s_wp)?i.m:null)&&(this.sendDestroyWS("page.frozen"),this.closeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.goto_m_from_wp(117),this.exit_wp_to_m(),this.evtRetry(k.page_frozen));break;case 260:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.goto_m_from_rec(117),this.exit_rec_to_m(),this.evtRetry(k.page_frozen);break;case 270:710==this.state.s_h?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.goto_m_from_hs(117),this.exit_hs_to_m(),this.evtRetry(k.page_frozen)):720==this.state.s_h&&(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.goto_m_from_hp(117),this.exit_hp_to_m(),this.evtRetry(k.page_frozen))}}},evtPageResumed:function(){this.traceEvent("page.resumed"),117==this.state.s_m&&(this.state.s_m=116,this.state.traceState(),this.evtSelectCreate())},evtNetworkNotReachable:function(t){qs.isInfoEnabled()&&qs.info(t+" is NOT reachable"),this.traceEvent("nr:network.not.reachable"),(1410==this.state.s_nr||1412==this.state.s_nr)&&(this.state.s_nr=1411,this.state.traceState())},evtNetworkReachable:function(t){qs.isInfoEnabled()&&qs.info(t+" is reachable"),this.traceEvent("nr:network.reachable"),1410==this.state.s_nr?(this.state.s_nr=1412,this.state.traceState()):1411==this.state.s_nr&&(this.state.s_nr=1412,this.state.traceState(),this.evtOnlineAgain())},evtOnlineAgain:function(){this.traceEvent("online.again"),112==this.state.s_m?(this.state.s_m=116,this.state.traceState(),this.cancel_evtRetryTimeout(),this.evtSelectCreate()):1003==this.state.s_rec&&(this.sendRecovery(),this.state.s_rec=1001,this.state.traceState(),this.cancel_evtRetryTimeout(),this.schedule_evtTransportTimeout(this.options.retryDelay))},evtServerAddressChanged:function(){var t=this;switch(this.traceEvent("nr:serverAddress.changed"),this.state.s_nr){case 1410:case 1411:case 1412:var e=this.nr_reachabilityManager,s=new qe(this.getServerAddress()).get_hostname();this.nr_reachabilityManager=this.reachabilityFactory(s),this.state.s_nr=1410,this.state.traceState(),null!=e&&e.stopListening(),this.nr_reachabilityManager.startListening((function(e){switch(e._hx_index){case 0:t.evtNetworkReachable(s);break;case 1:t.evtNetworkNotReachable(s)}}))}},evtExtDisconnect:function(t){switch(this.traceEvent("disconnect: cause="+m.string(t)),this.state.s_m){case 110:case 111:case 112:case 113:case 114:case 115:case 116:case 117:this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.s_m=100,this.state.traceState(),this.cancel_evtRetryTimeout(),this.evtTerminate(t);break;case 120:case 121:case 122:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.s_m=100,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtTerminate(t);break;case 130:case 140:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.s_m=100,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtTerminate(t);break;case 150:var e=this.state.s_tr;if(null!=e)switch(e){case 210:this.sendDestroyWS(),this.closeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.clear_w(),this.state.goto_m_from_session(100),this.exit_w(),this.evtEndSession(),this.evtTerminate(t);break;case 220:case 230:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.goto_m_from_session(100),this.cancel_evtTransportTimeout(),this.evtEndSession(),this.evtTerminate(t);break;case 240:if(500==(null!=(n=this.state.s_ws)?n.m:null))this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.goto_m_from_ws(100),this.exit_ws_to_m(),this.evtTerminate(t);else{var s;if(501!=(null!=(s=this.state.s_ws)?s.m:null))i=502==(null!=(s=this.state.s_ws)?s.m:null);else i=!0;if(i)n=!0;else n=503==(null!=(i=this.state.s_ws)?i.m:null);n&&(this.sendDestroyWS(),this.closeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.goto_m_from_ws(100),this.exit_ws_to_m(),this.evtTerminate(t))}break;case 250:var i,n;if(600!=(null!=(i=this.state.s_wp)?i.m:null))n=601==(null!=(i=this.state.s_wp)?i.m:null);else n=!0;if(n)this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.goto_m_from_wp(100),this.exit_ws_to_m(),this.evtTerminate(t);else 602==(null!=(n=this.state.s_wp)?n.m:null)&&(this.sendDestroyWS(),this.closeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.goto_m_from_wp(100),this.exit_wp_to_m(),this.evtTerminate(t));break;case 260:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.goto_m_from_rec(100),this.exit_rec_to_m(),this.evtTerminate(t);break;case 270:710==this.state.s_h?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.goto_m_from_hs(100),this.exit_hs_to_m(),this.evtTerminate(t)):720==this.state.s_h&&(this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.goto_m_from_hp(100),this.exit_hp_to_m(),this.evtTerminate(t))}}},evtSelectCreate:function(){if(this.traceEvent("select.create"),101==this.state.s_m||116==this.state.s_m)switch(this.getBestForCreating()._hx_index){case 0:this.notifyStatus("CONNECTING"),this.openWS_Create(),this.state.s_m=120,this.state.traceState(),this.evtCreate(),this.schedule_evtTransportTimeout(this.delayCounter.get_currentRetryDelay());break;case 1:this.notifyStatus("CONNECTING"),this.sendCreateHTTP(),this.state.s_m=130,this.state.traceState(),this.evtCreate(),this.schedule_evtTransportTimeout(this.delayCounter.get_currentRetryDelay());break;case 2:this.notifyStatus("DISCONNECTED"),this.state.s_m=100,this.state.traceState(),this.evtTerminate(P.TC_otherError("Unable to select a transport"))}},evtWSOpen:function(){var t;(this.traceEvent("ws.open"),120==this.state.s_m)?(this.sendCreateWS(),this.state.s_m=121,this.state.traceState()):500==(null!=(t=this.state.s_ws)?t.m:null)?(this.sendBindWS_Streaming(),this.state.s_ws.m=501,this.state.traceState()):600==(null!=(t=this.state.s_wp)?t.m:null)&&(Jt.sure(this.ws).send("wsok"),this.state.s_wp.m=601,this.state.traceState())},evtMessage:function(t){var e=!0;if(p.startsWith(t,"U,")){var s=function(t){var e=nt(t,",")+1,s=nt(t,",",e)+1,i=nt(t,",",s)+1,n=st(t.substring(e,s-1)),r=st(t.substring(s,i-1)),a=new es,o=i-1,h=1;for(;o<t.length;){var c=t.indexOf("|",o+1);-1==c&&(c=t.length);var l=t.substring(o+1,c);if(""==l)a.h[h]=ge.unchanged,++h;else if("#"==l)a.h[h]=ge.changed(null),++h;else if("$"==l)a.h[h]=ge.changed(""),++h;else if("^"==l.charAt(0))if("P"==l.charAt(1)){var u=rt(l.substring(2));try{var _=Be._new(u);a.h[h]=ge.jsonPatch(_),++h}catch(t){var d=Gt.caught(t);throw Ms.isErrorEnabled()&&Ms.error("Invalid JSON patch "+u+": "+d.get_message()+"\n"+d.details()),new Yt("The JSON Patch for the field "+h+" is not well-formed")}}else if("T"==l.charAt(1)){var f=rt(l.substring(2));a.h[h]=ge.diffPatch(f),++h}else for(var m=st(l.substring(1)),g=0;g<m;)++g,a.h[h]=ge.unchanged,++h;else{var p=ge.changed(rt(l));a.h[h]=p,++h}o=c}return new et(n,r,a)}(t);this.evtU(s.subId,s.itemIdx,s.values,t)}else if(p.startsWith(t,"REQOK"))"REQOK"==t?this.evtREQOK_withoutReqId():this.evtREQOK(st(t.split(",")[1]));else if(p.startsWith(t,"PROBE"))this.evtPROBE();else if(p.startsWith(t,"LOOP"))this.evtLOOP(st(t.split(",")[1]));else if(p.startsWith(t,"CONOK")){var i=t.split(",");this.evtCONOK(i[1],st(i[2]),st(i[3]),i[4])}else if(p.startsWith(t,"WSOK"))this.evtWSOK();else if(p.startsWith(t,"SERVNAME"))this.evtSERVNAME(t.split(",")[1]);else if(p.startsWith(t,"CLIENTIP"))this.evtCLIENTIP(t.split(",")[1]);else if(p.startsWith(t,"CONS")){var n=t.split(",")[1];switch(n){case"unlimited":this.evtCONS(De.BWUnlimited);break;case"unmanaged":this.evtCONS(De.BWUnmanaged);break;default:this.evtCONS(De.BWLimited(it(n)))}}else if(p.startsWith(t,"MSGDONE")){"*"==(o=(i=t.split(","))[1])&&(o="UNORDERED_MESSAGES");var r=st(i[2]),a=i[3];this.evtMSGDONE(o,r,""==a?"":rt(a))}else if(p.startsWith(t,"MSGFAIL")){var o;"*"==(o=(i=t.split(","))[1])&&(o="UNORDERED_MESSAGES"),this.evtMSGFAIL(o,st(i[2]),st(i[3]),rt(i[4]))}else if(p.startsWith(t,"REQERR")){i=t.split(",");this.evtREQERR(st(i[1]),st(i[2]),rt(i[3]))}else if(p.startsWith(t,"PROG"))this.evtPROG(st(t.split(",")[1]));else if(p.startsWith(t,"SUBOK")){i=t.split(",");this.evtSUBOK(st(i[1]),st(i[2]),st(i[3]))}else if(p.startsWith(t,"SUBCMD")){i=t.split(",");this.evtSUBCMD(st(i[1]),st(i[2]),st(i[3]),st(i[4]),st(i[5]))}else if(p.startsWith(t,"UNSUB"))this.evtUNSUB(st(t.split(",")[1]));else if(p.startsWith(t,"CONF")){var h=st((i=t.split(","))[1]);"unlimited"==i[2]?this.evtCONF(h,Le.RFreqUnlimited):this.evtCONF(h,Le.RFreqLimited(it(i[2])))}else if(p.startsWith(t,"EOS")){i=t.split(",");this.evtEOS(st(i[1]),st(i[2]))}else if(p.startsWith(t,"CS")){i=t.split(",");this.evtCS(st(i[1]),st(i[2]))}else if(p.startsWith(t,"OV")){i=t.split(",");this.evtOV(st(i[1]),st(i[2]),st(i[3]))}else if(p.startsWith(t,"NOOP"))this.evtNOOP();else if(p.startsWith(t,"CONERR")){i=t.split(",");this.evtCONERR(st(i[1]),rt(i[2]))}else if(p.startsWith(t,"END")){i=t.split(",");this.evtEND(st(i[1]),rt(i[2]))}else if(p.startsWith(t,"ERROR")){i=t.split(",");this.evtERROR(st(i[1]),rt(i[2]))}else p.startsWith(t,"SYNC")?this.evtSYNC(st(t.split(",")[1])):e=!1;return e},evtCtrlMessage:function(t){if(p.startsWith(t,"REQOK"))"REQOK"==t?this.evtREQOK_withoutReqId():this.evtREQOK(st(t.split(",")[1]));else if(p.startsWith(t,"REQERR")){var e=t.split(",");this.evtREQERR(st(e[1]),st(e[2]),rt(e[3]))}else if(p.startsWith(t,"ERROR")){e=t.split(",");this.evtERROR(st(e[1]),rt(e[2]))}},evtTransportTimeout:function(){switch(this.traceEvent("transport.timeout"),this.state.s_m){case 120:case 121:this.suspendWS_Streaming(),this.disposeWS(),this.cause="ws.unavailable",this.state.s_m=115,this.state.traceState(),this.cancel_evtTransportTimeout(),this.entry_m115(k.ws_unavailable);break;case 122:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.timeout",this.state.s_m=112,this.state.traceState(),this.cancel_evtTransportTimeout(),this.entry_m112(k.ws_timeout);break;case 130:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.timeout",this.state.s_m=112,this.state.traceState(),this.cancel_evtTransportTimeout(),this.entry_m112(k.http_timeout);break;case 140:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ttl.timeout";var t=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs);this.state.s_m=111,this.state.traceState(),this.cancel_evtTransportTimeout(),this.entry_m111(k.http_error,t);break;case 150:if(null!=(s=this.state.s_tr))switch(s){case 220:if(0==this.options.sessionRecoveryTimeout)this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.timeout",this.state.goto_m_from_session(112),this.cancel_evtTransportTimeout(),this.evtEndSession(),this.entry_m112(k.http_timeout);else{this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="http.timeout";t=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.goto_rec(),this.cancel_evtTransportTimeout(),this.entry_rec(t,k.http_timeout)}break;case 230:if(0==this.options.sessionRecoveryTimeout)this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ttl.timeout",this.state.goto_m_from_session(112),this.cancel_evtTransportTimeout(),this.evtEndSession(),this.entry_m112(k.http_timeout);else{this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ttl.timeout";t=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.goto_rec(),this.cancel_evtTransportTimeout(),this.entry_rec(t,k.http_error)}break;case 240:if(null!=(s=null!=(e=this.state.s_ws)?e.m:null))switch(s){case 500:this.disableWS(),this.disposeWS(),this.cause="ws.unavailable",this.state.clear_ws(),this.state.s_tr=200,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtSwitchTransport();break;case 501:if(0==this.options.sessionRecoveryTimeout)this.disableWS(),this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.unavailable",this.state.goto_m_from_ws(112),this.exit_ws_to_m(),this.entry_m112(k.ws_unavailable);else{this.disableWS(),this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.unavailable";t=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.goto_rec_from_ws(),this.exit_ws(),this.entry_rec(t,k.ws_unavailable)}break;case 502:if(0==this.options.sessionRecoveryTimeout)this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.timeout",this.state.goto_m_from_ws(112),this.exit_ws_to_m(),this.entry_m112(k.ws_timeout);else{this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.timeout";t=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.goto_rec_from_ws(),this.exit_ws(),this.entry_rec(t,k.ws_timeout)}}break;case 250:if(null!=(s=null!=(e=this.state.s_wp)?e.m:null))switch(s){case 600:case 601:this.disableWS(),this.disposeWS(),this.cause="ws.unavailable",this.state.clear_wp(),this.state.s_tr=200,this.state.traceState(),this.exit_wp(),this.evtSwitchTransport()}break;case 260:1001==this.state.s_rec&&(this.disposeHTTP(),this.state.s_rec=1002,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtCheckRecoveryTimeout(M.RRC_transport_timeout));break;case 270:var e,s;if(null!=(s=this.state.s_h))if(710==s)if(null!=(s=null!=(e=this.state.s_hs)?e.m:null))switch(s){case 800:this.disableHTTP_Streaming(),this.cause="http.streaming.unavailable",this.state.s_hs.m=801,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtForcePolling(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 801:if(0==this.options.sessionRecoveryTimeout)this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.timeout",this.state.goto_m_from_hs(112),this.exit_hs_to_m(),this.entry_m112(k.http_timeout);else{this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="http.timeout";t=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.goto_rec_from_hs(),this.exit_hs_to_rec(),this.entry_rec(t,k.http_timeout)}}}}},evtTransportError:function(){switch(this.traceEvent("transport.error"),this.state.s_m){case 120:case 121:this.suspendWS_Streaming(),this.disposeWS(),this.cause="ws.unavailable",this.state.s_m=115,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(k.ws_unavailable),this.evtRetryTimeout();break;case 122:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.error";var t=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs);this.state.s_m=112,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(k.ws_error,t),this.schedule_evtRetryTimeout(t);break;case 130:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.error";t=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs);this.state.s_m=112,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(k.http_error,t),this.schedule_evtRetryTimeout(t);break;case 140:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ttl.error";t=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs);this.state.s_m=111,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(k.http_error,t),this.schedule_evtRetryTimeout(t);break;case 150:var e=this.state.s_tr;if(null!=e)switch(e){case 210:if(0==this.options.sessionRecoveryTimeout)this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.error",this.state.clear_w(),this.state.goto_m_from_session(113),this.exit_w(),this.evtEndSession(),this.entry_m113(k.ws_error);else{this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.error";t=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.clear_w(),this.state.s_tr=260,this.state.s_rec=1e3,this.state.traceState(),this.exit_w(),this.entry_rec(t,k.ws_error)}break;case 220:if(0==this.options.sessionRecoveryTimeout){this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.error";t=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs);this.state.goto_m_from_session(112),this.cancel_evtTransportTimeout(),this.evtEndSession(),this.evtRetry(k.http_error,t),this.schedule_evtRetryTimeout(t)}else{this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="http.error";t=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.goto_rec(),this.cancel_evtTransportTimeout(),this.entry_rec(t,k.http_error)}break;case 230:if(0==this.options.sessionRecoveryTimeout){this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ttl.error";t=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs);this.state.goto_m_from_session(112),this.cancel_evtTransportTimeout(),this.evtEndSession(),this.evtRetry(k.http_error,t),this.schedule_evtRetryTimeout(t)}else{this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ttl.error";t=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.goto_rec(),this.cancel_evtTransportTimeout(),this.entry_rec(t,k.http_error)}break;case 240:switch(Jt.sure(this.state.s_ws).m){case 500:this.disableWS(),this.disposeWS(),this.cause="ws.unavailable",this.state.clear_ws(),this.state.s_tr=200,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtSwitchTransport();break;case 501:if(0==this.options.sessionRecoveryTimeout)this.disableWS(),this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.unavailable",this.state.goto_m_from_ws(112),this.exit_ws_to_m(),this.entry_m112(k.ws_unavailable);else{this.disableWS(),this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.unavailable";t=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.goto_rec_from_ws(),this.exit_ws(),this.entry_rec(t,k.ws_unavailable)}break;case 502:if(0==this.options.sessionRecoveryTimeout)this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.error",this.state.goto_m_from_ws(112),this.exit_ws_to_m(),this.entry_m112(k.ws_error);else{this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.error";t=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.goto_rec_from_ws(),this.cancel_evtTransportTimeout(),this.entry_rec(t,k.ws_error)}break;case 503:if(0==this.options.sessionRecoveryTimeout)this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.error",this.state.goto_m_from_ws(113),this.exit_ws_to_m(),this.entry_m113(k.ws_error);else{this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.error";t=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.goto_rec_from_ws(),this.exit_ws(),this.entry_rec(t,k.ws_error)}}break;case 250:switch(Jt.sure(this.state.s_wp).m){case 600:case 601:this.disableWS(),this.disposeWS(),this.cause="ws.unavailable",this.state.clear_wp(),this.state.s_tr=200,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtSwitchTransport();break;case 602:if(0==this.options.sessionRecoveryTimeout)this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.error",this.state.goto_m_from_wp(113),this.exit_wp_to_m(),this.entry_m113(k.ws_error);else{this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.error";t=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.goto_rec_from_wp(),this.exit_wp(),this.entry_rec(t,k.ws_error)}}break;case 260:1001==this.state.s_rec&&(this.disposeHTTP(),this.state.s_rec=1002,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtCheckRecoveryTimeout(M.RRC_transport_error));break;case 270:switch(Jt.sure(this.state.s_h)){case 710:switch(Jt.sure(this.state.s_hs).m){case 800:case 801:if(0==this.options.sessionRecoveryTimeout)this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.error",this.state.goto_m_from_hs(112),this.exit_hs_to_m(),this.entry_m112(k.http_error);else{this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="http.error";t=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.goto_rec_from_hs(),this.exit_hs_to_rec(),this.entry_rec(t,k.http_error)}break;case 802:if(0==this.options.sessionRecoveryTimeout)this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.error",this.state.goto_m_from_hs(113),this.exit_hs_to_m(),this.entry_m113(k.http_error);else{this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="http.error";t=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.goto_rec_from_hs(),this.exit_hs_to_rec(),this.entry_rec(t,k.http_error)}}break;case 720:switch(Jt.sure(this.state.s_hp).m){case 900:case 901:case 902:case 903:case 904:if(0==this.options.sessionRecoveryTimeout)this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.error",this.state.goto_m_from_hp(112),this.exit_hp_to_m(),this.entry_m112(k.http_error);else{this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="http.error";t=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.goto_rec_from_hp(),this.exit_hp_to_rec(),this.entry_rec(t,k.http_error)}}}}}},evtIdleTimeout:function(){if(this.traceEvent("idle.timeout"),null==(i=null!=(s=this.state.s_wp)?s.p:null))e=!1;else switch(i){case 610:case 611:case 613:e=!0;break;default:e=!1}if(e)if(0==this.options.sessionRecoveryTimeout)this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.idle.timeout",this.state.goto_m_from_wp(113),this.exit_wp_to_m(),this.entry_m113(k.idle_timeout);else{this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.idle.timeout";var t=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.goto_rec_from_wp(),this.exit_wp(),this.entry_rec(t,k.idle_timeout)}else{var e,s,i;if(null==(i=null!=(s=this.state.s_hp)?s.m:null))e=!1;else switch(i){case 900:case 901:case 903:e=!0;break;default:e=!1}if(e)if(0==this.options.sessionRecoveryTimeout)this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.idle.timeout",this.state.goto_m_from_hp(112),this.exit_hp_to_m(),this.entry_m112(k.idle_timeout);else{this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="http.idle.timeout";t=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.goto_rec_from_hp(),this.exit_hp_to_rec(),this.entry_rec(t,k.idle_timeout)}}},evtPollingTimeout:function(){var t;(this.traceEvent("polling.timeout"),612==(null!=(t=this.state.s_wp)?t.p:null))?(this.sendBindWS_Polling(),this.state.s_wp.p=613,this.state.traceState(),this.cancel_evtPollingTimeout(),this.schedule_evtIdleTimeout(pe.plus(Jt.sure(this.idleTimeout),this.options.retryDelay))):902==(null!=(t=this.state.s_hp)?t.m:null)&&(this.sendBindHTTP_Polling(),this.state.s_hp.m=903,this.state.traceState(),this.cancel_evtPollingTimeout(),this.schedule_evtIdleTimeout(pe.plus(Jt.sure(this.idleTimeout),this.options.retryDelay)))},evtKeepaliveTimeout:function(){var t;(this.traceEvent("keepalive.timeout"),310==(null!=(t=this.state.s_w)?t.k:null))?(this.state.s_w.k=311,this.state.traceState(),this.cancel_evtKeepaliveTimeout(),this.schedule_evtStalledTimeout(this.options.stalledTimeout)):520==(null!=(t=this.state.s_ws)?t.k:null)?(this.state.s_ws.k=521,this.state.traceState(),this.cancel_evtKeepaliveTimeout(),this.schedule_evtStalledTimeout(this.options.stalledTimeout)):820==(null!=(t=this.state.s_hs)?t.k:null)&&(this.state.s_hs.k=821,this.state.traceState(),this.cancel_evtKeepaliveTimeout(),this.schedule_evtStalledTimeout(this.options.stalledTimeout))},evtStalledTimeout:function(){var t;(this.traceEvent("stalled.timeout"),311==(null!=(t=this.state.s_w)?t.k:null))?(this.state.s_w.k=312,this.state.traceState(),this.cancel_evtStalledTimeout(),this.schedule_evtReconnectTimeout(this.options.reconnectTimeout)):521==(null!=(t=this.state.s_ws)?t.k:null)?(this.state.s_ws.k=522,this.state.traceState(),this.cancel_evtStalledTimeout(),this.schedule_evtReconnectTimeout(this.options.reconnectTimeout)):821==(null!=(t=this.state.s_hs)?t.k:null)&&(this.state.s_hs.k=822,this.state.traceState(),this.cancel_evtStalledTimeout(),this.schedule_evtReconnectTimeout(this.options.reconnectTimeout))},evtReconnectTimeout:function(){var t;if(this.traceEvent("reconnect.timeout"),312==(null!=(t=this.state.s_w)?t.k:null))if(0==this.options.sessionRecoveryTimeout)this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.stalled",this.state.goto_m_from_w(113),this.exit_w_to_m(),this.entry_m113(k.stalled_timeout);else{this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.stalled";var e=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.goto_rec_from_w(),this.exit_w(),this.entry_rec(e,k.stalled_timeout)}else if(522==(null!=(t=this.state.s_ws)?t.k:null))if(0==this.options.sessionRecoveryTimeout)this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.stalled",this.state.goto_m_from_ws(113),this.exit_ws_to_m(),this.entry_m113(k.stalled_timeout);else{this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.stalled";e=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.goto_rec_from_ws(),this.exit_ws(),this.entry_rec(e,k.stalled_timeout)}else if(822==(null!=(t=this.state.s_hs)?t.k:null))if(0==this.options.sessionRecoveryTimeout)this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.stalled",this.state.goto_m_from_hs(113),this.exit_hs_to_m(),this.entry_m113(k.stalled_timeout);else{this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="http.stalled";e=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.goto_rec_from_hs(),this.exit_hs_to_rec(),this.entry_rec(e,k.stalled_timeout)}},evtRestartKeepalive:function(){var t;(this.traceEvent("restart.keepalive"),null!=(null!=(t=this.state.s_w)?t.k:null))?(this.state.s_w.k=310,this.state.traceState(),this.exit_keepalive_unit(),this.schedule_evtKeepaliveTimeout(Jt.sure(this.keepaliveInterval))):null!=(null!=(t=this.state.s_ws)?t.k:null)?(this.state.s_ws.k=520,this.state.traceState(),this.exit_keepalive_unit(),this.schedule_evtKeepaliveTimeout(Jt.sure(this.keepaliveInterval))):null!=(null!=(t=this.state.s_hs)?t.k:null)&&(this.state.s_hs.k=820,this.state.traceState(),this.exit_keepalive_unit(),this.schedule_evtKeepaliveTimeout(Jt.sure(this.keepaliveInterval)))},evtWSOK:function(){switch(this.traceEvent("WSOK"),ks.isDebugEnabled()&&ks.debug("WSOK"),this.state.s_m){case 121:this.state.s_m=122,this.state.traceState();break;case 150:if(null!=(e=this.state.s_tr))switch(e){case 240:null!=(e=null!=(t=this.state.s_ws)?t.m:null)&&501==e&&(this.state.s_ws.m=502,this.state.traceState());break;case 250:var t,e;null!=(e=null!=(t=this.state.s_wp)?t.m:null)&&601==e&&(this.sendBindWS_FirstPolling(),this.state.s_wp.m=602,this.state.s_wp.p=610,this.state.s_wp.c=620,this.state.s_wp.s=630,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtSendPendingControls(),this.evtSendPendingMessages(),this.schedule_evtIdleTimeout(pe.plus(Jt.sure(this.idleTimeout),this.options.retryDelay)))}}},evtCONERR:function(t,e){this.traceEvent("CONERR"),ks.isDebugEnabled()&&ks.debug("CONERR "+t+" "+e);var s=k.standardError(t,e),i=P.TC_standardError(t,e);if(122==this.state.s_m)switch(t){case 5:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.conerr."+t,this.state.s_m=110,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(s),this.evtRetryTimeout();break;case 4:case 6:case 20:case 40:case 41:case 48:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.conerr."+t;var n=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs);this.state.s_m=112,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(s,n),this.schedule_evtRetryTimeout(n);break;default:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_CONERR(t,e),this.state.s_m=100,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtTerminate(i)}else if(130==this.state.s_m)switch(t){case 5:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.conerr."+t,this.state.s_m=110,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(s),this.evtRetryTimeout();break;case 4:case 6:case 20:case 40:case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.conerr."+t;n=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs);this.state.s_m=112,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(s,n),this.schedule_evtRetryTimeout(n);break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_CONERR(t,e),this.state.s_m=100,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtTerminate(i)}else if(140==this.state.s_m)switch(t){case 5:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ttl.conerr."+t,this.state.s_m=110,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(s),this.evtRetryTimeout();break;case 4:case 6:case 20:case 40:case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ttl.conerr."+t;n=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs);this.state.s_m=112,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(s,n),this.schedule_evtRetryTimeout(n);break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_CONERR(t,e),this.state.s_m=100,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtTerminate(i)}else{if(502==(null!=(r=this.state.s_ws)?r.m:null))switch(t){case 4:case 6:case 20:case 40:case 41:case 48:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.conerr."+t,this.state.goto_m_from_ws(112),this.exit_ws_to_m(),this.entry_m112(k.standardError(t,e));break;default:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_CONERR(t,e),this.state.goto_m_from_ws(100),this.exit_ws_to_m(),this.evtTerminate(i)}else{if(610!=(null!=(a=this.state.s_wp)?a.p:null))r=613==(null!=(a=this.state.s_wp)?a.p:null);else r=!0;if(r)switch(t){case 4:case 6:case 20:case 40:case 41:case 48:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.conerr."+t,this.state.goto_m_from_wp(112),this.exit_wp_to_m(),this.entry_m112(k.standardError(t,e));break;default:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_CONERR(t,e),this.state.goto_m_from_wp(100),this.exit_wp_to_m(),this.evtTerminate(i)}else{if(800!=(null!=(a=this.state.s_hs)?a.m:null))r=801==(null!=(a=this.state.s_hs)?a.m:null);else r=!0;if(r)switch(t){case 4:case 6:case 20:case 40:case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.conerr."+t,this.state.goto_m_from_hs(112),this.exit_hs_to_m(),this.entry_m112(k.standardError(t,e));break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_CONERR(t,e),this.state.goto_m_from_hs(100),this.exit_hs_to_m(),this.evtTerminate(i)}else{var r,a;if(900!=(null!=(a=this.state.s_hp)?a.m:null))r=903==(null!=(a=this.state.s_hp)?a.m:null);else r=!0;if(r)switch(t){case 4:case 6:case 20:case 40:case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.conerr."+t,this.state.goto_m_from_hp(112),this.exit_hp_to_m(),this.entry_m112(k.standardError(t,e));break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_CONERR(t,e),this.state.goto_m_from_hp(100),this.exit_hp_to_m(),this.evtTerminate(i)}else if(1001==this.state.s_rec)switch(t){case 4:case 6:case 20:case 40:case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="recovery.conerr."+t,this.state.goto_m_from_rec(113),this.exit_rec_to_m(),this.entry_m113(s);break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_CONERR(t,e),this.state.goto_m_from_rec(100),this.exit_rec_to_m(),this.evtTerminate(i)}}}}}},evtEND:function(t,e){this.traceEvent("END"),ks.isDebugEnabled()&&ks.debug("END "+t+" "+e);var s=k.standardError(t,e),i=P.TC_standardError(t,e);if(300==(null!=(a=this.state.s_w)?a.p:null))switch(t){case 41:case 48:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.end."+t;var n=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.clear_w(),this.state.goto_m_from_session(113),this.exit_w(),this.evtEndSession(),this.evtRetry(k.standardError(t,e),n),this.schedule_evtRetryTimeout(n);break;default:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.clear_w(),this.state.goto_m_from_session(100),this.exit_w(),this.evtEndSession(),this.evtTerminate(i)}else if(502==(null!=(a=this.state.s_ws)?a.m:null))switch(t){case 41:case 48:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.end."+t,this.state.goto_m_from_ws(112),this.exit_ws_to_m(),this.entry_m112(k.standardError(t,e));break;default:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.goto_m_from_ws(100),this.exit_ws_to_m(),this.evtTerminate(i)}else if(510==(null!=(a=this.state.s_ws)?a.p:null))switch(t){case 41:case 48:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.end."+t,this.state.goto_m_from_ws(113),this.exit_ws_to_m(),this.entry_m113(s);break;default:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.goto_m_from_ws(100),this.exit_ws_to_m(),this.evtTerminate(i)}else{if(610!=(null!=(r=this.state.s_wp)?r.p:null))a=613==(null!=(r=this.state.s_wp)?r.p:null);else a=!0;if(a)switch(t){case 41:case 48:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.end."+t,this.state.goto_m_from_wp(112),this.exit_wp_to_m(),this.entry_m112(k.standardError(t,e));break;default:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.goto_m_from_wp(100),this.exit_wp_to_m(),this.evtTerminate(i)}else if(611==(null!=(a=this.state.s_wp)?a.p:null))switch(t){case 41:case 48:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.end."+t,this.state.goto_m_from_wp(113),this.exit_wp_to_m(),this.entry_m113(s);break;default:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.goto_m_from_wp(100),this.exit_wp_to_m(),this.evtTerminate(i)}else{if(800!=(null!=(r=this.state.s_hs)?r.m:null))a=801==(null!=(r=this.state.s_hs)?r.m:null);else a=!0;if(a)switch(t){case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.end."+t,this.state.goto_m_from_hs(112),this.exit_hs_to_m(),this.entry_m112(k.standardError(t,e));break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.goto_m_from_hs(100),this.exit_hs_to_m(),this.evtTerminate(i)}else if(810==(null!=(a=this.state.s_hs)?a.p:null))switch(t){case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.end."+t,this.state.goto_m_from_hs(113),this.exit_hs_to_m(),this.entry_m113(s);break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.goto_m_from_hs(100),this.exit_hs_to_m(),this.evtTerminate(i)}else{var r,a;if(900!=(null!=(r=this.state.s_hp)?r.m:null))a=903==(null!=(r=this.state.s_hp)?r.m:null);else a=!0;if(a)switch(t){case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.end."+t,this.state.goto_m_from_hp(112),this.exit_hp_to_m(),this.entry_m112(k.standardError(t,e));break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.goto_m_from_hp(100),this.exit_hp_to_m(),this.evtTerminate(i)}else if(901==(null!=(a=this.state.s_hp)?a.m:null))switch(t){case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.end."+t,this.state.goto_m_from_hp(113),this.exit_hp_to_m(),this.entry_m113(s);break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.goto_m_from_hp(100),this.exit_hp_to_m(),this.evtTerminate(i)}else if(1001==this.state.s_rec)switch(t){case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="recovery.end."+t,this.state.goto_m_from_rec(113),this.exit_rec_to_m(),this.entry_m113(s);break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.goto_m_from_rec(100),this.exit_rec_to_m(),this.evtTerminate(i)}}}}},evtERROR:function(t,e){this.traceEvent("ERROR"),ks.isDebugEnabled()&&ks.debug("ERROR "+t+" "+e);var s,i=P.TC_standardError(t,e);300==(null!=(s=this.state.s_w)?s.p:null)?(this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_ERROR(t,e),this.state.clear_w(),this.state.goto_m_from_session(100),this.exit_w(),this.evtEndSession(),this.evtTerminate(i)):510==(null!=(s=this.state.s_ws)?s.p:null)?(this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_ERROR(t,e),this.state.goto_m_from_ws(100),this.exit_ws_to_m(),this.evtTerminate(i)):620==(null!=(s=this.state.s_wp)?s.c:null)?(this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_ERROR(t,e),this.state.goto_m_from_wp(100),this.exit_wp_to_m(),this.evtTerminate(i)):1102==this.state.s_ctrl&&(this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_ERROR(t,e),this.state.goto_m_from_ctrl(100),this.exit_ctrl_to_m(),this.evtTerminate(i))},evtREQOK_withoutReqId:function(){this.traceEvent("REQOK"),ks.isDebugEnabled()&&ks.debug("REQOK"),1102==this.state.s_ctrl&&(this.state.s_ctrl=1102,this.state.traceState())},evtREQOK:function(t){this.traceEvent("REQOK"),ks.isDebugEnabled()&&ks.debug("REQOK "+t);var e=!0;1302==this.state.s_swt&&t==this.swt_lastReqId?(this.state.s_swt=1303,this.state.traceState(),e=this.evtREQOK_TransportRegion(t)):1202==this.state.s_bw&&t==this.bw_lastReqId?(this.state.s_bw=1200,this.state.traceState(),e=this.evtREQOK_TransportRegion(t),this.evtCheckBW()):e=this.evtREQOK_Forward(t),e&&this.evtREQOK_TransportRegion(t)},evtREQOK_Forward:function(t){return!0},evtREQOK_TransportRegion:function(t){var e;300==(null!=(e=this.state.s_w)?e.p:null)?(this.state.s_w.p=300,this.state.traceState(),this.doREQOK(t),this.evtRestartKeepalive()):510==(null!=(e=this.state.s_ws)?e.p:null)?(this.state.s_ws.p=510,this.state.traceState(),this.doREQOK(t),this.evtRestartKeepalive()):620==(null!=(e=this.state.s_wp)?e.c:null)?(this.state.s_wp.c=620,this.state.traceState(),this.doREQOK(t)):1102==this.state.s_ctrl&&(this.state.s_ctrl=1102,this.state.traceState(),this.doREQOK(t));return!1},evtREQERR:function(t,e,s){this.traceEvent("REQERR"),ks.isDebugEnabled()&&ks.debug("REQERR "+t+" "+e+" "+s);var i=!0;1302==this.state.s_swt&&t==this.swt_lastReqId?(this.state.s_swt=1301,this.state.traceState(),i=this.evtREQERR_TransportRegion(t,e,s)):1202==this.state.s_bw&&t==this.bw_lastReqId?(this.state.s_bw=1200,this.state.traceState(),i=this.evtREQERR_TransportRegion(t,e,s),this.evtCheckBW()):i=this.evtREQERR_Forward(t,e,s),i&&this.evtREQERR_TransportRegion(t,e,s)},evtREQERR_Forward:function(t,e,s){return!0},evtREQERR_TransportRegion:function(t,e,s){var i,n=k.standardError(e,s),r=P.TC_standardError(e,s);if(300==(null!=(i=this.state.s_w)?i.p:null))switch(e){case 20:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.reqerr."+e;var a=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.clear_w(),this.state.goto_m_from_session(113),this.exit_w(),this.evtEndSession(),this.evtRetry(k.standardError(e,s),a),this.schedule_evtRetryTimeout(a);break;case 11:case 65:case 67:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_REQERR(e,s),this.state.clear_w(),this.state.goto_m_from_session(100),this.exit_w(),this.evtEndSession(),this.evtTerminate(r);break;default:this.state.s_w.p=300,this.state.traceState(),this.doREQERR(t,e,s),this.evtRestartKeepalive()}else if(510==(null!=(i=this.state.s_ws)?i.p:null))switch(e){case 20:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.reqerr."+e+")",this.state.goto_m_from_ws(113),this.exit_ws_to_m(),this.entry_m113(n);break;case 11:case 65:case 67:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_REQERR(e,s),this.state.goto_m_from_ws(100),this.exit_ws_to_m(),this.evtTerminate(r);break;default:this.state.s_ws.p=510,this.state.traceState(),this.doREQERR(t,e,s),this.evtRestartKeepalive()}else if(620==(null!=(i=this.state.s_wp)?i.c:null))switch(e){case 20:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.reqerr."+e,this.state.goto_m_from_wp(113),this.exit_wp_to_m(),this.entry_m113(n);break;case 11:case 65:case 67:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_REQERR(e,s),this.state.goto_m_from_wp(100),this.exit_wp_to_m(),this.evtTerminate(r);break;default:this.state.s_wp.c=620,this.state.traceState(),this.doREQERR(t,e,s)}else if(1102==this.state.s_ctrl)switch(e){case 20:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.reqerr."+e,this.state.goto_m_from_ctrl(113),this.exit_ctrl_to_m(),this.entry_m113(n);break;case 11:case 65:case 67:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_REQERR(e,s),this.state.goto_m_from_ctrl(100),this.exit_ctrl_to_m(),this.evtTerminate(r);break;default:this.state.s_ctrl=1102,this.state.traceState(),this.doREQERR(t,e,s)}return!1},evtPROG:function(t){this.traceEvent("PROG");var e=k.prog_mismatch(this.rec_serverProg,t);if(ks.isDebugEnabled()&&ks.debug("PROG "+t),300==(null!=(s=this.state.s_w)?s.p:null))t!=this.rec_serverProg?(this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="prog.mismatch."+t+"."+this.rec_serverProg,this.state.clear_w(),this.state.goto_m_from_session(113),this.exit_w(),this.evtEndSession(),this.entry_m113(e)):(this.state.s_w.p=300,this.state.traceState(),this.evtRestartKeepalive());else if(220==this.state.s_tr)t!=this.rec_serverProg?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="prog.mismatch."+t+"."+this.rec_serverProg,this.state.goto_m_from_session(113),this.cancel_evtTransportTimeout(),this.evtEndSession(),this.entry_m113(e)):(this.state.s_tr=220,this.state.traceState());else if(230==this.state.s_tr)t!=this.rec_serverProg?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="prog.mismatch."+t+"."+this.rec_serverProg,this.state.goto_m_from_session(113),this.cancel_evtTransportTimeout(),this.evtEndSession(),this.entry_m113(e)):(this.state.s_tr=230,this.state.traceState());else{var s;if(510==(null!=(s=this.state.s_ws)?s.p:null))t!=this.rec_serverProg?(this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="prog.mismatch."+t+"."+this.rec_serverProg,this.state.goto_m_from_ws(113),this.exit_ws_to_m(),this.entry_m113(e)):(this.state.s_ws.p=510,this.state.traceState(),this.evtRestartKeepalive());else if(611==(null!=(s=this.state.s_wp)?s.p:null))t!=this.rec_serverProg?(this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="prog.mismatch."+t+"."+this.rec_serverProg,this.state.goto_m_from_wp(113),this.exit_wp_to_m(),this.entry_m113(e)):(this.state.s_wp.p=611,this.state.traceState());else if(810==(null!=(s=this.state.s_hs)?s.p:null))t!=this.rec_serverProg?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="prog.mismatch."+t+"."+this.rec_serverProg,this.state.goto_m_from_hs(113),this.exit_hs_to_m(),this.entry_m113(e)):(this.state.s_hs.p=810,this.state.traceState(),this.evtRestartKeepalive());else 901==(null!=(s=this.state.s_hp)?s.m:null)?t!=this.rec_serverProg?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="prog.mismatch."+t+"."+this.rec_serverProg,this.state.goto_m_from_hp(113),this.exit_hp_to_m(),this.entry_m113(e)):(this.state.s_hp.m=901,this.state.traceState()):1001==this.state.s_rec&&(t>this.rec_clientProg?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="prog.mismatch."+t+"."+this.rec_serverProg,this.state.goto_m_from_rec(113),this.exit_rec_to_m(),this.entry_m113(e)):(this.state.s_rec=1001,this.state.traceState(),this.doPROG(t)))}},evtLOOP:function(t){if(this.traceEvent("LOOP"),ks.isDebugEnabled()&&ks.debug("LOOP "+t),300==(null!=(e=this.state.s_w)?e.p:null))this.closeWS(),this.cause="ws.loop",this.state.clear_w(),this.state.s_tr=200,this.state.traceState(),this.exit_w(),this.evtSwitchTransport();else if(220==this.state.s_tr)this.closeHTTP(),this.cause="http.loop",this.state.s_tr=200,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtSwitchTransport();else if(230==this.state.s_tr)this.closeHTTP(),this.cause="ttl.loop",this.state.s_tr=200,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtSwitchTransport();else{var e;if(510==(null!=(e=this.state.s_ws)?e.p:null))this.closeWS(),this.cause="ws.loop",this.state.clear_ws(),this.state.s_tr=200,this.state.traceState(),this.exit_ws(),this.evtSwitchTransport();else if(611==(null!=(e=this.state.s_wp)?e.p:null))this.isSwitching()?(this.closeWS(),this.cause="ws.loop",this.state.clear_wp(),this.state.s_tr=200,this.state.traceState(),this.exit_wp(),this.evtSwitchTransport()):(this.doLOOP(t),this.state.s_wp.p=612,this.state.traceState(),this.cancel_evtIdleTimeout(),this.schedule_evtPollingTimeout(this.options.pollingInterval));else if(810==(null!=(e=this.state.s_hs)?e.p:null))this.closeHTTP(),this.cause="http.loop",this.state.s_hs.p=811,this.state.traceState(),this.evtSwitchTransport();else 901==(null!=(e=this.state.s_hp)?e.m:null)?this.isSwitching()?(this.closeHTTP(),this.state.s_hp.m=904,this.state.traceState(),this.cancel_evtIdleTimeout(),this.evtSwitchTransport()):(this.doLOOP(t),this.closeHTTP(),this.state.s_hp.m=902,this.state.traceState(),this.cancel_evtIdleTimeout(),this.schedule_evtPollingTimeout(this.options.pollingInterval)):1001==this.state.s_rec&&(this.closeHTTP(),this.cause="recovery.loop",this.state.goto_200_from_rec(),this.exit_rec(),this.evtSwitchTransport())}},evtCONOK:function(t,e,s,i){if(this.traceEvent("CONOK"),ks.isDebugEnabled()&&ks.debug("CONOK "+t+" "+e+" "+s+" "+i),122==this.state.s_m)this.doCONOK_CreateWS(t,e,s,i),this.resetCurrentRetryDelay(),this.notifyStatus("CONNECTED:WS-STREAMING"),this.state.s_m=150,this.state.s_tr=210,this.state.s_w=new B(300,310,340),this.state.s_rhb=320,this.state.s_slw=330,this.state.s_swt=1300,this.state.s_bw=1200,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtSendPendingControls(),this.evtSendPendingMessages(),this.evtStartSession(),this.schedule_evtKeepaliveTimeout(Jt.sure(this.keepaliveInterval)),this.evtSelectRhb(),this.evtCheckTransport(),this.evtCheckBW();else if(130==this.state.s_m)this.doCONOK_CreateHTTP(t,e,s,i),this.resetCurrentRetryDelay(),this.notifyStatus("CONNECTED:STREAM-SENSING"),this.state.s_m=150,this.state.s_tr=220,this.state.s_swt=1300,this.state.s_bw=1200,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtStartSession(),this.schedule_evtTransportTimeout(this.options.retryDelay),this.evtCheckTransport(),this.evtCheckBW();else if(140==this.state.s_m)this.doCONOK_CreateHTTP(t,e,s,i),this.resetCurrentRetryDelay(),this.notifyStatus("CONNECTED:STREAM-SENSING"),this.state.s_m=150,this.state.s_tr=230,this.state.s_swt=1300,this.state.s_bw=1200,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtStartSession(),this.schedule_evtTransportTimeout(this.options.retryDelay),this.evtCheckTransport(),this.evtCheckBW();else{var n;if(502==(null!=(n=this.state.s_ws)?n.m:null))this.doCONOK_BindWS_Streaming(t,e,s,i),this.notifyStatus("CONNECTED:WS-STREAMING"),this.state.s_ws.m=503,this.state.s_ws.p=510,this.state.s_ws.k=520,this.state.s_ws.s=550,this.state.s_rhb=320,this.state.s_slw=330,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtSendPendingControls(),this.evtSendPendingMessages(),this.schedule_evtKeepaliveTimeout(Jt.sure(this.keepaliveInterval)),this.evtSelectRhb();else if(610==(null!=(n=this.state.s_wp)?n.p:null))this.doCONOK_BindWS_Polling(t,e,s,i),this.notifyStatus("CONNECTED:WS-POLLING"),this.state.s_wp.p=611,this.state.traceState();else if(613==(null!=(n=this.state.s_wp)?n.p:null))this.doCONOK_BindWS_Polling(t,e,s,i),this.state.s_wp.p=611,this.state.traceState();else if(800==(null!=(n=this.state.s_hs)?n.m:null))this.doCONOK_BindHTTP_Streaming(t,e,s,i),this.notifyStatus("CONNECTED:HTTP-STREAMING"),this.state.s_hs.m=802,this.state.s_hs.p=810,this.state.s_hs.k=820,this.state.s_rhb=320,this.state.s_slw=330,this.state.traceState(),this.cancel_evtTransportTimeout(),this.schedule_evtKeepaliveTimeout(Jt.sure(this.keepaliveInterval)),this.evtSelectRhb();else if(801==(null!=(n=this.state.s_hs)?n.m:null))this.doCONOK_BindHTTP_Streaming(t,e,s,i),this.notifyStatus("CONNECTED:HTTP-STREAMING"),this.state.s_hs.m=802,this.state.s_hs.p=810,this.state.s_hs.k=820,this.state.s_rhb=320,this.state.s_slw=330,this.state.traceState(),this.cancel_evtTransportTimeout(),this.schedule_evtKeepaliveTimeout(Jt.sure(this.keepaliveInterval)),this.evtSelectRhb();else if(900==(null!=(n=this.state.s_hp)?n.m:null))this.doCONOK_BindHTTP_Polling(t,e,s,i),this.notifyStatus("CONNECTED:HTTP-POLLING"),this.state.s_hp.m=901,this.state.traceState();else 903==(null!=(n=this.state.s_hp)?n.m:null)&&(this.doCONOK_BindHTTP_Polling(t,e,s,i),this.state.s_hp.m=901,this.state.traceState())}},evtSERVNAME:function(t){this.traceEvent("SERVNAME"),ks.isDebugEnabled()&&ks.debug("SERVNAME "+t),this.state.inPushing()&&(this.doSERVNAME(t),this.state.inStreaming()&&this.evtRestartKeepalive())},evtCLIENTIP:function(t){this.traceEvent("CLIENTIP"),ks.isDebugEnabled()&&ks.debug("CLIENTIP "+t),this.state.inPushing()&&(this.doCLIENTIP(t),this.state.inStreaming()&&this.evtRestartKeepalive())},evtCONS:function(t){this.traceEvent("CONS"),ks.isDebugEnabled()&&ks.debug("CONS "+m.string(t)),this.state.inPushing()&&(this.doCONS(t),this.state.inStreaming()&&this.evtRestartKeepalive())},evtPROBE:function(){this.traceEvent("PROBE"),ks.isDebugEnabled()&&ks.debug("PROBE"),this.state.inPushing()&&this.state.inStreaming()&&this.evtRestartKeepalive()},evtNOOP:function(){this.traceEvent("NOOP"),this.state.inPushing()&&this.state.inStreaming()&&this.evtRestartKeepalive()},evtSYNC:function(t){this.traceEvent("SYNC"),ks.isDebugEnabled()&&ks.debug("SYNC "+t);var e=!0;300!=(null!=(i=this.state.s_w)?i.p:null)?n=510==(null!=(i=this.state.s_ws)?i.p:null):n=!0;n?s=!0:s=810==(null!=(n=this.state.s_hs)?n.p:null);if(s)e=this.evtSYNC_PushingRegion(t),this.evtRestartKeepalive();else{var s,i,n;if(220!=this.state.s_tr&&230!=this.state.s_tr)n=611==(null!=(i=this.state.s_wp)?i.p:null);else n=!0;if(n)s=!0;else s=901==(null!=(n=this.state.s_hp)?n.m:null);(s||1001==this.state.s_rec)&&(e=this.evtSYNC_PushingRegion(t))}e&&this.evtSYNC_PushingRegion(t)},evtSYNC_PushingRegion:function(t){var e=1e3*t;if(null!=this.state.s_slw){var s=this.state.s_slw;if(null!=s)switch(s){case 330:this.doSYNC(e),this.state.s_slw=331,this.state.traceState();break;case 331:var i=this.doSYNC_G(e);this.state.s_slw=332,this.state.traceState(),this.evtCheckAvg(i);break;case 333:i=this.doSYNC_NG(e);this.state.s_slw=332,this.state.traceState(),this.evtCheckAvg(i)}}return!1},evtMSGDONE:function(t,e,s){this.traceEvent("MSGDONE"),ks.isDebugEnabled()&&ks.debug("MSGDONE "+t+" "+e+" "+s),this.state.inPushing()&&(this.isFreshData()?(this.doMSGDONE(t,e,s),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtMSGFAIL:function(t,e,s,i){this.traceEvent("MSGFAIL"),ks.isDebugEnabled()&&ks.debug("MSGFAIL "+t+" "+e+" "+s+" "+i),this.state.inPushing()&&(this.isFreshData()?(this.doMSGFAIL(t,e,s,i),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtU:function(t,e,s,i){this.traceEvent("U"),ks.isDebugEnabled()&&ks.debug(""+i),this.state.inPushing()&&(this.isFreshData()?(this.doU(t,e,s),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtSUBOK:function(t,e,s){this.traceEvent("SUBOK"),ks.isDebugEnabled()&&ks.debug("SUBOK "+t+" "+e+" "+s),this.state.inPushing()&&(this.isFreshData()?(this.doSUBOK(t,e,s),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtSUBCMD:function(t,e,s,i,n){this.traceEvent("SUBCMD"),ks.isDebugEnabled()&&ks.debug("SUBCMD "+t+" "+e+" "+s+" "+i+" "+n),this.state.inPushing()&&(this.isFreshData()?(this.doSUBCMD(t,e,s,i,n),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtUNSUB:function(t){this.traceEvent("UNSUB"),ks.isDebugEnabled()&&ks.debug("UNSUB "+t),this.state.inPushing()&&(this.isFreshData()?(this.doUNSUB(t),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtEOS:function(t,e){this.traceEvent("EOS"),ks.isDebugEnabled()&&ks.debug("EOS "+t+" "+e),this.state.inPushing()&&(this.isFreshData()?(this.doEOS(t,e),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtCS:function(t,e){this.traceEvent("CS"),ks.isDebugEnabled()&&ks.debug("CS "+t+" "+e),this.state.inPushing()&&(this.isFreshData()?(this.doCS(t,e),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtOV:function(t,e,s){this.traceEvent("OV"),ks.isDebugEnabled()&&ks.debug("OV "+t+" "+e+" "+s),this.state.inPushing()&&(this.isFreshData()?(this.doOV(t,e,s),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtCONF:function(t,e){this.traceEvent("CONF"),ks.isDebugEnabled()&&ks.debug("CONF "+t+" "+m.string(e)),this.state.inPushing()&&(this.isFreshData()?(this.doCONF(t,e),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtCheckAvg:function(t){if(this.traceEvent("check.avg"),332==this.state.s_slw)switch(t._hx_index){case 0:this.state.s_slw=331,this.state.traceState();break;case 1:this.state.s_slw=333,this.state.traceState();break;case 2:this.disableStreaming(),this.cause="slow",this.state.s_slw=334,this.state.traceState(),this.evtForcePolling()}},evtSendPendingControls:function(){this.traceEvent("send.pending.controls");var t,e=this.getPendingControls();340!=(null!=(t=this.state.s_w)?t.s:null)||d.empty(e)?550!=(null!=(t=this.state.s_ws)?t.s:null)||d.empty(e)?630!=(null!=(t=this.state.s_wp)?t.s:null)||d.empty(e)||(this.sendPengingControlsWS(e),this.state.s_wp.s=630,this.state.traceState()):(this.sendPengingControlsWS(e),this.state.s_ws.s=550,this.state.traceState(),this.evtRestartHeartbeat()):(this.sendPengingControlsWS(e),this.state.s_w.s=340,this.state.traceState(),this.evtRestartHeartbeat())},evtSendPendingMessages:function(){var t;(this.traceEvent("send.pending.messages"),340==(null!=(t=this.state.s_w)?t.s:null)&&d.exists(this.messageManagers,(function(t){return t.isPending()})))?(this.sendPendingMessagesWS(),this.state.s_w.s=340,this.state.traceState(),this.genAckMessagesWS(),this.evtRestartHeartbeat()):550==(null!=(t=this.state.s_ws)?t.s:null)&&d.exists(this.messageManagers,(function(t){return t.isPending()}))?(this.sendPendingMessagesWS(),this.state.s_ws.s=550,this.state.traceState(),this.genAckMessagesWS(),this.evtRestartHeartbeat()):630==(null!=(t=this.state.s_wp)?t.s:null)&&d.exists(this.messageManagers,(function(t){return t.isPending()}))&&(this.sendPendingMessagesWS(),this.state.s_wp.s=630,this.state.traceState(),this.genAckMessagesWS())},evtSelectRhb:function(){this.traceEvent("select.rhb"),320==this.state.s_rhb&&(0==this.rhb_grantedInterval?0==this.options.reverseHeartbeatInterval?(this.state.s_rhb=321,this.state.traceState()):(this.rhb_currentInterval=this.options.reverseHeartbeatInterval,this.state.s_rhb=322,this.state.traceState(),this.schedule_evtRhbTimeout(this.rhb_currentInterval)):this.options.reverseHeartbeatInterval>0&&this.options.reverseHeartbeatInterval<Jt.sure(this.rhb_grantedInterval)?(this.rhb_currentInterval=this.options.reverseHeartbeatInterval,this.state.s_rhb=323,this.state.traceState(),this.schedule_evtRhbTimeout(this.rhb_currentInterval)):(this.rhb_currentInterval=this.rhb_grantedInterval,this.state.s_rhb=323,this.state.traceState(),this.schedule_evtRhbTimeout(Jt.sure(this.rhb_currentInterval))))},evtExtSetReverseHeartbeatInterval:function(){if(this.traceEvent("setReverseHeartbeatInterval"),null!=this.state.s_rhb){var t=this.state.s_rhb;if(null!=t)switch(t){case 321:0!=this.options.reverseHeartbeatInterval&&(this.rhb_currentInterval=this.options.reverseHeartbeatInterval,this.state.s_rhb=322,this.state.traceState(),this.schedule_evtRhbTimeout(this.rhb_currentInterval));break;case 322:0==this.options.reverseHeartbeatInterval?(this.state.s_rhb=321,this.state.traceState(),this.cancel_evtRhbTimeout()):(this.rhb_currentInterval=this.options.reverseHeartbeatInterval,this.state.s_rhb=322,this.state.traceState());break;case 323:this.options.reverseHeartbeatInterval>0&&this.options.reverseHeartbeatInterval<Jt.sure(this.rhb_grantedInterval)?(this.rhb_currentInterval=this.options.reverseHeartbeatInterval,this.state.s_rhb=323,this.state.traceState()):(this.rhb_currentInterval=this.rhb_grantedInterval,this.state.s_rhb=323,this.state.traceState())}}},evtRestartHeartbeat:function(){if(this.traceEvent("restart.heartbeat"),null!=this.state.s_rhb){var t=this.state.s_rhb;if(null!=t)switch(t){case 322:this.state.s_rhb=322,this.state.traceState(),this.cancel_evtRhbTimeout(),this.schedule_evtRhbTimeout(Jt.sure(this.rhb_currentInterval));break;case 323:this.state.s_rhb=323,this.state.traceState(),this.cancel_evtRhbTimeout(),this.schedule_evtRhbTimeout(Jt.sure(this.rhb_currentInterval));break;case 324:0==this.rhb_grantedInterval?0!=this.options.reverseHeartbeatInterval?(this.rhb_currentInterval=this.options.reverseHeartbeatInterval,this.state.s_rhb=322,this.state.traceState(),this.schedule_evtRhbTimeout(this.rhb_currentInterval)):(this.state.s_rhb=321,this.state.traceState()):this.options.reverseHeartbeatInterval>0&&this.options.reverseHeartbeatInterval<Jt.sure(this.rhb_grantedInterval)?(this.rhb_currentInterval=this.options.reverseHeartbeatInterval,this.state.s_rhb=323,this.state.traceState(),this.schedule_evtRhbTimeout(this.rhb_currentInterval)):(this.rhb_currentInterval=this.rhb_grantedInterval,this.state.s_rhb=323,this.state.traceState(),this.schedule_evtRhbTimeout(Jt.sure(this.rhb_currentInterval)))}}},evtRhbTimeout:function(){this.traceEvent("rhb.timeout"),(322==this.state.s_rhb||323==this.state.s_rhb)&&(this.state.s_rhb=324,this.state.traceState(),this.cancel_evtRhbTimeout(),this.evtSendHeartbeat())},evtDisposeCtrl:function(){this.traceEvent("du:dispose.ctrl"),this.disposeCtrl()},evtStartRecovery:function(){if(this.traceEvent("start.recovery"),1e3==this.state.s_rec){var t=process.hrtime();this.recoverTs=t[0]+t[1]/1e9,this.state.s_rec=1e3,this.state.traceState()}},evtRecoveryTimeout:function(){this.traceEvent("recovery.timeout"),1e3==this.state.s_rec&&(this.sendRecovery(),this.state.s_rec=1001,this.state.traceState(),this.cancel_evtRecoveryTimeout(),this.schedule_evtTransportTimeout(this.options.retryDelay))},evtCheckRecoveryTimeout:function(t){if(this.traceEvent("check.recovery.timeout"),1002==this.state.s_rec){var e=this.options.retryDelay;if(fe.plus(this.connectTs,e)<fe.plus(this.recoverTs,this.options.sessionRecoveryTimeout)){this.cause="recovery.error";var s=process.hrtime(),i=fe.minus(s[0]+s[1]/1e9,this.connectTs),n=e>de.toMillis(i)?pe.minus(e,de.toMillis(i)):pe.ZERO;this.state.s_rec=1003,this.state.traceState(),Ms.isErrorEnabled()&&(n>0?Ms.isErrorEnabled()&&Ms.error("Retrying recovery in "+n+"ms. Cause: "+m.string(t)):Ms.isErrorEnabled()&&Ms.error("Retrying recovery. Cause: "+m.string(t))),this.schedule_evtRetryTimeout(n)}else this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="recovery.timeout",this.state.goto_m_from_rec(113),this.exit_rec_to_m(),this.entry_m113(k.recovery_timeout)}},evtCreate:function(){this.traceEvent("du:create"),(20==this.state.s_du||23==this.state.s_du)&&(this.state.s_du=21,this.state.traceState())},evtCheckTransport:function(){if(this.traceEvent("check.transport"),1300==this.state.s_swt)if(220==this.state.s_tr||230==this.state.s_tr||260==this.state.s_tr)this.state.s_swt=1301,this.state.traceState();else{var t=this.getBestForBinding();t==N.BFB_ws_streaming&&(210==this.state.s_tr||240==this.state.s_tr)||t==N.BFB_http_streaming&&270==this.state.s_tr&&710==this.state.s_h||t==N.BFB_ws_polling&&250==this.state.s_tr||t==N.BFB_http_polling&&270==this.state.s_tr&&720==this.state.s_h?(this.state.s_swt=1301,this.state.traceState()):(this.state.s_swt=1302,this.state.traceState(),this.evtSendControl(Jt.sure(this.switchRequest)))}},evtCheckBW:function(){this.traceEvent("check.bw"),1200==this.state.s_bw&&(this.bw_requestedMaxBandwidth!=this.options.requestedMaxBandwidth&&this.options.realMaxBandwidth!=De.BWUnmanaged?(this.bw_requestedMaxBandwidth=this.options.requestedMaxBandwidth,this.state.s_bw=1202,this.state.traceState(),this.evtSendControl(Jt.sure(this.constrainRequest))):(this.state.s_bw=1201,this.state.traceState()))},evtCheckCtrlRequests:function(){if(this.traceEvent("check.ctrl.requests"),1100==this.state.s_ctrl){var t=this.getPendingControls();d.empty(t)?d.exists(this.messageManagers,(function(t){return t.isPending()}))?(this.sendPendingMessagesHTTP(),this.state.s_ctrl=1102,this.state.traceState(),this.evtRestartHeartbeat(),this.schedule_evtCtrlTimeout(this.options.retryDelay)):324==this.state.s_rhb?(this.sendHeartbeatHTTP(),this.state.s_ctrl=1102,this.state.traceState(),this.evtRestartHeartbeat(),this.schedule_evtCtrlTimeout(this.options.retryDelay)):(this.state.s_ctrl=1101,this.state.traceState()):(this.sendPendingControlsHTTP(t),this.state.s_ctrl=1102,this.state.traceState(),this.evtRestartHeartbeat(),this.schedule_evtCtrlTimeout(this.options.retryDelay))}},evtCtrlDone:function(){this.traceEvent("ctrl.done"),1102==this.state.s_ctrl&&(this.closeCtrl(),this.state.s_ctrl=1100,this.state.traceState(),this.cancel_evtCtrlTimeout(),this.evtCheckCtrlRequests())},evtCtrlError:function(){if(this.traceEvent("ctrl.error"),1102==this.state.s_ctrl){this.disposeCtrl();var t=this.waitingInterval(this.options.retryDelay,this.ctrl_connectTs);this.state.s_ctrl=1103,this.state.traceState(),this.cancel_evtCtrlTimeout(),this.schedule_evtCtrlTimeout(t)}},evtCtrlTimeout:function(){if(this.traceEvent("ctrl.timeout"),null!=this.state.s_ctrl)if(1102==this.state.s_ctrl){this.disposeCtrl();var t=this.waitingInterval(this.options.retryDelay,this.ctrl_connectTs);this.state.s_ctrl=1103,this.state.traceState(),this.cancel_evtCtrlTimeout(),this.schedule_evtCtrlTimeout(t)}else 1103==this.state.s_ctrl&&(this.state.s_ctrl=1100,this.state.traceState(),this.cancel_evtCtrlTimeout(),this.evtCheckCtrlRequests())},evtSendControl:function(t){var e;(this.traceEvent("send.control"),340==(null!=(e=this.state.s_w)?e.s:null))?(this.sendControlWS(t),this.state.s_w.s=340,this.state.traceState(),this.evtRestartHeartbeat()):550==(null!=(e=this.state.s_ws)?e.s:null)?(this.sendControlWS(t),this.state.s_ws.s=550,this.state.traceState(),this.evtRestartHeartbeat()):630==(null!=(e=this.state.s_wp)?e.s:null)?(this.sendControlWS(t),this.state.s_wp.s=630,this.state.traceState()):1101==this.state.s_ctrl&&(this.state.s_ctrl=1100,this.state.traceState(),this.evtCheckCtrlRequests())},evtSendHeartbeat:function(){var t;(this.traceEvent("send.heartbeat"),340==(null!=(t=this.state.s_w)?t.s:null))?(this.sendHeartbeatWS(),this.state.s_w.s=340,this.state.traceState(),this.evtRestartHeartbeat()):550==(null!=(t=this.state.s_ws)?t.s:null)?(this.sendHeartbeatWS(),this.state.s_ws.s=550,this.state.traceState(),this.evtRestartHeartbeat()):1101==this.state.s_ctrl&&(this.state.s_ctrl=1100,this.state.traceState(),this.evtCheckCtrlRequests())},evtStartSession:function(){this.traceEvent("du:start.session"),Ms.isInfoEnabled()&&Ms.info("Starting new session: "+this.sessionId),21==this.state.s_du&&(this.state.s_du=22,this.state.traceState())},evtEndSession:function(){Ms.isInfoEnabled()&&Ms.info("Destroying session: "+this.sessionId)},evtRetry:function(t,e){this.traceEvent("du:retry"),Ms.isErrorEnabled()&&(null!=e&&e>0?Ms.isErrorEnabled()&&Ms.error("Retrying connection in "+e+"ms. Cause: "+F(t)):Ms.isErrorEnabled()&&Ms.error("Retrying connection. Cause: "+F(t)));var s=!0;switch(this.state.s_du){case 21:this.resetSequenceMap(),this.state.s_du=23,this.state.traceState(),s=this.evtRetry_NextRegion(),this.genAbortMessages();break;case 22:this.disposeSession(),this.state.s_du=23,this.state.traceState(),s=this.evtRetry_NextRegion(),this.genAbortSubscriptions(),this.genAbortMessages()}s&&this.evtRetry_NextRegion()},evtRetry_NextRegion:function(){return!1},evtTerminate:function(t){if(this.traceEvent("du:terminate"),Ms.isInfoEnabled()&&2==t._hx_index&&Ms.isInfoEnabled()&&Ms.info("Disconnected. Cause: Requested by user"),Ms.isErrorEnabled())switch(t._hx_index){case 0:Ms.isErrorEnabled()&&Ms.error("Disconnected. Cause: "+t.code+" - "+t.msg);break;case 1:Ms.isErrorEnabled()&&Ms.error("Disconnected. Cause: "+t.error)}var e=!0;switch(this.state.s_du){case 20:case 21:case 23:this.disposeClient(),this.doUnistallPageLifecycle(),this.state.s_du=20,this.state.traceState(),e=this.evtTerminate_NextRegion(),this.genAbortMessages();break;case 22:this.disposeSession(),this.disposeClient(),this.doUnistallPageLifecycle(),this.state.s_du=20,this.state.traceState(),e=this.evtTerminate_NextRegion(),this.genAbortSubscriptions(),this.genAbortMessages()}e&&this.evtTerminate_NextRegion()},evtTerminate_NextRegion:function(){return this.evtTerminate_NetworkReachabilityRegion()},evtTerminate_NetworkReachabilityRegion:function(){switch(this.state.s_nr){case 1410:case 1411:case 1412:var t=this.nr_reachabilityManager;this.nr_reachabilityManager=null,this.state.s_nr=1400,this.state.traceState(),null!=t&&t.stopListening()}return!1},evtRetryTimeout:function(){switch(this.traceEvent("retry.timeout"),this.state.s_m){case 110:this.notifyStatus("CONNECTING"),this.sendCreateTTL(),this.state.s_m=140,this.state.traceState(),this.evtCreate(),this.schedule_evtTransportTimeout(6e4);break;case 111:this.notifyStatus("CONNECTING"),this.delayCounter.increase(),this.sendCreateTTL(),this.state.s_m=140,this.state.traceState(),this.cancel_evtRetryTimeout(),this.evtCreate(),this.schedule_evtTransportTimeout(6e4);break;case 112:this.delayCounter.increase(),this.state.s_m=116,this.state.traceState(),this.cancel_evtRetryTimeout(),this.evtSelectCreate();break;case 113:this.state.s_m=116,this.state.traceState(),this.cancel_evtRetryTimeout(),this.evtSelectCreate();break;case 115:this.state.s_m=116,this.state.traceState(),this.evtSelectCreate();break;case 150:1003==this.state.s_rec&&(this.sendRecovery(),this.state.s_rec=1001,this.state.traceState(),this.cancel_evtRetryTimeout(),this.schedule_evtTransportTimeout(this.options.retryDelay))}},evtExtSetForcedTransport:function(){this.traceEvent("setForcedTransport"),1301==this.state.s_swt&&(this.state.s_swt=1300,this.state.traceState(),this.evtCheckTransport())},evtExtSetRequestedMaxBandwidth:function(){this.traceEvent("setRequestedMaxBandwidth"),1201==this.state.s_bw&&(this.state.s_bw=1200,this.state.traceState(),this.evtCheckBW())},evtForceSlowing:function(){this.traceEvent("force.slowing"),1301==this.state.s_swt&&(this.state.s_swt=1300,this.state.traceState(),this.evtCheckTransport())},evtForcePolling:function(){this.traceEvent("force.polling"),1301==this.state.s_swt&&(this.state.s_swt=1300,this.state.traceState(),this.evtCheckTransport())},evtSendMessage:function(t){var e;(this.traceEvent("send.message"),340==(null!=(e=this.state.s_w)?e.s:null))?(this.sendMsgWS(t),this.state.s_w.s=340,this.state.traceState(),t.evtWSSent(),this.evtRestartHeartbeat()):550==(null!=(e=this.state.s_ws)?e.s:null)?(this.sendMsgWS(t),this.state.s_ws.s=550,this.state.traceState(),t.evtWSSent(),this.evtRestartHeartbeat()):630==(null!=(e=this.state.s_wp)?e.s:null)?(this.sendMsgWS(t),this.state.s_wp.s=630,this.state.traceState(),t.evtWSSent()):1101==this.state.s_ctrl&&(this.state.s_ctrl=1100,this.state.traceState(),this.evtCheckCtrlRequests())},evtSwitchTransport:function(){this.traceEvent("switch.transport");var t=!0;1302!=this.state.s_swt&&1303!=this.state.s_swt||(this.state.s_swt=1300,this.state.traceState(),t=this.evtSwitchTransport_forwardToTransportRegion(),this.evtCheckTransport()),t&&this.evtSwitchTransport_forwardToTransportRegion()},evtSwitchTransport_forwardToTransportRegion:function(){var t,e=P.TC_otherError("Selected transport "+this.options.forcedTransport+" is not available");if(200==this.state.s_tr)switch(this.getBestForBinding()._hx_index){case 0:this.notifyStatus("DISCONNECTED"),this.state.goto_m_from_session(100),this.evtEndSession(),this.evtTerminate(e);break;case 1:this.openWS_Bind(),this.state.s_tr=240,this.state.s_ws=new H(500),this.state.traceState(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 2:this.openWS_Bind(),this.state.s_tr=250,this.state.s_wp=new U(600),this.state.traceState(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 3:this.sendBindHTTP_Streaming(),this.state.s_tr=270,this.state.s_h=710,this.state.s_hs=new V(800),this.state.s_ctrl=1100,this.state.traceState(),this.evtCheckCtrlRequests(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 4:this.sendBindHTTP_Polling(),this.state.s_tr=270,this.state.s_h=720,this.state.s_hp=new K(900),this.state.s_rhb=320,this.state.s_ctrl=1100,this.state.traceState(),this.evtCheckCtrlRequests(),this.schedule_evtIdleTimeout(pe.plus(Jt.sure(this.idleTimeout),this.options.retryDelay)),this.evtSelectRhb()}else if(811==(null!=(t=this.state.s_hs)?t.p:null))switch(this.getBestForBinding()._hx_index){case 0:this.notifyStatus("DISCONNECTED"),this.state.goto_m_from_hs(100),this.exit_hs_to_m(),this.evtTerminate(e);break;case 1:this.openWS_Bind(),this.state.clear_hs(),this.state.s_h=null,this.state.s_ctrl=null,this.state.s_tr=240,this.state.s_ws=new H(500),this.state.traceState(),this.exit_hs(),this.exit_ctrl(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 2:this.openWS_Bind(),this.state.clear_hs(),this.state.s_h=null,this.state.s_ctrl=null,this.state.s_tr=250,this.state.s_wp=new U(600),this.state.traceState(),this.exit_hs(),this.exit_ctrl(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 3:this.sendBindHTTP_Streaming(),this.state.s_hs=new V(800),this.state.traceState(),this.exit_hs(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 4:this.sendBindHTTP_Polling(),this.state.clear_hs(),this.state.s_h=720,this.state.s_hp=new K(900),this.state.s_rhb=320,this.state.traceState(),this.exit_hs(),this.schedule_evtIdleTimeout(pe.plus(Jt.sure(this.idleTimeout),this.options.retryDelay)),this.evtSelectRhb()}else if(904==(null!=(t=this.state.s_hp)?t.m:null))switch(this.getBestForBinding()._hx_index){case 0:this.notifyStatus("DISCONNECTED"),this.state.goto_m_from_hp(100),this.exit_hp_to_m(),this.evtTerminate(e);break;case 1:this.openWS_Bind(),this.state.clear_hp(),this.state.s_h=null,this.state.s_ctrl=null,this.state.s_tr=240,this.state.s_ws=new H(500),this.state.traceState(),this.exit_hp(),this.exit_ctrl(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 2:this.openWS_Bind(),this.state.clear_hp(),this.state.s_h=null,this.state.s_ctrl=null,this.state.s_tr=250,this.state.s_wp=new U(600),this.state.traceState(),this.exit_hp(),this.exit_ctrl(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 3:this.sendBindHTTP_Streaming(),this.state.clear_hp(),this.state.s_h=710,this.state.s_hs=new V(800),this.state.traceState(),this.exit_hp(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 4:this.sendBindHTTP_Polling(),this.state.s_hp=new K(900),this.state.s_rhb=320,this.state.traceState(),this.exit_hp(),this.schedule_evtIdleTimeout(pe.plus(Jt.sure(this.idleTimeout),this.options.retryDelay)),this.evtSelectRhb()}return!1},onFreshData:function(){if(this.rec_serverProg!=this.rec_clientProg)throw new Yt("Assertion failure: rec_serverProg == rec_clientProg");this.rec_serverProg+=1,this.rec_clientProg+=1},onStaleData:function(){if(this.rec_serverProg>=this.rec_clientProg)throw new Yt("Assertion failure: rec_serverProg < rec_clientProg");this.rec_serverProg+=1},isFreshData:function(){return this.rec_serverProg==this.rec_clientProg},openWS:function(t,e){var s=this;return this.wsFactory(t,e,(function(t){global.setImmediate((function(){s.lock.synchronized((function(){t.isDisposed()||s.evtWSOpen()}))}))}),(function(t,e){global.setImmediate((function(){s.lock.synchronized((function(){if(!t.isDisposed())try{s.evtMessage(e)}catch(t){var i=Gt.caught(t);Ms.isErrorEnabled()&&Ms.error(i.get_message()+"\n"+i.details()),s.evtExtDisconnect(P.TC_standardError(61,i.get_message()))}}))}))}),(function(t,e){global.setImmediate((function(){s.lock.synchronized((function(){t.isDisposed()||s.evtTransportError()}))}))}))},openWS_Create:function(){var t=process.hrtime();this.connectTs=t[0]+t[1]/1e9,this.serverInstanceAddress=this.getServerAddress(),this.ws=this.openWS(qe.build(this.serverInstanceAddress,"lightstreamer"),this.options.httpExtraHeaders)},openWS_Bind:function(){var t=process.hrtime();this.connectTs=t[0]+t[1]/1e9,this.ws=this.openWS(qe.build(Jt.sure(this.serverInstanceAddress),"lightstreamer"),this.getHeadersForRequestOtherThanCreate())},sendCreateWS:function(){var t=new le;this.options.keepaliveInterval>0&&t.LS_keepalive_millis(this.options.keepaliveInterval),this.rhb_grantedInterval=this.options.reverseHeartbeatInterval,this.rhb_grantedInterval>0&&t.LS_inactivity_millis(this.rhb_grantedInterval),this.bw_requestedMaxBandwidth=this.options.requestedMaxBandwidth;var e=this.bw_requestedMaxBandwidth;null!=e&&0==e._hx_index&&t.LS_requested_max_bandwidth_Float(e.bw),null!=this.details.adapterSet&&t.LS_adapter_set(this.details.adapterSet),null!=this.details.user&&t.LS_user(this.details.user),t.LS_cid(xs),null!=this.sessionId&&t.LS_old_session(this.sessionId),this.options.slowingEnabled||t.LS_send_sync(!1),null!=this.cause&&(t.LS_cause(this.cause),this.cause=null),ks.isInfoEnabled()&&ks.info("Sending session create: "+m.string(t)),null!=this.details.password&&t.LS_password(this.details.password),Jt.sure(this.ws).send("wsok"),Jt.sure(this.ws).send("create_session\r\n"+t.getEncodedString())},sendBindWS_Streaming:function(){var t=new le;t.LS_session(Jt.sure(this.sessionId)),this.options.keepaliveInterval>0&&t.LS_keepalive_millis(this.options.keepaliveInterval),this.rhb_grantedInterval=this.options.reverseHeartbeatInterval,this.rhb_grantedInterval>0&&t.LS_inactivity_millis(this.rhb_grantedInterval),this.options.slowingEnabled||t.LS_send_sync(!1),null!=this.cause&&(t.LS_cause(this.cause),this.cause=null),ks.isInfoEnabled()&&ks.info("Sending session bind: "+m.string(t)),Jt.sure(this.ws).send("wsok"),Jt.sure(this.ws).send("bind_session\r\n"+t.getEncodedString())},sendBindWS_FirstPolling:function(){var t=new le;t.LS_session(Jt.sure(this.sessionId)),t.LS_polling(!0),t.LS_polling_millis(this.options.pollingInterval),this.idleTimeout=this.options.idleTimeout,t.LS_idle_millis(this.idleTimeout),null!=this.cause&&(t.LS_cause(this.cause),this.cause=null),ks.isInfoEnabled()&&ks.info("Sending session bind: "+m.string(t)),Jt.sure(this.ws).send("bind_session\r\n"+t.getEncodedString())},sendBindWS_Polling:function(){var t=new le;t.LS_polling(!0),t.LS_polling_millis(this.options.pollingInterval),this.idleTimeout=this.options.idleTimeout,t.LS_idle_millis(this.idleTimeout),null!=this.cause&&(t.LS_cause(this.cause),this.cause=null),ks.isInfoEnabled()&&ks.info("Sending session bind: "+m.string(t)),Jt.sure(this.ws).send("bind_session\r\n"+t.getEncodedString())},sendDestroyWS:function(t){null==t&&(t="api");var e=new le;e.LS_reqId(this.generateFreshReqId()),e.LS_op("destroy"),e.LS_close_socket(!0),e.LS_cause(t),ks.isInfoEnabled()&&ks.info("Sending session destroy: "+m.string(e)),Jt.sure(this.ws).send("control\r\n"+e.getEncodedString())},sendHttpRequest:function(t,e,s){var i=this;return this.httpFactory(t,e.getEncodedString(),s,(function(t,e){global.setImmediate((function(){i.lock.synchronized((function(){if(!t.isDisposed())try{i.evtMessage(e)}catch(t){var s=Gt.caught(t);Ms.isErrorEnabled()&&Ms.error(s.get_message()+"\n"+s.details()),i.evtExtDisconnect(P.TC_standardError(61,s.get_message()))}}))}))}),(function(t,e){global.setImmediate((function(){i.lock.synchronized((function(){t.isDisposed()||i.evtTransportError()}))}))}),(function(t){}))},sendCreateHTTP:function(){var t=new le;t.LS_polling(!0),t.LS_polling_millis(0),t.LS_idle_millis(0),this.bw_requestedMaxBandwidth=this.options.requestedMaxBandwidth;var e=this.bw_requestedMaxBandwidth;null!=e&&0==e._hx_index&&t.LS_requested_max_bandwidth_Float(e.bw),null!=this.details.adapterSet&&t.LS_adapter_set(this.details.adapterSet),null!=this.details.user&&t.LS_user(this.details.user),t.LS_cid(xs),null!=this.sessionId&&t.LS_old_session(this.sessionId),null!=this.cause&&(t.LS_cause(this.cause),this.cause=null),ks.isInfoEnabled()&&ks.info("Sending session create: "+m.string(t)),null!=this.details.password&&t.LS_password(this.details.password);var s=process.hrtime();this.connectTs=s[0]+s[1]/1e9,this.serverInstanceAddress=this.getServerAddress(),this.http=this.sendHttpRequest(qe.build(this.serverInstanceAddress,"/lightstreamer"+Cs+"/create_session.txt?LS_protocol="+Ts),t,this.options.httpExtraHeaders)},sendBindHTTP_Streaming:function(){var t=new le;t.LS_session(Jt.sure(this.sessionId)),t.LS_content_length(this.options.contentLength),this.options.keepaliveInterval>0&&t.LS_keepalive_millis(this.options.keepaliveInterval),this.rhb_grantedInterval=this.options.reverseHeartbeatInterval,this.rhb_grantedInterval>0&&t.LS_inactivity_millis(this.rhb_grantedInterval),this.options.slowingEnabled||t.LS_send_sync(!1),null!=this.cause&&(t.LS_cause(this.cause),this.cause=null),ks.isInfoEnabled()&&ks.info("Sending session bind: "+m.string(t));var e=process.hrtime();this.connectTs=e[0]+e[1]/1e9,this.http=this.sendHttpRequest(qe.build(Jt.sure(this.serverInstanceAddress),"/lightstreamer/bind_session.txt?LS_protocol="+Ts),t,this.getHeadersForRequestOtherThanCreate())},sendBindHTTP_Polling:function(){var t=new le;t.LS_session(Jt.sure(this.sessionId)),t.LS_polling(!0),t.LS_polling_millis(this.options.pollingInterval),this.idleTimeout=this.options.idleTimeout,t.LS_idle_millis(this.idleTimeout),null!=this.cause&&(t.LS_cause(this.cause),this.cause=null),this.rhb_grantedInterval=0,ks.isInfoEnabled()&&ks.info("Sending session bind: "+m.string(t));var e=process.hrtime();this.connectTs=e[0]+e[1]/1e9,this.http=this.sendHttpRequest(qe.build(Jt.sure(this.serverInstanceAddress),"/lightstreamer/bind_session.txt?LS_protocol="+Ts),t,this.getHeadersForRequestOtherThanCreate())},sendCreateTTL:function(){var t=new le;t.LS_ttl_millis("unlimited"),t.LS_polling(!0),t.LS_polling_millis(0),t.LS_idle_millis(0),this.bw_requestedMaxBandwidth=this.options.requestedMaxBandwidth;var e=this.bw_requestedMaxBandwidth;null!=e&&0==e._hx_index&&t.LS_requested_max_bandwidth_Float(e.bw),null!=this.details.adapterSet&&t.LS_adapter_set(this.details.adapterSet),null!=this.details.user&&t.LS_user(this.details.user),t.LS_cid(xs),null!=this.sessionId&&t.LS_old_session(this.sessionId),null!=this.cause&&(t.LS_cause(this.cause),this.cause=null),ks.isInfoEnabled()&&ks.info("Sending session create: "+m.string(t)),null!=this.details.password&&t.LS_password(this.details.password);var s=process.hrtime();this.connectTs=s[0]+s[1]/1e9,this.serverInstanceAddress=this.getServerAddress(),this.http=this.sendHttpRequest(qe.build(this.serverInstanceAddress,"/lightstreamer"+Cs+"/create_session.txt?LS_protocol="+Ts),t,this.options.httpExtraHeaders)},sendRecovery:function(){var t=new le;t.LS_session(Jt.sure(this.sessionId)),t.LS_recovery_from(this.rec_clientProg),t.LS_polling(!0),t.LS_polling_millis(0),t.LS_idle_millis(0),null!=this.cause&&(t.LS_cause(this.cause),this.cause=null),ks.isInfoEnabled()&&ks.info("Sending session recovery: "+m.string(t));var e=process.hrtime();this.connectTs=e[0]+e[1]/1e9,this.http=this.sendHttpRequest(qe.build(Jt.sure(this.serverInstanceAddress),"/lightstreamer/bind_session.txt?LS_protocol="+Ts),t,this.getHeadersForRequestOtherThanCreate())},disposeWS:function(){null!=this.ws&&(this.ws.dispose(),this.ws=null)},closeWS:function(){null!=this.ws&&(this.ws.dispose(),this.ws=null)},suspendWS_Streaming:function(){Ms.isWarnEnabled()&&Ms.warn("Websocket suspended"),this.suspendedTransports.insert("WS-STREAMING")},disableWS:function(){Ms.isWarnEnabled()&&Ms.warn("Websocket disabled"),this.disabledTransports=this.disabledTransports.union(["WS-STREAMING","WS-POLLING"])},disableHTTP_Streaming:function(){Ms.isWarnEnabled()&&Ms.warn("HTTP streaming disabled"),this.disabledTransports=this.disabledTransports.union(["HTTP-STREAMING"])},disableStreaming:function(){Ms.isWarnEnabled()&&Ms.warn("Streaming disabled"),this.disabledTransports=this.disabledTransports.union(["WS-STREAMING","HTTP-STREAMING"])},enableAllTransports:function(){Ms.isInfoEnabled()&&(this.disabledTransports.count()>0||this.suspendedTransports.count()>0)&&Ms.isInfoEnabled()&&Ms.info("Transports enabled again."),this.disabledTransports=new ue,this.suspendedTransports=new ue},disposeHTTP:function(){null!=this.http&&(this.http.dispose(),this.http=null)},closeHTTP:function(){null!=this.http&&(this.http.dispose(),this.http=null)},disposeCtrl:function(){null!=this.ctrl_http&&(this.ctrl_http.dispose(),this.ctrl_http=null)},closeCtrl:function(){null!=this.ctrl_http&&(this.ctrl_http.dispose(),this.ctrl_http=null)},notifyStatus:function(t){var e=this.m_status;this.m_status=t,e!=t&&(Ms.isInfoEnabled()&&Ms.info("Status: "+t),this.clientEventDispatcher.onStatusChange(t))},getBestForCreating:function(){if(0==this.getBestForBinding()._hx_index)return D.BFC_none;var t=this.options.forcedTransport,e=this.suspendedTransports.union(this.disabledTransports.toArray());if(null==t)return e.contains("WS-STREAMING")?D.BFC_http:D.BFC_ws;switch(t){case"WS":case"WS-STREAMING":return e.contains("WS-STREAMING")?D.BFC_http:D.BFC_ws;default:return D.BFC_http}},getBestForBinding:function(){var t=this.options.forcedTransport,e=this.disabledTransports;if(null==t)return e.contains("WS-STREAMING")?e.contains("HTTP-STREAMING")?e.contains("WS-POLLING")?N.BFB_http_polling:N.BFB_ws_polling:N.BFB_http_streaming:N.BFB_ws_streaming;switch(t){case"HTTP":return e.contains("HTTP-STREAMING")?N.BFB_http_polling:N.BFB_http_streaming;case"HTTP-POLLING":return N.BFB_http_polling;case"HTTP-STREAMING":return e.contains("HTTP-STREAMING")?N.BFB_none:N.BFB_http_streaming;case"WS":return e.contains("WS-STREAMING")?e.contains("WS-POLLING")?N.BFB_none:N.BFB_ws_polling:N.BFB_ws_streaming;case"WS-POLLING":return e.contains("WS-POLLING")?N.BFB_none:N.BFB_ws_polling;case"WS-STREAMING":return e.contains("WS-STREAMING")?N.BFB_none:N.BFB_ws_streaming}},resetCurrentRetryDelay:function(){this.delayCounter.reset(this.options.retryDelay)},notifyServerErrorIfCauseIsError:function(t){switch(t._hx_index){case 0:this.clientEventDispatcher.onServerError(t.code,t.msg);break;case 1:this.clientEventDispatcher.onServerError(61,t.error)}},notifyServerError_CONERR:function(t,e){this.clientEventDispatcher.onServerError(t,e)},notifyServerError_END:function(t,e){0<t&&t<30||t>39?this.clientEventDispatcher.onServerError(39,e):this.clientEventDispatcher.onServerError(t,e)},notifyServerError_ERROR:function(t,e){this.clientEventDispatcher.onServerError(t,e)},notifyServerError_REQERR:function(t,e){11==t?this.clientEventDispatcher.onServerError(21,e):this.clientEventDispatcher.onServerError(t,e)},doCONOK:function(t,e,s,i,n){this.sessionId=t,this.details.setSessionId(t),this.requestLimit=e,null!=s?(this.keepaliveInterval=s,this.options.setKeepaliveInterval(s)):null!=i&&(this.idleTimeout=i,this.options.setIdleTimeout(i)),"*"==n||this.options.serverInstanceAddressIgnored||(n=qe.completeControlLink(n,this.getServerAddress()),this.serverInstanceAddress=n,this.details.setServerInstanceAddress(n))},doCONOK_CreateWS:function(t,e,s,i){this.doCONOK(t,e,s,null,i)},doCONOK_BindWS_Streaming:function(t,e,s,i){this.doCONOK(t,e,s,null,i)},doCONOK_BindWS_Polling:function(t,e,s,i){this.doCONOK(t,e,null,s,i)},doCONOK_CreateHTTP:function(t,e,s,i){this.doCONOK(t,e,null,null,i)},doCONOK_BindHTTP_Streaming:function(t,e,s,i){this.doCONOK(t,e,s,null,i)},doCONOK_BindHTTP_Polling:function(t,e,s,i){this.doCONOK(t,e,null,s,i)},doSERVNAME:function(t){this.details.setServerSocketName(t)},doCLIENTIP:function(t){this.details.setClientIp(t);var e=this.lastKnownClientIp;null!=e&&e!=t&&(Ms.isInfoEnabled()&&Ms.info("Client IP changed: "+e+" -> "+t),this.enableAllTransports()),this.lastKnownClientIp=t},doCONS:function(t){this.options.setRealMaxBandwidth(t)},doLOOP:function(t){this.options.setPollingInterval(t)},doPROG:function(t){if(t>this.rec_clientProg)throw new Yt("Assertion failure: prog <= rec_clientProg");this.rec_serverProg=t},doMSGDONE:function(t,e,s){this.onFreshData();var i=this.messageManagers.filter((function(s){return s.sequence==t&&s.prog==e}));if(i.values.length-i.nRemoved>1)throw new Yt("Assertion failure: messages.length <= 1");for(var n=new Kt(i);n.hasNext();)n.next().evtMSGDONE(s)},doMSGFAIL:function(t,e,s,i){if(this.onFreshData(),39==s){var n=m.parseInt(i);if(null==n)throw new Yt("Assertion failure: count != null");for(var r=e-n+1,a=e+1;r<a;){var o=this.messageManagers.filter(function(e){return function(s){return s.sequence==t&&s.prog==e[0]}}([r++]));if(o.values.length-o.nRemoved>1)throw new Yt("Assertion failure: messages.length <= 1");for(var h=new Kt(o);h.hasNext();)h.next().evtMSGFAIL(s,i)}}else{o=this.messageManagers.filter((function(s){return s.sequence==t&&s.prog==e}));if(o.values.length-o.nRemoved>1)throw new Yt("Assertion failure: messages.length <= 1");for(h=new Kt(o);h.hasNext();)h.next().evtMSGFAIL(s,i)}},doU:function(t,e,s){this.onFreshData();var i=this.subscriptionManagers._innerMap.h[t];null!=i?i.evtU(e,s):new ft(t,this).evtU(e,s)},doSUBOK:function(t,e,s){this.onFreshData();var i=this.subscriptionManagers._innerMap.h[t];null!=i?i.evtSUBOK(e,s):new ft(t,this).evtSUBOK(e,s)},doSUBCMD:function(t,e,s,i,n){this.onFreshData();var r=this.subscriptionManagers._innerMap.h[t];null!=r?r.evtSUBCMD(e,s,i,n):new ft(t,this).evtSUBCMD(e,s,i,n)},doUNSUB:function(t){this.onFreshData();var e=this.subscriptionManagers._innerMap.h[t];null!=e&&e.evtUNSUB()},doEOS:function(t,e){this.onFreshData();var s=this.subscriptionManagers._innerMap.h[t];null!=s?s.evtEOS(e):new ft(t,this).evtEOS(e)},doCS:function(t,e){this.onFreshData();var s=this.subscriptionManagers._innerMap.h[t];null!=s?s.evtCS(e):new ft(t,this).evtCS(e)},doOV:function(t,e,s){this.onFreshData();var i=this.subscriptionManagers._innerMap.h[t];null!=i?i.evtOV(e,s):new ft(t,this).evtOV(e,s)},doCONF:function(t,e){this.onFreshData();var s=this.subscriptionManagers._innerMap.h[t];null!=s?s.evtCONF(e):new ft(t,this).evtCONF(e)},doREQOK:function(t){for(var e=this.subscriptionManagers,s=e.keys();s.hasNext();)e.get(s.next()).evtREQOK(t);this.subscriptionManagers._orderedKeys.compact();for(var i=new Kt(this.messageManagers);i.hasNext();)i.next().evtREQOK(t);this.messageManagers.compact()},doREQERR:function(t,e,s){for(var i=this.subscriptionManagers,n=i.keys();n.hasNext();)i.get(n.next()).evtREQERR(t,e,s);this.subscriptionManagers._orderedKeys.compact();for(var r=new Kt(this.messageManagers);r.hasNext();)r.next().evtREQERR(t,e,s);this.messageManagers.compact()},doSYNC:function(t){var e=process.hrtime();this.slw_refTime=e[0]+e[1]/1e9,this.slw_avgDelayMs=-t},doSYNC_G:function(t){var e=this.diffTimeSync(t);return e>this.slw_hugeDelayMs&&e>2*this.slw_avgDelayMs?this.slw_avgDelayMs>this.slw_maxAvgDelayMs&&this.options.slowingEnabled?O.SCR_bad:O.SCR_not_good:(this.slw_avgDelayMs=this.slowAvg(e),this.slw_avgDelayMs>this.slw_maxAvgDelayMs&&this.options.slowingEnabled?O.SCR_bad:(this.slw_avgDelayMs<60&&(this.slw_avgDelayMs=0),O.SCR_good))},doSYNC_NG:function(t){var e=this.diffTimeSync(t);return e>this.slw_hugeDelayMs&&e>2*this.slw_avgDelayMs?(this.slw_avgDelayMs=this.slowAvg(e),this.slw_avgDelayMs>this.slw_maxAvgDelayMs&&this.options.slowingEnabled?O.SCR_bad:(this.slw_avgDelayMs<60&&(this.slw_avgDelayMs=0),O.SCR_good)):(this.slw_avgDelayMs=this.slowAvg(e),this.slw_avgDelayMs>this.slw_maxAvgDelayMs&&this.options.slowingEnabled?O.SCR_bad:(this.slw_avgDelayMs<60&&(this.slw_avgDelayMs=0),O.SCR_not_good))},diffTimeSync:function(t){var e=process.hrtime();return fe.minus(e[0]+e[1]/1e9,this.slw_refTime)-t},slowAvg:function(t){return this.slw_avgDelayMs*this.slw_m+t*(1-this.slw_m)},schedule_evtTransportTimeout:function(t){this.transportTimer=this.createTimer("transport.timeout",t,gs(this,this.evtTransportTimeout))},schedule_evtRetryTimeout:function(t){this.retryTimer=this.createTimer("retry.timeout",t,gs(this,this.evtRetryTimeout))},schedule_evtRecoveryTimeout:function(t){this.recoveryTimer=this.createTimer("recovery.timeout",t,gs(this,this.evtRecoveryTimeout))},schedule_evtIdleTimeout:function(t){this.idleTimer=this.createTimer("idle.timeout",t,gs(this,this.evtIdleTimeout))},schedule_evtPollingTimeout:function(t){this.pollingTimer=this.createTimer("polling.timeout",t,gs(this,this.evtPollingTimeout))},schedule_evtCtrlTimeout:function(t){this.ctrlTimer=this.createTimer("ctrl.timeout",t,gs(this,this.evtCtrlTimeout))},schedule_evtKeepaliveTimeout:function(t){this.keepaliveTimer=this.createTimer("keepalive.timeout",t,gs(this,this.evtKeepaliveTimeout))},schedule_evtStalledTimeout:function(t){this.stalledTimer=this.createTimer("stalled.timeout",t,gs(this,this.evtStalledTimeout))},schedule_evtReconnectTimeout:function(t){this.reconnectTimer=this.createTimer("reconnect.timeout",t,gs(this,this.evtReconnectTimeout))},schedule_evtRhbTimeout:function(t){this.rhbTimer=this.createTimer("rhb.timeout",t,gs(this,this.evtRhbTimeout))},createTimer:function(t,e,s){var i=this;return this.timerFactory(t,e,(function(t){i.lock.synchronized((function(){t.isCanceled()||s()}))}))},cancel_evtTransportTimeout:function(){null!=this.transportTimer&&(this.transportTimer.cancel(),this.transportTimer=null)},cancel_evtRetryTimeout:function(){null!=this.retryTimer&&(this.retryTimer.cancel(),this.retryTimer=null)},cancel_evtKeepaliveTimeout:function(){null!=this.keepaliveTimer&&(this.keepaliveTimer.cancel(),this.keepaliveTimer=null)},cancel_evtStalledTimeout:function(){null!=this.stalledTimer&&(this.stalledTimer.cancel(),this.stalledTimer=null)},cancel_evtReconnectTimeout:function(){null!=this.reconnectTimer&&(this.reconnectTimer.cancel(),this.reconnectTimer=null)},cancel_evtRhbTimeout:function(){null!=this.rhbTimer&&(this.rhbTimer.cancel(),this.rhbTimer=null)},cancel_evtIdleTimeout:function(){null!=this.idleTimer&&(this.idleTimer.cancel(),this.idleTimer=null)},cancel_evtPollingTimeout:function(){null!=this.pollingTimer&&(this.pollingTimer.cancel(),this.pollingTimer=null)},cancel_evtCtrlTimeout:function(){null!=this.ctrlTimer&&(this.ctrlTimer.cancel(),this.ctrlTimer=null)},cancel_evtRecoveryTimeout:function(){null!=this.recoveryTimer&&(this.recoveryTimer.cancel(),this.recoveryTimer=null)},waitingInterval:function(t,e){var s=process.hrtime(),i=fe.minus(s[0]+s[1]/1e9,e);return i<t?t-i:0},exit_tr:function(){this.evtEndSession()},entry_m111:function(t,e){this.evtRetry(t,e),this.schedule_evtRetryTimeout(e)},entry_m112:function(t){var e=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs);this.evtRetry(t,e),this.schedule_evtRetryTimeout(e)},entry_m113:function(t){var e=this.randomPause(this.options.firstRetryMaxDelay);this.evtRetry(t,e),this.schedule_evtRetryTimeout(e)},entry_m115:function(t){this.evtRetry(t),this.evtRetryTimeout()},entry_rec:function(t,e){Ms.isErrorEnabled()&&Ms.error("Recovering connection in "+t+" ms. Cause: "+F(e)),this.evtStartRecovery(),this.schedule_evtRecoveryTimeout(t)},exit_w:function(){this.cancel_evtKeepaliveTimeout(),this.cancel_evtStalledTimeout(),this.cancel_evtReconnectTimeout(),this.cancel_evtRhbTimeout()},exit_ws:function(){this.cancel_evtTransportTimeout(),this.cancel_evtKeepaliveTimeout(),this.cancel_evtStalledTimeout(),this.cancel_evtReconnectTimeout(),this.cancel_evtRhbTimeout()},exit_wp:function(){this.cancel_evtTransportTimeout(),this.cancel_evtIdleTimeout(),this.cancel_evtPollingTimeout()},exit_hs:function(){this.cancel_evtTransportTimeout(),this.cancel_evtKeepaliveTimeout(),this.cancel_evtStalledTimeout(),this.cancel_evtReconnectTimeout(),this.cancel_evtRhbTimeout()},exit_hp:function(){this.cancel_evtIdleTimeout(),this.cancel_evtPollingTimeout(),this.cancel_evtRhbTimeout()},exit_ctrl:function(){this.cancel_evtCtrlTimeout(),this.evtDisposeCtrl()},exit_rec:function(){this.cancel_evtRecoveryTimeout(),this.cancel_evtTransportTimeout(),this.cancel_evtRetryTimeout()},exit_keepalive_unit:function(){this.cancel_evtKeepaliveTimeout(),this.cancel_evtStalledTimeout(),this.cancel_evtReconnectTimeout()},exit_w_to_m:function(){this.exit_w(),this.exit_tr()},exit_ws_to_m:function(){this.exit_ws(),this.exit_tr()},exit_wp_to_m:function(){this.exit_wp(),this.exit_tr()},exit_hs_to_m:function(){this.exit_ctrl(),this.exit_hs(),this.exit_tr()},exit_hs_to_rec:function(){this.exit_ctrl(),this.exit_hs()},exit_hp_to_m:function(){this.exit_ctrl(),this.exit_hp(),this.exit_tr()},exit_hp_to_rec:function(){this.exit_ctrl(),this.exit_hp()},exit_ctrl_to_m:function(){this.exit_ctrl(),this.exit_hs(),this.exit_hp(),this.exit_tr()},exit_rec_to_m:function(){this.exit_rec(),this.exit_tr()},randomPause:function(t){return this.randomGenerator(t)},generateFreshReqId:function(){return this.m_nextReqId+=1,this.m_nextReqId},generateFreshSubId:function(){return this.m_nextSubId+=1,this.m_nextSubId},genAbortSubscriptions:function(){for(var t=this.subscriptionManagers,e=t.keys();e.hasNext();)t.get(e.next()).evtExtAbort();this.subscriptionManagers._orderedKeys.compact()},genAckMessagesWS:function(){for(var t=new Kt(this.messageManagers.filter((function(t){return t.isPending()})));t.hasNext();)t.next().evtWSSent()},genAbortMessages:function(){for(var t=new Kt(this.messageManagers);t.hasNext();)t.next().evtAbort();this.messageManagers.compact()},resetSequenceMap:function(){this.sequenceMap.h=Object.create(null)},isSwitching:function(){return 150==this.state.s_m&&(1302==this.state.s_swt||1303==this.state.s_swt)},encodeSwitch:function(t){var e=new le;return this.swt_lastReqId=this.generateFreshReqId(),e.LS_reqId(this.swt_lastReqId),e.LS_op("force_rebind"),t&&e.LS_close_socket(!0),null!=this.cause&&(e.LS_cause(this.cause),this.cause=null),ks.isInfoEnabled()&&ks.info("Sending transport switch: "+m.string(e)),e.getEncodedString()},encodeConstrain:function(){var t=new le;this.bw_lastReqId=this.generateFreshReqId(),t.LS_reqId(this.bw_lastReqId),t.LS_op("constrain");var e=Jt.sure(this.bw_requestedMaxBandwidth);switch(e._hx_index){case 0:t.LS_requested_max_bandwidth_Float(e.bw);break;case 1:t.LS_requested_max_bandwidth("unlimited")}return ks.isInfoEnabled()&&ks.info("Sending bandwidth constrain: "+m.string(t)),t.getEncodedString()},getPendingControls:function(){var t=[];Jt.sure(this.switchRequest).isPending()&&t.push(Jt.sure(this.switchRequest)),Jt.sure(this.constrainRequest).isPending()&&t.push(Jt.sure(this.constrainRequest));for(var e=this.subscriptionManagers,s=e.keys();s.hasNext();){var i=e.get(s.next());i.isPending()&&t.push(i)}return t},sendControlWS:function(t){Jt.sure(this.ws).send(t.encodeWS())},sendMsgWS:function(t){Jt.sure(this.ws).send(t.encodeWS())},sendPengingControlsWS:function(t){this.sendBatchWS(this.prepareBatchWS("control",t,Jt.sure(this.requestLimit)))},sendPendingMessagesWS:function(){for(var t=[],e=new Kt(this.messageManagers);e.hasNext();){var s=e.next();s.isPending()&&t.push(s)}this.sendBatchWS(this.prepareBatchWS("msg",t,Jt.sure(this.requestLimit)))},sendBatchWS:function(t){for(var e=0;e<t.length;){var s=t[e++];Jt.sure(this.ws).send(s)}},sendHeartbeatWS:function(){ks.isInfoEnabled()&&ks.info("Heartbeat request"),Jt.sure(this.ws).send("heartbeat\r\n\r\n")},sendPendingControlsHTTP:function(t){this.sendBatchHTTP(this.prepareBatchHTTP(t,Jt.sure(this.requestLimit)),"control")},sendPendingMessagesHTTP:function(){for(var t=[],e=new Kt(this.messageManagers);e.hasNext();){var s=e.next();s.isPending()&&t.push(s)}this.sendBatchHTTP(this.prepareBatchHTTP(t,Jt.sure(this.requestLimit)),"msg")},sendHeartbeatHTTP:function(){ks.isInfoEnabled()&&ks.info("Heartbeat request"),this.sendBatchHTTP("\r\n","heartbeat")},sendBatchHTTP:function(t,e){var s=this,i=process.hrtime();this.ctrl_connectTs=i[0]+i[1]/1e9;var n=qe.build(Jt.sure(this.serverInstanceAddress),"/lightstreamer/"+e+".txt?LS_protocol="+Ts+"&LS_session="+this.sessionId),r=this.getHeadersForRequestOtherThanCreate();this.ctrl_http=this.ctrlFactory(n,t,r,(function(t,e){global.setImmediate((function(){s.lock.synchronized((function(){t.isDisposed()||s.evtCtrlMessage(e)}))}))}),(function(t,e){global.setImmediate((function(){s.lock.synchronized((function(){t.isDisposed()||s.evtCtrlError()}))}))}),(function(t){global.setImmediate((function(){s.lock.synchronized((function(){t.isDisposed()||s.evtCtrlDone()}))}))}))},prepareBatchWS:function(t,e,s){if(e.length<=0)throw new Yt("Assertion failure: pendings.length > 0");for(var i=[],n=0,r=e[0].encode(!0);n<e.length;){var a=new ct;for(a.addSubRequest(t),a.addSubRequest(r),++n;n<e.length&&(r=e[n].encode(!0),a.addSubRequestOnlyIfBodyIsLessThan(r,s));)++n;i.push(a.getBody())}return i},prepareBatchHTTP:function(t,e){if(t.length<=0)throw new Yt("Assertion failure: pendings.length > 0");var s=new ct,i=0,n=t[0].encode(!1);for(s.addSubRequest(n),i=1;i<t.length&&(n=t[i].encode(!1),s.addSubRequestOnlyIfBodyIsLessThan(n,e));)++i;return s.getBody()},getHeadersForRequestOtherThanCreate:function(){return this.options.httpExtraHeadersOnSessionCreationOnly?null:this.options.httpExtraHeaders},getServerAddress:function(){var t=this.details.serverAddress;return null!=t?t:Jt.sure(this.defaultServerAddress)},relateSubManager:function(t){if(null!=this.subscriptionManagers._innerMap.h[t.subId])throw new Yt("Assertion failure: subscriptionManagers[subManager.subId] == null");this.subscriptionManagers.set(t.subId,t)},unrelateSubManager:function(t){this.subscriptionManagers.remove(t.subId)},isRelatedWithSubManager:function(t){return d.has(this.subscriptionManagers,t)},relateMsgManager:function(t){this.messageManagers.values.push(new Vt(t))},unrelateMsgManager:function(t){this.messageManagers.remove(t)},getAndSetNextMsgProg:function(t){var e=this.sequenceMap.h[t];return null==e&&(e=1),this.sequenceMap.h[t]=e+1,e},onPropertyChange:function(t){this.clientEventDispatcher.onPropertyChange(t)},traceEvent:function(t){Ps.isTraceEnabled()&&Ps.trace("event: "+t+" "+this.state.toString())},connect:function(){var t=this.details.getServerAddress();if(null==t)throw new Yt("Configure the server address before trying to connect");Fs.isInfoEnabled()&&Fs.info("Connection requested: details: "+m.string(this.details)+" options: "+m.string(this.options)+" env: "+m.string(At.instance)),this.defaultServerAddress=t,this.evtExtConnect()},disconnect:function(){Fs.isInfoEnabled()&&Fs.info("Disconnection requested"),this.evtExtDisconnect(P.TC_api)},getStatus:function(){return this.m_status},sendMessage:function(t,e,s,i,n){if(n||!this.state.inDisconnected()&&!this.state.inRetryUnit())if(null!=e){if(!new l("^[a-zA-Z0-9_]*$","").match(e))throw new zt("The given sequence name is not valid. Use only alphanumeric characters plus underscore or null");var r=new Y(t,e,s,i,n,this);Fs.isInfoEnabled()&&Fs.info("Message sending requested: "+m.string(r)),r.evtExtSendMessage()}else{r=new Y(t,"UNORDERED_MESSAGES",s,i,n,this);Fs.isInfoEnabled()&&Fs.info("Message sending requested: "+m.string(r)),r.evtExtSendMessage()}else{if(Fs.isInfoEnabled()){var a=new is;a.h.text=t,a.h.sequence=null!=e?e:"UNORDERED_MESSAGES",a.h.timeout=null==s?"null":""+s,a.h.enqueueWhileDisconnected=null==n?"null":""+n,Fs.isInfoEnabled()&&Fs.info("Message sending requested: "+(null==a?"null":is.stringify(a.h)))}if(Ws.isWarnEnabled()&&Ws.warn("Message "+(null!=e?e:"UNORDERED_MESSAGES")+" "+t+" aborted"),null!=i){var o=new z;o.addListener(i),o.onAbort(t,!1)}}},subscribeExt:function(t,e){if(null==e&&(e=!1),t.isActive())throw new Yt("Cannot subscribe to an active Subscription");if(null==t.fetchItems()&&null==t.getItemGroup())throw new zt("Specify property 'items' or 'itemGroup'");if(null==t.fetchFields()&&null==t.getFieldSchema())throw new zt("Specify property 'fields' or 'fieldSchema'");var s=new dt(t,this);Fs.isInfoEnabled()&&Fs.info((e?"Internal subscription":"Subscription")+" requested: subId: "+s.subId+" "+m.string(t)),s.evtExtSubscribe()},unsubscribe:function(t){var e=t.fetch_subManager();if(null!=e){if(!this.isRelatedWithSubManager(e))throw new zt("The Subscription is not subscribed to this Client");Fs.isInfoEnabled()&&Fs.info("Unsubscription requested: subId: "+e.subId+" "+m.string(t)),e.evtExtUnsubscribe()}},getSubscriptions:function(){for(var t=[],e=this.subscriptionManagers,s=e.keys();s.hasNext();){var i=e.get(s.next()),n=i instanceof dt?i:null;if(null!=n){var r=n.m_subscription;r.isActive()&&!r.isInternal()&&t.push(r)}}return t},__class__:L};var D=h["com.lightstreamer.client.internal._ClientMachine.BestForCreatingEnum"]={__ename__:!0,__constructs__:null,BFC_ws:{_hx_name:"BFC_ws",_hx_index:0,__enum__:"com.lightstreamer.client.internal._ClientMachine.BestForCreatingEnum",toString:o},BFC_http:{_hx_name:"BFC_http",_hx_index:1,__enum__:"com.lightstreamer.client.internal._ClientMachine.BestForCreatingEnum",toString:o},BFC_none:{_hx_name:"BFC_none",_hx_index:2,__enum__:"com.lightstreamer.client.internal._ClientMachine.BestForCreatingEnum",toString:o}};D.__constructs__=[D.BFC_ws,D.BFC_http,D.BFC_none];var N=h["com.lightstreamer.client.internal._ClientMachine.BestForBindingEnum"]={__ename__:!0,__constructs__:null,BFB_none:{_hx_name:"BFB_none",_hx_index:0,__enum__:"com.lightstreamer.client.internal._ClientMachine.BestForBindingEnum",toString:o},BFB_ws_streaming:{_hx_name:"BFB_ws_streaming",_hx_index:1,__enum__:"com.lightstreamer.client.internal._ClientMachine.BestForBindingEnum",toString:o},BFB_ws_polling:{_hx_name:"BFB_ws_polling",_hx_index:2,__enum__:"com.lightstreamer.client.internal._ClientMachine.BestForBindingEnum",toString:o},BFB_http_streaming:{_hx_name:"BFB_http_streaming",_hx_index:3,__enum__:"com.lightstreamer.client.internal._ClientMachine.BestForBindingEnum",toString:o},BFB_http_polling:{_hx_name:"BFB_http_polling",_hx_index:4,__enum__:"com.lightstreamer.client.internal._ClientMachine.BestForBindingEnum",toString:o}};N.__constructs__=[N.BFB_none,N.BFB_ws_streaming,N.BFB_ws_polling,N.BFB_http_streaming,N.BFB_http_polling];var O=h["com.lightstreamer.client.internal._ClientMachine.SyncCheckResult"]={__ename__:!0,__constructs__:null,SCR_good:{_hx_name:"SCR_good",_hx_index:0,__enum__:"com.lightstreamer.client.internal._ClientMachine.SyncCheckResult",toString:o},SCR_not_good:{_hx_name:"SCR_not_good",_hx_index:1,__enum__:"com.lightstreamer.client.internal._ClientMachine.SyncCheckResult",toString:o},SCR_bad:{_hx_name:"SCR_bad",_hx_index:2,__enum__:"com.lightstreamer.client.internal._ClientMachine.SyncCheckResult",toString:o}};O.__constructs__=[O.SCR_good,O.SCR_not_good,O.SCR_bad];var k=h["com.lightstreamer.client.internal._ClientMachine.RetryCause"]={__ename__:!0,__constructs__:null,standardError:(i=function(t,e){return{_hx_index:0,code:t,msg:e,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:o}},i._hx_name="standardError",i.__params__=["code","msg"],i),ws_unavailable:{_hx_name:"ws_unavailable",_hx_index:1,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:o},ws_error:{_hx_name:"ws_error",_hx_index:2,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:o},http_error:{_hx_name:"http_error",_hx_index:3,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:o},idle_timeout:{_hx_name:"idle_timeout",_hx_index:4,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:o},stalled_timeout:{_hx_name:"stalled_timeout",_hx_index:5,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:o},ws_timeout:{_hx_name:"ws_timeout",_hx_index:6,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:o},http_timeout:{_hx_name:"http_timeout",_hx_index:7,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:o},recovery_timeout:{_hx_name:"recovery_timeout",_hx_index:8,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:o},prog_mismatch:(i=function(t,e){return{_hx_index:9,expected:t,actual:e,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:o}},i._hx_name="prog_mismatch",i.__params__=["expected","actual"],i),page_frozen:{_hx_name:"page_frozen",_hx_index:10,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:o}};k.__constructs__=[k.standardError,k.ws_unavailable,k.ws_error,k.http_error,k.idle_timeout,k.stalled_timeout,k.ws_timeout,k.http_timeout,k.recovery_timeout,k.prog_mismatch,k.page_frozen];var P=h["com.lightstreamer.client.internal._ClientMachine.TerminationCause"]={__ename__:!0,__constructs__:null,TC_standardError:(i=function(t,e){return{_hx_index:0,code:t,msg:e,__enum__:"com.lightstreamer.client.internal._ClientMachine.TerminationCause",toString:o}},i._hx_name="TC_standardError",i.__params__=["code","msg"],i),TC_otherError:(i=function(t){return{_hx_index:1,error:t,__enum__:"com.lightstreamer.client.internal._ClientMachine.TerminationCause",toString:o}},i._hx_name="TC_otherError",i.__params__=["error"],i),TC_api:{_hx_name:"TC_api",_hx_index:2,__enum__:"com.lightstreamer.client.internal._ClientMachine.TerminationCause",toString:o}};P.__constructs__=[P.TC_standardError,P.TC_otherError,P.TC_api];var M=h["com.lightstreamer.client.internal._ClientMachine.RecoveryRetryCause"]={__ename__:!0,__constructs__:null,RRC_transport_timeout:{_hx_name:"RRC_transport_timeout",_hx_index:0,__enum__:"com.lightstreamer.client.internal._ClientMachine.RecoveryRetryCause",toString:o},RRC_transport_error:{_hx_name:"RRC_transport_error",_hx_index:1,__enum__:"com.lightstreamer.client.internal._ClientMachine.RecoveryRetryCause",toString:o}};function F(t){switch(t._hx_index){case 0:return t.code+" - "+t.msg;case 1:return"Websocket transport not available";case 2:return"Websocket error";case 3:return"HTTP error";case 4:return"idleTimeout expired";case 5:return"stalledTimeout expired";case 6:return"Websocket connect timeout expired";case 7:return"HTTP connect timeout expired";case 8:return"sessionRecoveryTimeout expired";case 9:return"Recovery counter mismatch: expected "+t.expected+" but found "+t.actual;case 10:return"page frozen"}}M.__constructs__=[M.RRC_transport_timeout,M.RRC_transport_error];var q=function(){};q.__name__=!0,q.__isInterface__=!0,q.prototype={__class__:q};var A=function(t){this.client=t};A.__name__=!0,A.__interfaces__=[q],A.prototype={isPending:function(){return 150==this.client.state.s_m&&1302==this.client.state.s_swt},encode:function(t){return this.client.encodeSwitch(t)},encodeWS:function(){return"control\r\n"+this.encode(!0)},__class__:A};var W=function(t){this.client=t};W.__name__=!0,W.__interfaces__=[q],W.prototype={isPending:function(){return 1202==this.client.state.s_bw},encode:function(t){return this.client.encodeConstrain()},encodeWS:function(){return"control\r\n"+this.encode(!0)},__class__:W};var B=function(t,e,s){this.p=t,this.k=e,this.s=s};B.__name__=!0,B.prototype={toString:function(){return"<w_p="+this.p+" w_k="+this.k+" w_s="+this.s+">"},__class__:B};var H=function(t){this.m=t};H.__name__=!0,H.prototype={toString:function(){var t="<ws_m="+this.m;return null!=this.p&&(t+=" ws_p="+this.p),null!=this.k&&(t+=" ws_k="+this.k),null!=this.s&&(t+=" ws_s="+this.s),t+=">"},__class__:H};var U=function(t){this.m=t};U.__name__=!0,U.prototype={toString:function(){var t="<wp_m="+this.m;return null!=this.p&&(t+=" wp_p="+this.p),null!=this.c&&(t+=" wp_c="+this.c),null!=this.s&&(t+=" wp_s="+this.s),t+=">"},__class__:U};var V=function(t){this.m=t};V.__name__=!0,V.prototype={toString:function(){var t="<hs_m="+this.m;return null!=this.p&&(t+=" hs_p="+this.p),null!=this.k&&(t+=" hs_k="+this.k),t+=">"},__class__:V};var K=function(t){this.m=t};K.__name__=!0,K.prototype={toString:function(){return"<hp_m="+this.m+">"},__class__:K};var G=function(){this.s_m=100,this.s_du=20,this.s_nr=1400};G.__name__=!0,G.prototype={goto_m_from_w:function(t){this.clear_w(),this.goto_m_from_session(t)},goto_m_from_ws:function(t){this.clear_ws(),this.goto_m_from_session(t)},goto_rec_from_w:function(){this.clear_w(),this.goto_rec()},goto_rec_from_ws:function(){this.clear_ws(),this.goto_rec()},goto_m_from_wp:function(t){this.clear_wp(),this.goto_m_from_session(t)},goto_rec_from_wp:function(){this.clear_wp(),this.goto_rec()},goto_m_from_hs:function(t){this.clear_hs(),this.s_ctrl=null,this.s_h=null,this.goto_m_from_session(t)},goto_m_from_rec:function(t){this.s_tr=null,this.goto_m_from_session(t)},goto_rec_from_hs:function(){this.clear_hs(),this.s_ctrl=null,this.s_h=null,this.goto_rec()},goto_m_from_hp:function(t){this.clear_hp(),this.s_ctrl=null,this.s_h=null,this.goto_m_from_session(t)},goto_rec_from_hp:function(){this.clear_hp(),this.s_ctrl=null,this.s_h=null,this.goto_rec()},goto_rec:function(){this.s_tr=260,this.s_rec=1e3,this.traceState()},goto_m_from_session:function(t){this.s_tr=null,this.s_swt=null,this.s_bw=null,this.s_m=t,this.traceState()},goto_m_from_ctrl:function(t){this.clear_hs(),this.clear_hp(),this.s_ctrl=null,this.s_h=null,this.goto_m_from_session(t)},goto_200_from_rec:function(){this.s_rec=null,this.s_tr=200,this.traceState()},clear_w:function(){this.s_w=null,this.s_rhb=null,this.s_slw=null},clear_ws:function(){this.s_ws=null,this.s_rhb=null,this.s_slw=null},clear_wp:function(){this.s_wp=null},clear_hs:function(){this.s_hs=null,this.s_rhb=null,this.s_slw=null},clear_hp:function(){this.s_hp=null,this.s_rhb=null},isSwitching:function(){return 150==this.s_m&&(1302==this.s_swt||1303==this.s_swt)},inPushing:function(){return!!this.inStreaming()||this.inPolling()},inStreaming:function(){var t,e;300!=(null!=(t=this.s_w)?t.p:null)?e=510==(null!=(t=this.s_ws)?t.p:null):e=!0;return!!e||810==(null!=(e=this.s_hs)?e.p:null)},inPolling:function(){var t,e;if(220!=this.s_tr&&230!=this.s_tr){var s=this.s_wp;e=611==(null!=s?s.p:null)}else e=!0;e?t=!0:t=901==(null!=(e=this.s_hp)?e.m:null);return!!t||1001==this.s_rec},inRetryUnit:function(){switch(this.s_m){case 110:case 111:case 112:case 113:case 114:case 115:case 116:return!0;default:return!1}},inDisconnected:function(){return 100==this.s_m},toString:function(){var t="<m="+this.s_m;return t+=" du="+this.s_du,null!=this.s_tr&&(t+=" tr="+this.s_tr),null!=this.s_w&&(t+=" "+m.string(this.s_w)),null!=this.s_ws&&(t+=" "+m.string(this.s_ws)),null!=this.s_wp&&(t+=" "+m.string(this.s_wp)),null!=this.s_hs&&(t+=" "+m.string(this.s_hs)),null!=this.s_hp&&(t+=" "+m.string(this.s_hp)),null!=this.s_rec&&(t+=" rec="+this.s_rec),null!=this.s_h&&(t+=" h="+this.s_h),null!=this.s_ctrl&&(t+=" ctrl="+this.s_ctrl),null!=this.s_swt&&(t+=" swt="+this.s_swt),null!=this.s_bw&&(t+=" bw="+this.s_bw),null!=this.s_rhb&&(t+=" rhb="+this.s_rhb),null!=this.s_slw&&(t+=" slw="+this.s_slw),t+=" nr="+this.s_nr,t+=">"},traceState:function(){Ps.isTraceEnabled()&&Ps.trace("goto: "+this.toString())},__class__:G};var z=function(){b.call(this)};z.__name__=!0,z.__super__=b,z.prototype=c(b.prototype,{onAbort:function(t,e){this.dispatchToAll((function(s){null!=s.onAbort&&s.onAbort(t,e)}))},onDeny:function(t,e,s){this.dispatchToAll((function(i){null!=i.onDeny&&i.onDeny(t,e,s)}))},onDiscarded:function(t){this.dispatchToAll((function(e){null!=e.onDiscarded&&e.onDiscarded(t)}))},onError:function(t){this.dispatchToAll((function(e){null!=e.onError&&e.onError(t)}))},onProcessed:function(t,e){this.dispatchToAll((function(s){null!=s.onProcessed&&s.onProcessed(t,e)}))},__class__:z});var Y=function(t,e,s,i,n,r){this.eventDispatcher=new z,this.txt=t,this.sequence=e,this.prog="UNORDERED_MESSAGES"!=e||null!=i?r.getAndSetNextMsgProg(e):-1,this.maxWait=s,this.delegate=i,null!=i&&this.eventDispatcher.addListener(i),this.enqueueWhileDisconnected=n,this.client=r,this.s_m=null!=i?10:"UNORDERED_MESSAGES"!=e?20:30,r.relateMsgManager(this)};Y.__name__=!0,Y.__interfaces__=[q],Y.prototype={finalize:function(){this.client.unrelateMsgManager(this)},evtExtSendMessage:function(){switch(this.traceEvent("sendMessage"),this.s_m){case 10:this.goto(11),this.client.evtSendMessage(this);break;case 20:this.goto(21),this.client.evtSendMessage(this);break;case 30:this.goto(31),this.client.evtSendMessage(this)}},evtMSGFAIL:function(t,e){switch(this.traceEvent("MSGFAIL"),this.s_m){case 10:this.finalize(),this.goto(13);break;case 11:case 12:this.doMSGFAIL(t,e),this.finalize(),this.goto(14)}},evtMSGDONE:function(t){switch(this.traceEvent("MSGDONE"),this.s_m){case 10:this.finalize(),this.goto(13);break;case 11:case 12:this.doMSGDONE(t),this.finalize(),this.goto(13)}},evtREQOK:function(t){switch(this.traceEvent("REQOK"),this.s_m){case 11:t==this.lastReqId&&this.goto(12);break;case 21:t==this.lastReqId&&(this.finalize(),this.goto(22));break;case 31:t==this.lastReqId&&(this.finalize(),this.goto(33))}},evtREQERR:function(t,e,s){switch(this.traceEvent("REQERR"),this.s_m){case 11:t==this.lastReqId&&(this.doREQERR(e,s),this.finalize(),this.goto(14));break;case 21:t==this.lastReqId&&(this.finalize(),this.goto(23));break;case 31:t==this.lastReqId&&(this.finalize(),this.goto(34))}},evtAbort:function(){switch(this.traceEvent("abort"),this.s_m){case 11:case 12:this.doAbort(),this.finalize(),this.goto(15);break;case 21:Ws.isWarnEnabled()&&Ws.warn("Message "+this.sequence+":"+this.prog+" aborted"),this.finalize(),this.goto(24);break;case 31:Ws.isWarnEnabled()&&Ws.warn("Message "+this.sequence+":"+this.prog+" aborted"),this.finalize(),this.goto(35)}},evtWSSent:function(){this.traceEvent("ws.sent"),31==this.s_m&&(this.finalize(),this.goto(32))},isPending:function(){return 11==this.s_m||21==this.s_m||31==this.s_m},encode:function(t){return this.encodeMsg(t)},encodeWS:function(){return"msg\r\n"+this.encode(!0)},doMSGDONE:function(t){this.fireOnProcessed(t)},doMSGFAIL:function(t,e){38==t||39==t?this.fireOnDiscarded():t<=0?this.fireOnDeny(t,e):32!=t&&33!=t&&this.fireOnError()},doREQERR:function(t,e){32!=t&&33!=t&&this.fireOnError()},doAbort:function(){this.fireOnAbort()},encodeMsg:function(t){var e="UNORDERED_MESSAGES"!=this.sequence,s=null!=this.delegate,i=new le;return this.lastReqId=this.client.generateFreshReqId(),i.LS_reqId(this.lastReqId),i.LS_message(this.txt),e&&s?(i.LS_sequence(this.sequence),i.LS_msg_prog(this.prog),this.maxWait>=0&&i.LS_max_wait(this.maxWait)):!e&&s?i.LS_msg_prog(this.prog):e&&!s?(i.LS_outcome(!1),i.LS_sequence(this.sequence),i.LS_msg_prog(this.prog),this.maxWait>=0&&i.LS_max_wait(this.maxWait)):e||s||(i.LS_outcome(!1),t&&i.LS_ack(!1)),ks.isInfoEnabled()&&ks.info("Sending message: "+m.string(i)),i.getEncodedString()},fireOnProcessed:function(t){Ws.isInfoEnabled()&&Ws.info("Message "+this.sequence+":"+this.prog+" processed"),this.eventDispatcher.onProcessed(this.txt,t)},fireOnDiscarded:function(){Ws.isWarnEnabled()&&Ws.warn("Message "+this.sequence+":"+this.prog+" discarded"),this.eventDispatcher.onDiscarded(this.txt)},fireOnDeny:function(t,e){Ws.isWarnEnabled()&&Ws.warn("Message "+this.sequence+":"+this.prog+" denied: "+t+" - "+e),this.eventDispatcher.onDeny(this.txt,t,e)},fireOnError:function(){Ws.isWarnEnabled()&&Ws.warn("Message "+this.sequence+":"+this.prog+" failed"),this.eventDispatcher.onError(this.txt)},fireOnAbort:function(){Ws.isWarnEnabled()&&Ws.warn("Message "+this.sequence+":"+this.prog+" aborted"),this.eventDispatcher.onAbort(this.txt,!1)},traceEvent:function(t){Ps.isTraceEnabled()&&Ps.trace("msg#"+t+"("+this.sequence+":"+this.prog+") in "+this.s_m)},goto:function(t){this.s_m=t,Ps.isTraceEnabled()&&Ps.trace("msg#goto("+this.sequence+":"+this.prog+") "+this.s_m)},toString:function(){var t=Ht._new();return Ht.set(t,"text",this.txt),Ht.set(t,"sequence",this.sequence),Ht.set(t,"prog",this.prog),Ht.set(t,"timeout",this.maxWait),Ht.set(t,"enqueueWhileDisconnected",this.enqueueWhileDisconnected),is.stringify(t.h)},__class__:Y};var Q=function(t,e,s){this.items=new es,this.s_m=1,this.lock=e.lock,this.client=e,this.subscription=t,this.m_subId=s};Q.__name__=!0,Q.prototype={finalize:function(){},evtAbort:function(){this.traceEvent("abort"),1==this.s_m?(this.doAbort(),this.goto(1)):2==this.s_m&&(this.doAbort(),this.goto(1),this.genDisposeItems())},evtOnSUB:function(t,e,s,i,n){this.traceEvent("onSUB"),1==this.s_m&&(this.doSUB(t,e),this.goto(2))},evtOnCONF:function(t){this.traceEvent("onCONF"),2==this.s_m&&(this.doCONF(t),this.goto(2))},evtOnCS:function(t){this.traceEvent("onCS"),2==this.s_m&&(this.doCS(t),this.goto(2))},evtOnEOS:function(t){this.traceEvent("onEOS"),2==this.s_m&&(this.doEOS(t),this.goto(2))},evtUpdate:function(t,e){this.traceEvent("update"),2==this.s_m&&(this.doUpdate(t,e),this.goto(2))},evtUnsubscribe:function(){this.traceEvent("unsubscribe"),1==this.s_m?(this.finalize(),this.goto(3)):2==this.s_m&&(this.finalize(),this.goto(3),this.genDisposeItems())},evtOnUNSUB:function(){this.traceEvent("onUNSUB"),2==this.s_m&&(this.finalize(),this.goto(3),this.genDisposeItems())},evtDispose:function(){this.traceEvent("dispose"),1!=this.s_m&&2!=this.s_m||(this.finalize(),this.goto(3),this.genDisposeItems())},evtSetRequestedMaxFrequency:function(t){},getValue:function(t,e){var s=this.items.h[t];return null!=s?s.getValue(e):null},getCommandValue:function(t,e,s){throw new Yt("Unsupported operation")},createItem:function(t){throw new Yt("Abstract method")},doSUB:function(t,e){var s=this.subscription.fetchItems(),i=this.subscription.fetchFields();if(null!=s&&t!=s.length)throw new Yt("Assertion failure: items != null ? nItems == items.length : true");if(null!=i&&e!=i.length)throw new Yt("Assertion failure: fields != null ? nFields == fields.length : true")},doUpdate:function(t,e){this.selectItem(t).evtUpdate(e)},doEOS:function(t){this.selectItem(t).evtOnEOS()},doCS:function(t){this.selectItem(t).evtOnCS()},doCONF:function(t){this.realMaxFrequency=t,this.subscription.fireOnRealMaxFrequency(t,this.m_subId)},doAbort:function(){this.realMaxFrequency=null},genDisposeItems:function(){for(var t=this.items.copy(),e=t.keys();e.hasNext();)t.get(e.next()).evtDispose(this)},selectItem:function(t){var e=this.items.h[t];return null==e&&(e=this.createItem(t),this.items.h[t]=e),e},unrelate:function(t){this.items.remove(t)},traceEvent:function(t){Ps.isTraceEnabled()&&Ps.trace("sub#mod#"+t+"("+this.m_subId+") in "+this.s_m)},goto:function(t){this.s_m=t,Ps.isTraceEnabled()&&Ps.trace("sub#mod#goto("+this.m_subId+") "+this.s_m)},__class__:Q};var j=function(t,e,s){Q.call(this,t,e,s)};j.__name__=!0,j.__super__=Q,j.prototype=c(Q.prototype,{evtOnSUB:function(t,e,s,i,n){this.traceEvent("onSUB"),1==this.s_m&&(this.doSUBCMD(t,e,s,i),this.goto(2))},getCommandValue:function(t,e,s){var i=this.items.h[t];return null!=i?i.getCommandValue(e,s):null},doSUBCMD:function(t,e,s,i){var n=this.subscription.fetchItems(),r=this.subscription.fetchFields();if(null!=n&&t!=n.length)throw new Yt("Assertion failure: items != null ? nItems == items.length : true");if(null!=r&&e!=r.length)throw new Yt("Assertion failure: fields != null ? nFields == fields.length : true");if(null!=r&&s-1!=r.indexOf("command"))throw new Yt('Assertion failure: fields != null ? cmdIdx - 1 == fields.indexOf("command") : true');if(null!=r&&i-1!=r.indexOf("key"))throw new Yt('Assertion failure: fields != null ? keyIdx - 1 == fields.indexOf("key") : true')},__class__:j});var J=function(t,e,s){j.call(this,t,e,s)};J.__name__=!0,J.__super__=j,J.prototype=c(j.prototype,{createItem:function(t){return new vt(t,this.subscription,this.client,this.m_subId)},__class__:J});var $=function(t,e,s){j.call(this,t,e,s)};$.__name__=!0,$.__super__=j,$.prototype=c(j.prototype,{evtOnSUB:function(t,e,s,i,n){this.traceEvent("onSUB"),1==this.s_m&&(this.doSUBCMD2Level(t,e,s,i,n),this.goto(2))},evtSetRequestedMaxFrequency:function(t){switch(this.traceEvent("setRequestedMaxFrequency"),this.s_m){case 1:case 2:this.doSetRequestedMaxFrequency(t),this.goto(this.s_m),this.genSetRequestedMaxFrequency()}},evtOnRealMaxFrequency2LevelAdded:function(t){this.traceEvent("onRealMaxFrequency2LevelAdded"),2==this.s_m&&(this.doAggregateFrequenciesWhenFreqIsAdded(t),this.goto(2))},evtOnRealMaxFrequency2LevelRemoved:function(){this.traceEvent("onRealMaxFrequency2LevelRemoved"),2==this.s_m&&(this.doAggregateFrequenciesWhenFreqIsRemoved(),this.goto(2))},evtOnCONF:function(t){this.traceEvent("onCONF"),2==this.s_m&&(this.doCONF2Level(t),this.doAggregateFrequenciesWhenFreqIsAdded(t),this.goto(2))},createItem:function(t){return new St(t,this.subscription,this,this.client,this.m_subId)},doSUBCMD2Level:function(t,e,s,i,n){var r=this.subscription.fetchItems(),a=this.subscription.fetchFields();if(null!=r&&t!=r.length)throw new Yt("Assertion failure: items != null ? nItems == items.length : true");if(null!=a&&e!=a.length)throw new Yt("Assertion failure: fields != null ? nFields == fields.length : true");if(null!=a&&s-1!=a.indexOf("command"))throw new Yt('Assertion failure: fields != null ? cmdIdx - 1 == fields.indexOf("command") : true');if(null!=a&&i-1!=a.indexOf("key"))throw new Yt('Assertion failure: fields != null ? keyIdx - 1 == fields.indexOf("key") : true');this.requestedMaxFrequency=n},doSetRequestedMaxFrequency:function(t){this.requestedMaxFrequency=t},genSetRequestedMaxFrequency:function(){for(var t=this.items,e=t.keys();e.hasNext();)ls.__cast(t.get(e.next()),St).evtSetRequestedMaxFrequency()},doCONF2Level:function(t){this.realMaxFrequency=t},maxFreq:function(t,e){var s;if(null==t)s=e;else switch(t._hx_index){case 0:var i=t.freq;if(null==e)s=t;else switch(e._hx_index){case 0:s=Le.RFreqLimited(Math.max(i,e.freq));break;case 1:s=e}break;case 1:s=t}return s},doAggregateFrequenciesWhenFreqIsAdded:function(t){var e=this.maxFreq(this.aggregateRealMaxFrequency,t),s=this.aggregateRealMaxFrequency;this.aggregateRealMaxFrequency=e,Fe(s,e)||this.subscription.fireOnRealMaxFrequency(e,this.m_subId)},doAggregateFrequenciesWhenFreqIsRemoved:function(){for(var t=this.realMaxFrequency,e=!1,s=this.items,i=s.keys();i.hasNext();){for(var n=ls.__cast(s.get(i.next()),St).keys.h,r=Object.keys(n),a=r.length,o=0;o<a;)if((t=this.maxFreq(t,ls.__cast(n[r[o++]],Ct).realMaxFrequency))==Le.RFreqUnlimited){e=!0;break}if(e)break}var h=this.aggregateRealMaxFrequency;this.aggregateRealMaxFrequency=t,Fe(h,t)||this.subscription.fireOnRealMaxFrequency(t,this.m_subId)},__class__:$});var Z=function(t,e,s){Q.call(this,t,e,s)};Z.__name__=!0,Z.__super__=Q,Z.prototype=c(Q.prototype,{createItem:function(t){return new yt(t,this.subscription,this.client,this.m_subId)},__class__:Z});var X=function(t,e,s){Q.call(this,t,e,s)};X.__name__=!0,X.__super__=Q,X.prototype=c(Q.prototype,{createItem:function(t){return new Et(t,this.subscription,this.client,this.m_subId)},__class__:X});var tt=function(t,e,s){Q.call(this,t,e,s)};tt.__name__=!0,tt.__super__=Q,tt.prototype=c(Q.prototype,{createItem:function(t){return new wt(t,this.subscription,this.client,this.m_subId)},__class__:tt});var et=function(t,e,s){this.subId=t,this.itemIdx=e,this.values=s};function st(t){return Jt.sure(m.parseInt(t))}function it(t){return Jt.sure(parseFloat(t))}function nt(t,e,s){var i=t.indexOf(e,s);if(-1==i)throw new Yt("string not found");return i}function rt(t){for(var e=ot.ofString(t,ht.UTF8),s=0,i=0;s<e.length;)37==e.b[s]?(e.b[i++]=(at(e.b[s+1])<<4)+at(e.b[s+2]),s+=3):e.b[i++]=e.b[s++];var n=e.sub(0,i).b.bufferValue;return Is.decode(n)}function at(t){var e=0;return(e=t-97+10)<=9&&(e=t-65+10)<=9&&(e=t-48),e}et.__name__=!0,et.prototype={__class__:et};var ot=function(t){this.length=t.byteLength,this.b=new Uint8Array(t),this.b.bufferValue=t,t.hxBytes=this,t.bytes=this.b};ot.__name__=!0,ot.ofString=function(t,e){if(e==ht.RawNative){for(var s=new Uint8Array(t.length<<1),i=0,n=t.length;i<n;){var r=i++,a=t.charCodeAt(r);s[r<<1]=255&a,s[r<<1|1]=a>>8}return new ot(s.buffer)}var o=[];for(r=0;r<t.length;){55296<=(a=t.charCodeAt(r++))&&a<=56319&&(a=a-55232<<10|1023&t.charCodeAt(r++)),a<=127?o.push(a):a<=2047?(o.push(192|a>>6),o.push(128|63&a)):a<=65535?(o.push(224|a>>12),o.push(128|a>>6&63),o.push(128|63&a)):(o.push(240|a>>18),o.push(128|a>>12&63),o.push(128|a>>6&63),o.push(128|63&a))}return new ot(new Uint8Array(o).buffer)},ot.prototype={sub:function(t,e){if(t<0||e<0||t+e>this.length)throw Gt.thrown(as.OutsideBounds);return new ot(this.b.buffer.slice(t+this.b.byteOffset,t+this.b.byteOffset+e))},__class__:ot};var ht=h["haxe.io.Encoding"]={__ename__:!0,__constructs__:null,UTF8:{_hx_name:"UTF8",_hx_index:0,__enum__:"haxe.io.Encoding",toString:o},RawNative:{_hx_name:"RawNative",_hx_index:1,__enum__:"haxe.io.Encoding",toString:o}};ht.__constructs__=[ht.UTF8,ht.RawNative];var ct=function(){this.body=""};ct.__name__=!0,ct.isEmpty=function(t){return 0==t.length},ct.lengthOfBytes=function(t){return ot.ofString(t,ht.UTF8).length},ct.prototype={getByteSize:function(){return ct.lengthOfBytes(this.body)},getBody:function(){return this.body},addSubRequest:function(t){ct.isEmpty(this.body)?this.body=t:this.body+="\r\n"+t},addSubRequestOnlyIfBodyIsLessThan:function(t,e){return ct.isEmpty(this.body)&&ct.lengthOfBytes(t)<=e?(this.body=t,!0):ct.lengthOfBytes(this.body)+ct.EOL_LEN+ct.lengthOfBytes(t)<=e&&(this.body+="\r\n"+t,!0)},__class__:ct};var lt=function(){this.attempt=1,this._currentRetryDelay=0};lt.__name__=!0,lt.prototype={get_currentRetryDelay:function(){return this._currentRetryDelay},increase:function(){this.attempt>10?this._currentRetryDelay<6e4&&(2*this._currentRetryDelay<6e4?this._currentRetryDelay*=2:this._currentRetryDelay=6e4):this.attempt+=1},reset:function(t){this.attempt=1,this._currentRetryDelay=t},__class__:lt};var ut=function(){};ut.__name__=!0,ut.__isInterface__=!0,ut.__interfaces__=[q],ut.prototype={__class__:ut};var _t=function(t){this.subId=t,this.s_m=1};_t.__name__=!0,_t.prototype={toString:function(){var t="<m="+this.s_m;return null!=this.s_s&&(t+=" s="+this.s_s),null!=this.s_c&&(t+=" c="+this.s_c),t+=">"},traceState:function(){Ps.isTraceEnabled()&&Ps.trace("sub#goto("+this.subId+") "+this.toString())},__class__:_t};var dt=function(t,e){var s;switch(this.lock=e.lock,this.subId=e.generateFreshSubId(),t.fetch_mode()){case"COMMAND":s=dt.is2LevelCommand(t)?new $(t,e,this.subId):new J(t,e,this.subId);break;case"DISTINCT":s=new Z(t,e,this.subId);break;case"MERGE":s=new X(t,e,this.subId);break;case"RAW":s=new tt(t,e,this.subId)}this.m_strategy=s,this.state=new _t(this.subId),this.m_client=e,this.m_subscription=t,this.m_client.relateSubManager(this),this.m_subscription.relate(this)};dt.__name__=!0,dt.__interfaces__=[ut],dt.is2LevelCommand=function(t){return"COMMAND"==t.fetch_mode()&&(null!=t.getCommandSecondLevelFields()||null!=t.getCommandSecondLevelFieldSchema())},dt.prototype={finalize:function(){this.m_strategy.evtDispose(),this.m_client.unrelateSubManager(this),this.m_subscription.unrelate(this)},evtExtSubscribe:function(){this.traceEvent("subscribe"),1==this.state.s_m&&(this.doSetActive(),this.doSubscribe(),this.state.s_m=2,this.state.traceState(),this.genSendControl())},evtExtUnsubscribe:function(){this.traceEvent("unsubscribe"),2==this.state.s_m?(this.doSetInactive(),this.finalize(),this.state.s_m=30,this.state.traceState()):3==this.state.s_m?(this.doUnsubscribe(),this.doSetInactive(),this.state.s_m=5,this.state.traceState(),this.genSendControl()):10==this.state.s_s&&(this.doUnsubscribe(),this.m_subscription.setInactive(),this.notifyOnUnsubscription(),this.state.s_m=5,this.state.s_s=null,this.state.s_c=null,this.state.traceState(),this.genSendControl())},evtExtAbort:function(){this.traceEvent("abort"),2==this.state.s_m?(this.state.s_m=2,this.state.traceState()):3==this.state.s_m?(this.doAbort(),this.doSetActive(),this.state.s_m=2,this.state.traceState()):10==this.state.s_s?(this.doAbort(),this.doSetActive(),this.notifyOnUnsubscription(),this.state.s_s=null,this.state.s_c=null,this.state.s_m=2,this.state.traceState()):5==this.state.s_m&&(this.finalize(),this.state.s_m=32,this.state.traceState())},evtREQERR:function(t,e,s){this.traceEvent("REQERR"),2==this.state.s_m&&t==this.m_lastAddReqId?(this.doSetInactive(),this.notifyOnSubscriptionError(e,s),this.finalize(),this.state.s_m=30,this.state.traceState()):5==this.state.s_m&&t==this.m_lastDeleteReqId?(this.finalize(),this.state.s_m=32,this.state.traceState()):22==this.state.s_c&&t==this.m_lastReconfReqId&&(Ie.extEquals(this.m_reqMaxFrequency,this.m_subscription.fetch_requestedMaxFrequency())?(this.state.s_c=21,this.state.traceState()):(this.state.s_c=20,this.state.traceState(),this.evtCheckFrequency()))},evtREQOK:function(t){this.traceEvent("REQOK"),2==this.state.s_m&&t==this.m_lastAddReqId?(this.state.s_m=3,this.state.traceState()):5==this.state.s_m&&t==this.m_lastDeleteReqId?(this.finalize(),this.state.s_m=32,this.state.traceState()):22==this.state.s_c&&t==this.m_lastReconfReqId&&(this.doREQOKConfigure(),this.state.s_c=20,this.state.traceState(),this.evtCheckFrequency())},checkItems:function(t,e){return null==t||t==e},checkFields:function(t,e){return null==t||t==e},checkItemsAndFields:function(t,e,s,i){return!!this.checkItems(t,s)&&this.checkFields(e,i)},evtSUBOK:function(t,e){if(this.traceEvent("SUBOK"),2==this.state.s_m||3==this.state.s_m){var s,i=null!=(s=this.m_subscription.fetch_items())?s.length:null,n=null!=(s=this.m_subscription.fetch_fields())?s.length:null;this.checkItemsAndFields(i,n,t,e)?(this.doSUBOK(t,e),this.notifyOnSubscription(),this.state.s_m=4,this.state.s_s=10,this.state.s_c=20,this.state.traceState(),this.evtCheckFrequency()):(this.doUnsubscribe(),this.doSetInactive(),this.notifyOnSubscriptionError_CountMismatch(i,n,t,e),this.state.s_m=5,this.state.traceState(),this.genSendControl())}},evtSUBCMD:function(t,e,s,i){if(this.traceEvent("SUBCMD"),2==this.state.s_m||3==this.state.s_m){var n,r=null!=(n=this.m_subscription.fetch_items())?n.length:null,a=null!=(n=this.m_subscription.fetch_fields())?n.length:null;this.checkItemsAndFields(r,a,t,e)?(this.doSUBCMD(t,e,i,s),this.notifyOnSubscription(),this.state.s_m=4,this.state.s_s=10,this.state.s_c=20,this.state.traceState(),this.evtCheckFrequency()):(this.doUnsubscribe(),this.doSetInactive(),this.notifyOnSubscriptionError_CountMismatch(r,a,t,e),this.state.s_m=5,this.state.traceState(),this.genSendControl())}},evtUNSUB:function(){this.traceEvent("UNSUB"),10==this.state.s_s?(this.doUNSUB(),this.doSetInactive(),this.notifyOnUnsubscription(),this.finalize(),this.state.s_m=31,this.state.s_s=null,this.state.s_c=null,this.state.traceState()):5==this.state.s_m&&(this.finalize(),this.state.s_m=32,this.state.traceState())},evtU:function(t,e){this.traceEvent("U"),10==this.state.s_s&&(this.doU(t,e),this.state.s_s=10,this.state.traceState())},evtEOS:function(t){this.traceEvent("EOS"),10==this.state.s_s&&(this.doEOS(t),this.state.s_s=10,this.state.traceState())},evtCS:function(t){this.traceEvent("CS"),10==this.state.s_s&&(this.doCS(t),this.state.s_s=10,this.state.traceState())},evtOV:function(t,e){this.traceEvent("OV"),10==this.state.s_s&&(this.doOV(t,e),this.state.s_s=10,this.state.traceState())},evtCONF:function(t){this.traceEvent("CONF"),10==this.state.s_s&&(this.doCONF(t),this.state.s_s=10,this.state.traceState())},evtCheckFrequency:function(){this.traceEvent("check.frequency"),20==this.state.s_c&&(Ie.extEquals(this.m_subscription.fetch_requestedMaxFrequency(),this.m_currentMaxFrequency)?(this.state.s_c=21,this.state.traceState()):(this.doConfigure(),this.state.s_c=22,this.state.traceState(),this.genSendControl()))},evtExtConfigure:function(){this.traceEvent("configure"),21==this.state.s_c&&(this.state.s_c=20,this.state.traceState(),this.evtCheckFrequency())},isPending:function(){return 2==this.state.s_m||5==this.state.s_m||22==this.state.s_c},encode:function(t){if(2==this.state.s_m)return this.encodeAdd(t);if(5==this.state.s_m)return this.encodeDelete(t);if(22==this.state.s_c)return this.encodeReconf(t);throw new Yt("Can't encode request")},encodeWS:function(){return"control\r\n"+this.encode(!0)},getValue:function(t,e){return this.m_strategy.getValue(t,e)},getCommandValue:function(t,e,s){return this.m_strategy.getCommandValue(t,e,s)},encodeAdd:function(t){var e=new le;this.m_lastAddReqId=this.m_client.generateFreshReqId(),e.LS_reqId(this.m_lastAddReqId),e.LS_op("add"),e.LS_subId(this.subId),e.LS_mode(this.m_subscription.fetch_mode());var s=this.m_subscription.getItemGroup(),i=this.m_subscription.fetchItems();null!=s?e.LS_group(s):null!=i&&e.LS_group(i.join(" "));var n=this.m_subscription.getFieldSchema(),r=this.m_subscription.fetchFields();null!=n?e.LS_schema(n):null!=r&&e.LS_schema(r.join(" "));var a=this.m_subscription.getDataAdapter();null!=a&&e.LS_data_adapter(a);var o=this.m_subscription.getSelector();null!=o&&e.LS_selector(o);var h=this.m_subscription.fetch_requestedSnapshot();if(null!=h)switch(h._hx_index){case 0:e.LS_snapshot(!0);break;case 1:e.LS_snapshot(!1);break;case 2:e.LS_snapshot_Int(h.len)}var c=this.m_currentMaxFrequency;if(null!=c)switch(c._hx_index){case 0:e.LS_requested_max_frequency_Float(c.max);break;case 1:e.LS_requested_max_frequency("unlimited");break;case 2:e.LS_requested_max_frequency("unfiltered")}var l=this.m_subscription.fetch_requestedBufferSize();if(null!=l)switch(l._hx_index){case 0:e.LS_requested_buffer_size_Int(l.size);break;case 1:e.LS_requested_buffer_size("unlimited")}return t&&e.LS_ack(!1),ks.isInfoEnabled()&&ks.info("Sending Subscription add: "+m.string(e)),e.getEncodedString()},encodeDelete:function(t){var e=new le;return this.m_lastDeleteReqId=this.m_client.generateFreshReqId(),e.LS_reqId(this.m_lastDeleteReqId),e.LS_subId(this.subId),e.LS_op("delete"),t&&e.LS_ack(!1),ks.isInfoEnabled()&&ks.info("Sending Subscription delete: "+m.string(e)),e.getEncodedString()},encodeReconf:function(t){var e=new le;this.m_lastReconfReqId=this.m_client.generateFreshReqId(),e.LS_reqId(this.m_lastReconfReqId),e.LS_subId(this.subId),e.LS_op("reconf");var s=this.m_reqMaxFrequency;if(null!=s)switch(s._hx_index){case 0:e.LS_requested_max_frequency_Float(s.max);break;case 1:e.LS_requested_max_frequency("unlimited");break;case 2:e.LS_requested_max_frequency("unfiltered")}return ks.isInfoEnabled()&&ks.info("Sending Subscription configuration: "+m.string(e)),e.getEncodedString()},doSetActive:function(){this.m_subscription.setActive()},doSetInactive:function(){this.m_subscription.setInactive()},doSubscribe:function(){this.m_currentMaxFrequency=this.m_subscription.fetch_requestedMaxFrequency()},doUnsubscribe:function(){this.m_strategy.evtUnsubscribe(),this.m_subscription.unrelate(this)},doAbort:function(){this.m_lastAddReqId=null,this.m_lastDeleteReqId=null,this.m_lastReconfReqId=null,this.m_reqMaxFrequency=null,this.m_currentMaxFrequency=this.m_subscription.fetch_requestedMaxFrequency(),this.m_strategy.evtAbort()},genSendControl:function(){this.m_client.evtSendControl(this)},notifyOnSubscription:function(){this.m_subscription.fireOnSubscription(this.subId)},notifyOnUnsubscription:function(){this.m_subscription.fireOnUnsubscription(this.subId)},notifyOnSubscriptionError:function(t,e){this.m_subscription.fireOnSubscriptionError(this.subId,t,e)},notifyOnSubscriptionError_CountMismatch:function(t,e,s,i){this.checkItems(t,s)?this.m_subscription.fireOnSubscriptionError(this.subId,61,"Expected "+e+" fields but got "+i):this.m_subscription.fireOnSubscriptionError(this.subId,61,"Expected "+t+" items but got "+s)},doConfigure:function(){this.m_reqMaxFrequency=this.m_subscription.fetch_requestedMaxFrequency(),this.m_strategy.evtSetRequestedMaxFrequency(this.m_reqMaxFrequency)},doREQOKConfigure:function(){this.m_currentMaxFrequency=this.m_reqMaxFrequency},doSUBOK:function(t,e){this.m_subscription.setSubscribed(this.subId,t,e),this.m_strategy.evtOnSUB(t,e,null,null,null)},doSUBCMD:function(t,e,s,i){this.m_subscription.setSubscribedCMD(this.subId,t,e,s,i),this.m_strategy.evtOnSUB(t,e,s,i,this.m_currentMaxFrequency)},doUNSUB:function(){this.m_strategy.evtOnUNSUB()},doU:function(t,e){if(t>Jt.sure(this.m_subscription.fetch_nItems()))throw new Yt("Assertion failure: itemIdx <= m_subscription.fetch_nItems().sure()");this.m_strategy.evtUpdate(t,e)},doEOS:function(t){this.m_strategy.evtOnEOS(t),this.m_subscription.fireOnEndOfSnapshot(t,this.subId)},doCS:function(t){this.m_strategy.evtOnCS(t),this.m_subscription.fireOnClearSnapshot(t,this.subId)},doOV:function(t,e){this.m_subscription.fireOnLostUpdates(t,e,this.subId)},doCONF:function(t){this.m_strategy.evtOnCONF(t)},traceEvent:function(t){Ps.isTraceEnabled()&&Ps.trace("sub#"+t+"("+this.subId+") in "+m.string(this.state))},__class__:dt};var ft=function(t,e){this.s_m=1,this.subId=t,this.lock=e.lock,this.m_client=e,e.relateSubManager(this)};ft.__name__=!0,ft.__interfaces__=[ut],ft.prototype={finalize:function(){this.m_client.unrelateSubManager(this)},evtExtAbort:function(){this.traceEvent("abort"),2==this.s_m&&(this.finalize(),this.goto(3))},evtREQERR:function(t,e,s){this.traceEvent("REQERR"),2==this.s_m&&t==this.m_lastDeleteReqId&&(this.finalize(),this.goto(3))},evtREQOK:function(t){this.traceEvent("REQOK"),2==this.s_m&&t==this.m_lastDeleteReqId&&(this.finalize(),this.goto(3))},evtSUBOK:function(t,e){this.traceEvent("SUBOK"),1==this.s_m&&(this.goto(2),this.genSendControl())},evtSUBCMD:function(t,e,s,i){this.traceEvent("SUBCMD"),1==this.s_m&&(this.goto(2),this.genSendControl())},evtUNSUB:function(){this.traceEvent("UNSUB"),2==this.s_m&&(this.finalize(),this.goto(3))},evtU:function(t,e){this.traceEvent("U"),1==this.s_m&&(this.goto(2),this.genSendControl())},evtEOS:function(t){this.traceEvent("EOS"),1==this.s_m&&(this.goto(2),this.genSendControl())},evtCS:function(t){this.traceEvent("CS"),1==this.s_m&&(this.goto(2),this.genSendControl())},evtOV:function(t,e){this.traceEvent("OV"),1==this.s_m&&(this.goto(2),this.genSendControl())},evtCONF:function(t){this.traceEvent("CONF"),1==this.s_m&&(this.goto(2),this.genSendControl())},isPending:function(){return 2==this.s_m},encode:function(t){if(this.isPending())return this.encodeDelete(t);throw new Yt("Can't encode unsubscription request")},encodeWS:function(){return"control\r\n"+this.encode(!0)},genSendControl:function(){this.m_client.evtSendControl(this)},encodeDelete:function(t){var e=new le;return this.m_lastDeleteReqId=this.m_client.generateFreshReqId(),e.LS_reqId(this.m_lastDeleteReqId),e.LS_subId(this.subId),e.LS_op("delete"),t&&e.LS_ack(!1),e.LS_cause("zombie"),ks.isInfoEnabled()&&ks.info("Sending Subscription delete: "+m.string(e)),e.getEncodedString()},traceEvent:function(t){Ps.isTraceEnabled()&&Ps.trace("zsub#"+t+"("+this.subId+") in "+this.s_m)},goto:function(t){this.s_m=t,Ps.isTraceEnabled()&&Ps.trace("zsub#goto("+this.subId+") "+this.s_m)},__class__:ft};var mt=function(){};mt.__name__=!0,mt.__interfaces__=[n],mt.prototype={__class__:mt};var gt=function(t,e,s,i){this.m_subId=i,this.itemIdx=t,this.subscription=e,this.client=s,this.lock=s.lock};gt.__name__=!0,gt.prototype={finalize:function(){},evtUpdate:function(t){this.fatalError()},evtOnEOS:function(){this.fatalError()},evtOnCS:function(){this.fatalError()},evtDispose:function(t){this.fatalError()},getValue:function(t){return null!=this.currValues?Dt.toString(this.currValues.h[t]):null},getCommandValue:function(t,e){throw new Yt("Unsupported operation")},fatalError:function(){throw new Yt("Unsupported operation")},doFirstUpdate:function(t){this.doUpdate(t,!1)},doUpdate0:function(t){this.doUpdate(t,!1)},doFirstSnapshot:function(t){this.doUpdate(t,!0)},doSnapshot:function(t){this.doUpdate(t,!0)},doUpdate:function(t,e){var s=this.currValues;this.currValues=Nt(s,t);var i=Ot(s,this.currValues),n=function(t,e){if(null!=t){for(var s=new es,i=e,n=i.keys();n.hasNext();){var r=n.next(),a=i.get(r);switch(a._hx_index){case 0:var o=t.h[r];if(null!=o&&null!=o&&1==o._hx_index){var h=Be._new("[]");s.h[r]=h}break;case 2:s.h[r]=a.patch}}return s}return new es}(s,t),r=new Rt(this.itemIdx,this.subscription,this.currValues,i,e,n);this.subscription.fireOnItemUpdate(r,this.m_subId)},__class__:gt};var pt=function(t,e,s,i){this.keys=new is,gt.call(this,t,e,s,i),this.s_m=e.hasSnapshot()?3:1};pt.__name__=!0,pt.__super__=gt,pt.prototype=c(gt.prototype,{finalize:function(){},unrelate:function(t){var e=this.keys;Object.prototype.hasOwnProperty.call(e.h,t)&&delete e.h[t]},evtUpdate:function(t){switch(this.traceEvent("update"),this.s_m){case 1:this.doFirstUpdate(t),this.goto(2);break;case 2:this.doUpdate0(t),this.goto(2);break;case 3:this.doFirstSnapshot(t),this.goto(4);break;case 4:this.doSnapshot(t),this.goto(4)}},evtOnEOS:function(){switch(this.traceEvent("onEOS"),this.s_m){case 3:this.goto(1);break;case 4:this.goto(2)}},evtOnCS:function(){throw new Yt("Unsupported method")},evtDispose:function(t){switch(this.traceEvent("dispose"),this.s_m){case 1:case 2:case 3:case 4:this.finalize(),this.goto(5),this.genDisposeKeys(),t.unrelate(this.itemIdx)}},getCommandValue:function(t,e){var s=this.keys.h[t];return null!=s?s.getCommandValue(e):null},createKey:function(t){throw new Yt("Abstract method")},doUpdate:function(t,e){this.currValues=Nt(this.currValues,t),this.selectKey().evtUpdate(this.currValues,e)},genDisposeKeys:function(){for(var t=is.createCopy(this.keys.h).h,e=Object.keys(t),s=e.length,i=0;i<s;)t[e[i++]].evtDispose()},selectKey:function(){var t=this.currValues,e=this.subscription.getKeyPosition(),s=Dt.toString(t.h[e]);return null==(e=this.keys.h[s])&&(e=this.createKey(s),this.keys.h[s]=e),e},goto:function(t){this.s_m=t,Ps.isTraceEnabled()&&Ps.trace("sub#itm#goto("+this.m_subId+":"+this.itemIdx+") in "+this.s_m)},traceEvent:function(t){Ps.isTraceEnabled()&&Ps.trace("sub#itm#"+t+"("+this.m_subId+":"+this.itemIdx+") in "+this.s_m)},__class__:pt});var vt=function(t,e,s,i){pt.call(this,t,e,s,i)};vt.__name__=!0,vt.__super__=pt,vt.prototype=c(pt.prototype,{evtOnCS:function(){switch(this.traceEvent("onCS"),this.s_m){case 1:case 2:case 3:case 4:this.goto(this.s_m),this.genDisposeKeys()}},createKey:function(t){return new xt(t,this)},__class__:vt});var St=function(t,e,s,i,n){pt.call(this,t,e,i,n),this.strategy=s};St.__name__=!0,St.__super__=pt,St.prototype=c(pt.prototype,{evtOnCS:function(){switch(this.traceEvent("onCS"),this.s_m){case 1:case 2:case 3:case 4:this.goto(this.s_m),this.genDisposeKeys(),this.genOnRealMaxFrequency2LevelRemoved()}},evtSetRequestedMaxFrequency:function(){switch(this.traceEvent("setRequestedMaxFrequency"),this.s_m){case 1:case 2:case 3:case 4:this.goto(this.s_m),this.genSetRequestedMaxFrequency()}},createKey:function(t){return new Ct(t,this)},genSetRequestedMaxFrequency:function(){for(var t=this.keys.h,e=Object.keys(t),s=e.length,i=0;i<s;)t[e[i++]].evtSetRequestedMaxFrequency()},genOnRealMaxFrequency2LevelRemoved:function(){this.strategy.evtOnRealMaxFrequency2LevelRemoved()},__class__:St});var yt=function(t,e,s,i){gt.call(this,t,e,s,i),this.s_m=e.hasSnapshot()?3:1};yt.__name__=!0,yt.__super__=gt,yt.prototype=c(gt.prototype,{evtUpdate:function(t){switch(this.traceEvent("update"),this.s_m){case 1:this.doFirstUpdate(t),this.goto(2);break;case 2:this.doUpdate0(t),this.goto(2);break;case 3:this.doFirstSnapshot(t),this.goto(4);break;case 4:this.doSnapshot(t),this.goto(4)}},evtOnEOS:function(){switch(this.traceEvent("onEOS"),this.s_m){case 3:this.goto(1);break;case 4:this.goto(2)}},evtOnCS:function(){},evtDispose:function(t){switch(this.traceEvent("dispose"),this.s_m){case 1:case 2:case 3:case 4:this.finalize(),this.goto(5),t.unrelate(this.itemIdx)}},goto:function(t){this.s_m=t,Ps.isTraceEnabled()&&Ps.trace("sub#itm#goto("+this.m_subId+":"+this.itemIdx+") "+this.s_m)},traceEvent:function(t){Ps.isTraceEnabled()&&Ps.trace("sub#itm#"+t+"("+this.m_subId+":"+this.itemIdx+") in "+this.s_m)},__class__:yt});var bt=function(){};bt.__name__=!0,bt.__isInterface__=!0,bt.prototype={__class__:bt};var Et=function(t,e,s,i){this.s_m=1,gt.call(this,t,e,s,i)};Et.__name__=!0,Et.__super__=gt,Et.prototype=c(gt.prototype,{evtUpdate:function(t){switch(this.traceEvent("update"),this.s_m){case 1:this.subscription.hasSnapshot()?(this.doSnapshot(t),this.goto(2)):(this.doFirstUpdate(t),this.goto(3));break;case 2:case 3:this.doUpdate0(t),this.goto(3)}},evtDispose:function(t){switch(this.traceEvent("dispose"),this.s_m){case 1:case 2:case 3:this.finalize(),this.goto(4),t.unrelate(this.itemIdx)}},goto:function(t){this.s_m=t,Ps.isTraceEnabled()&&Ps.trace("sub#itm#goto("+this.m_subId+":"+this.itemIdx+") "+this.s_m)},traceEvent:function(t){Ps.isTraceEnabled()&&Ps.trace("sub#itm#"+t+"("+this.m_subId+":"+this.itemIdx+") in "+this.s_m)},__class__:Et});var wt=function(t,e,s,i){this.s_m=1,gt.call(this,t,e,s,i)};wt.__name__=!0,wt.__super__=gt,wt.prototype=c(gt.prototype,{evtUpdate:function(t){switch(this.traceEvent("update"),this.s_m){case 1:this.doFirstUpdate(t),this.goto(2);break;case 2:this.doUpdate0(t),this.goto(2)}},evtDispose:function(t){switch(this.traceEvent("dispose"),this.s_m){case 1:case 2:this.finalize(),this.goto(3),t.unrelate(this.itemIdx)}},goto:function(t){this.s_m=t,Ps.isTraceEnabled()&&Ps.trace("sub#itm#goto("+this.m_subId+":"+this.itemIdx+") "+this.s_m)},traceEvent:function(t){Ps.isTraceEnabled()&&Ps.trace("sub#itm#"+t+"("+this.m_subId+":"+this.itemIdx+") in "+this.s_m)},__class__:wt});var Tt=function(t,e,s,i,n,r){var a=e.fetch_items(),o=e.fetch_fields(),h=e.fetch_fields2();this.m_itemIdx=t,this.m_items=kt(a),this.m_nFields=Jt.sure(e.fetch_nFields()),this.m_fields=kt(o),this.m_fields2=kt(h),this.m_newValues=s.copy(),this.m_changedFields=i.copy(),this.m_isSnapshot=n,this.m_jsonPatches=r};Tt.__name__=!0,Tt.__super__=mt,Tt.prototype=c(mt.prototype,{getItemName:function(){return null!=this.m_items?this.m_items.h[this.m_itemIdx]:null},getItemPos:function(){return this.m_itemIdx},isSnapshot:function(){return this.m_isSnapshot},getValue:function(t){return"number"==typeof t&&(0|t)===t?this.getValuePos(t):this.getValueName(m.string(t))},isValueChanged:function(t){return"number"==typeof t&&(0|t)===t?this.isValueChangedPos(t):this.isValueChangedName(m.string(t))},_getValueAsJSONPatchIfAvailable:function(t){if("number"==typeof t&&(0|t)===t)return this.m_jsonPatches.h[t];var e=this.getFieldIdxFromName(m.string(t));return null!=e?this.m_jsonPatches.h[e]:null},getValueAsJSONPatchIfAvailable:function(t){return this._getValueAsJSONPatchIfAvailable(t)},forEachChangedField:function(t){for(var e=this.m_changedFields.iterator();e.current<e.array.length;){var s=e.array[e.current++];try{t(this.getFieldNameFromIdx(s),s,Dt.toString(this.m_newValues.h[s]))}catch(t){var i=Gt.caught(t);Fs.isErrorEnabled()&&Fs.error("An exception was thrown while executing the Function passed to the forEachChangedField method\n"+i.details())}}},forEachField:function(t){for(var e=this.m_newValues,s=e.keys();s.hasNext();){var i=s.next(),n=e.get(i);try{t(this.getFieldNameFromIdx(i),i,Dt.toString(n))}catch(t){var r=Gt.caught(t);Fs.isErrorEnabled()&&Fs.error("An exception was thrown while executing the Function passed to the forEachField method\n"+r.details())}}},getValuePos:function(t){return Dt.toString(this.m_newValues.h[t])},getValueName:function(t){if(null==this.m_fields&&null==this.m_fields2)throw new Yt(Ls);var e=this.getFieldIdxFromName(t);if(null==e)throw new zt(Ns);return Dt.toString(this.m_newValues.h[e])},isValueChangedPos:function(t){return this.m_changedFields.contains(t)},isValueChangedName:function(t){if(null==this.m_fields&&null==this.m_fields2)throw new Yt(Ls);var e=this.getFieldIdxFromName(t);if(null==e)throw new zt(Ns);return this.m_changedFields.contains(e)},getFieldNameFromIdx:function(t){return t<=this.m_nFields?null!=this.m_fields?this.m_fields.h[t]:null:null!=this.m_fields2?this.m_fields2.h[t-this.m_nFields]:null},getFieldIdxFromName:function(t){var e,s,i=this.m_fields;return null!=i&&null!=(s=Pt(Jt.sure(i),t))?s:null!=(e=this.m_fields2)&&null!=(s=Pt(Jt.sure(e),t))?this.m_nFields+Jt.sure(s):null},toString:function(){var t="";t="[";for(var e=this.m_newValues,s=e.keys();s.hasNext();){var i=s.next(),n=e.get(i),r=this.getFieldNameFromIdx(i),a=null!=r?r:null==i?"null":""+i,o=m.string(n);i>1&&(t+=","),t+=null==a?"null":""+a,t+=":",t+=null==o?"null":""+o}return t+="]"},__class__:Tt});var Rt=function(t,e,s,i,n,r){var a=e.fetch_items(),o=e.fetch_fields();this.m_itemIdx=t,this.m_items=kt(a),this.m_nFields=Jt.sure(e.fetch_nFields()),this.m_fields=kt(o),null!=o&&o.length!=this.m_nFields&&As.isErrorEnabled()&&As.error("Expected "+this.m_nFields+" field names but got "+o.length+": "+m.string(o)),this.m_newValues=s.copy(),this.m_changedFields=i.copy(),this.m_isSnapshot=n,this.m_jsonPatches=r};Rt.__name__=!0,Rt.__super__=mt,Rt.prototype=c(mt.prototype,{getItemName:function(){return null!=this.m_items?this.m_items.h[this.m_itemIdx]:null},getItemPos:function(){return this.m_itemIdx},isSnapshot:function(){return this.m_isSnapshot},getValue:function(t){return"number"==typeof t&&(0|t)===t?this.getValuePos(t):this.getValueName(m.string(t))},isValueChanged:function(t){return"number"==typeof t&&(0|t)===t?this.isValueChangedPos(t):this.isValueChangedName(m.string(t))},_getValueAsJSONPatchIfAvailable:function(t){if("number"==typeof t&&(0|t)===t)return this.m_jsonPatches.h[t];var e=this.getFieldIdxFromName(m.string(t));return this.m_jsonPatches.h[e]},getValueAsJSONPatchIfAvailable:function(t){return this._getValueAsJSONPatchIfAvailable(t)},forEachChangedField:function(t){for(var e=this.m_changedFields.iterator();e.current<e.array.length;){var s=e.array[e.current++];try{t(null!=this.m_fields?this.m_fields.h[s]:null,s,Dt.toString(this.m_newValues.h[s]))}catch(t){var i=Gt.caught(t);Fs.isErrorEnabled()&&Fs.error("An exception was thrown while executing the Function passed to the forEachChangedField method\n"+i.details())}}},forEachField:function(t){for(var e=this.m_newValues,s=e.keys();s.hasNext();){var i=s.next(),n=e.get(i);try{t(null!=this.m_fields?this.m_fields.h[i]:null,i,Dt.toString(n))}catch(t){var r=Gt.caught(t);Fs.isErrorEnabled()&&Fs.error("An exception was thrown while executing the Function passed to the forEachField method\n"+r.details())}}},getValuePos:function(t){if(!(1<=t&&t<=this.m_nFields))throw new zt(Ds);return Dt.toString(this.m_newValues.h[t])},getValueName:function(t){var e=this.getFieldIdxFromName(t);return Dt.toString(this.m_newValues.h[e])},isValueChangedPos:function(t){if(!(1<=t&&t<=this.m_nFields))throw new zt(Ds);return this.m_changedFields.contains(t)},isValueChangedName:function(t){var e=this.getFieldIdxFromName(t);return this.m_changedFields.contains(e)},getFieldNameOrNullFromIdx:function(t){return null!=this.m_fields?this.m_fields.h[t]:null},getFieldIdxFromName:function(t){if(null==this.m_fields)throw new Yt(Ls);var e=Pt(this.m_fields,t);if(null==e)throw new zt(Ns);return e},toString:function(){var t="";t="[";for(var e=this.m_newValues,s=e.keys();s.hasNext();){var i=s.next(),n=e.get(i),r=this.getFieldNameOrNullFromIdx(i),a=null!=r?r:null==i?"null":""+i,o=m.string(n);i>1&&(t+=","),t+=null==a?"null":""+a,t+=":",t+=null==o?"null":""+o}return t+="]"},__class__:Rt});var xt=function(t,e){this.s_m=1,this.keyName=t,this.item=e,this.lock=e.lock};xt.__name__=!0,xt.__interfaces__=[bt],xt.prototype={finalize:function(){this.currKeyValues=null,this.item.unrelate(this.keyName)},evtUpdate:function(t,e){switch(this.traceEvent("update"),this.s_m){case 1:this.isDelete(t)?(this.doLightDelete(t,e),this.finalize(),this.goto(3)):(this.doFirstUpdate(t,e),this.goto(2));break;case 2:this.isDelete(t)?(this.doDelete(t,e),this.finalize(),this.goto(3)):(this.doUpdate(t,e),this.goto(2))}},evtDispose:function(){switch(this.traceEvent("dispose"),this.s_m){case 1:case 2:this.finalize(),this.goto(3)}},evtSetRequestedMaxFrequency:function(){},getCommandValue:function(t){return null!=this.currKeyValues?Dt.toString(this.currKeyValues.h[t]):null},doFirstUpdate:function(t,e){var s=Jt.sure(this.item.subscription.fetch_nFields()),i=this.item.subscription.getCommandPosition();this.currKeyValues=t,this.currKeyValues.h[i]=Lt.StringVal("ADD");var n=new ue(new _(1,s+1));this.fireOnItemUpdate(new Rt(this.item.itemIdx,this.item.subscription,this.currKeyValues,n,e,new es))},doUpdate:function(t,e){var s=this.item.subscription.getCommandPosition(),i=this.currKeyValues;this.currKeyValues=t,this.currKeyValues.h[s]=Lt.StringVal("UPDATE");var n=Ot(i,this.currKeyValues);this.fireOnItemUpdate(new Rt(this.item.itemIdx,this.item.subscription,this.currKeyValues,n,e,new es))},doLightDelete:function(t,e){this.currKeyValues=null;var s=new ue(t.keys()),i=new Rt(this.item.itemIdx,this.item.subscription,this.nullify(t),s,e,new es);this.item.unrelate(this.keyName),this.fireOnItemUpdate(i)},doDelete:function(t,e){this.currKeyValues=null;var s=new ue(t.keys()).subtracting([this.item.subscription.getKeyPosition()]),i=new Rt(this.item.itemIdx,this.item.subscription,this.nullify(t),s,e,new es);this.item.unrelate(this.keyName),this.fireOnItemUpdate(i)},nullify:function(t){for(var e=new es,s=t,i=s.keys();i.hasNext();){var n=i.next(),r=s.get(n),a=n==this.item.subscription.getCommandPosition()||n==this.item.subscription.getKeyPosition();e.h[n]=a?r:null}return e},isDelete:function(t){var e=this.item.subscription.getCommandPosition();return"DELETE"==Dt.toString(t.h[e])},fireOnItemUpdate:function(t){this.item.subscription.fireOnItemUpdate(t,this.item.m_subId)},goto:function(t){this.s_m=t,this.traceEvent("goto")},traceEvent:function(t){if(Ps.isTraceEnabled()){var e=this.item.m_subId,s=this.item.itemIdx;Ps.isTraceEnabled()&&Ps.trace("sub#key#"+t+"("+e+":"+s+":"+this.keyName+") in "+this.s_m)}},__class__:xt};var Ct=function(t,e){this.s_m=1,this.keyName=t,this.item=e,this.lock=e.lock};Ct.__name__=!0,Ct.__interfaces__=[bt],Ct.prototype={finalize:function(){this.currKeyValues=null,this.currKey2Values=null,this.item.unrelate(this.keyName)},evtUpdate:function(t,e){switch(this.traceEvent("update"),this.s_m){case 1:if(this.isDelete(t))this.doLightDelete(t,e),this.finalize(),this.goto(11),this.genOnRealMaxFrequency2LevelRemoved();else{var s=this.create2LevelSubscription();null!=s?(this.doFirstUpdate(t,e),this.subscription2Level=s,this.goto(4),this.item.strategy.client.subscribeExt(s,!0)):(this.doFirstUpdate(t,e),this.notify2LevelIllegalArgument(),this.goto(3))}break;case 3:this.isDelete(t)?(this.doDelete1LevelOnly(t,e),this.finalize(),this.goto(11),this.genOnRealMaxFrequency2LevelRemoved()):(this.doUpdate(t,e),this.goto(3));break;case 4:this.isDelete(t)?(this.doDelete(t,e),this.finalize(),this.goto(11),this.genOnRealMaxFrequency2LevelRemoved()):(this.doUpdate(t,e),this.goto(4));break;case 5:this.isDelete(t)?(this.doDeleteExt(t,e),this.finalize(),this.goto(11),this.genOnRealMaxFrequency2LevelRemoved()):(this.doUpdate1Level(t,e),this.goto(5))}},evtDispose:function(){switch(this.traceEvent("dispose"),this.s_m){case 1:case 2:case 3:this.finalize(),this.goto(10);break;case 4:case 5:this.doUnsubscribe(),this.finalize(),this.goto(12)}},evtOnSubscriptionError2Level:function(t,e){this.traceEvent("onSubscriptionError2Level"),4==this.s_m&&(this.notify2LevelSubscriptionError(t,e),this.goto(3))},evtUpdate2Level:function(t){switch(this.traceEvent("update2Level"),this.s_m){case 4:case 5:this.doUpdate2Level(t),this.goto(5)}},evtOnUnsubscription2Level:function(){switch(this.traceEvent("onUnsubscription2Level"),this.s_m){case 4:case 5:this.doUnsetRealMaxFrequency(),this.goto(this.s_m),this.genOnRealMaxFrequency2LevelRemoved()}},evtOnItemLostUpdates2Level:function(t){switch(this.traceEvent("onItemLostUpdates2Level"),this.s_m){case 4:case 5:this.goto(this.s_m),this.notify2LevelLostUpdates(t)}},evtOnRealMaxFrequency2Level:function(t){switch(this.traceEvent("onRealMaxFrequency2Level"),this.s_m){case 4:case 5:this.doSetRealMaxFrequency(t),this.goto(this.s_m),this.genOnRealMaxFrequency2LevelAdded()}},evtSetRequestedMaxFrequency:function(){switch(this.traceEvent("setRequestedMaxFrequency"),this.s_m){case 4:case 5:this.doChangeRequestedMaxFrequency(),this.goto(this.s_m)}},getCommandValue:function(t){if(null!=(e=this.currKeyValues)&&null!=e.h[t])return Dt.toString(e.h[t]);var e=this.currKey2Values,s=this.item.subscription.fetch_nFields();return null!=e&&null!=s?e.h[t-s]:null},doFirstUpdate:function(t,e){var s=this.item.subscription.getCommandPosition();this.currKeyValues=t,this.currKeyValues.h[s]=Lt.StringVal("ADD");var i=Ot(null,this.currKeyValues);this.fireOnItemUpdate(new Tt(this.item.itemIdx,this.item.subscription,this.currKeyValues,i,e,new es))},doUpdate:function(t,e){var s=this.item.subscription.getCommandPosition(),i=this.currKeyValues;this.currKeyValues=t,this.currKeyValues.h[s]=Lt.StringVal("UPDATE");var n=Ot(i,this.currKeyValues);this.fireOnItemUpdate(new Tt(this.item.itemIdx,this.item.subscription,this.currKeyValues,n,e,new es))},doUpdate2Level:function(t){var e=this.item.subscription.getCommandPosition(),s=Jt.sure(this.item.subscription.fetch_nFields()),i=Jt.sure(this.currKeyValues).copy();this.currKeyValues.h[e]=Lt.StringVal("UPDATE"),this.currKey2Values=function(t){var e=new es;return t.forEachField((function(t,s,i){e.h[s]=i})),e}(t);for(var n=Jt.sure(this.currKeyValues).copy(),r=(c=this.currKey2Values).keys();r.hasNext();){var a=r.next(),o=c.get(a);n.h[a+s]=null==o?null:Lt.StringVal(o)}var h=new ue;Dt.toString(i.h[e])!=Dt.toString(this.currKeyValues.h[e])&&h.insert(e);var c=function(t){var e=new es;return t.forEachChangedField((function(t,s,i){e.h[s]=i})),e}(t);for(r=c.keys();r.hasNext();){a=r.next();c.get(a),h.insert(a+s)}var l=t.isSnapshot(),u=new es;for(r=(c=this.currKey2Values).keys();r.hasNext();){a=r.next();c.get(a);var _=t.getValueAsJSONPatchIfAvailable(a);null!=_&&(u.h[a+s]=_)}this.fireOnItemUpdate(new Tt(this.item.itemIdx,this.item.subscription,n,h,l,u))},doUpdate1Level:function(t,e){var s=this.item.subscription.getCommandPosition(),i=Jt.sure(this.item.subscription.fetch_nFields()),n=Jt.sure(this.currKeyValues);this.currKeyValues=t,this.currKeyValues.h[s]=Lt.StringVal("UPDATE");for(var r=Jt.sure(this.currKeyValues).copy(),a=Jt.sure(this.currKey2Values),o=a.keys();o.hasNext();){var h=o.next(),c=a.get(h);r.h[h+i]=null==c?null:Lt.StringVal(c)}for(var l=new ue,u=1,_=i+1;u<_;){var d=u++;Dt.toString(n.h[d])!=Dt.toString(r.h[d])&&l.insert(d)}this.fireOnItemUpdate(new Tt(this.item.itemIdx,this.item.subscription,r,l,e,new es))},doDelete:function(t,e){var s=Jt.sure(this.item.subscription.fetch_nFields()),i=this.item.subscription.getKeyPosition(),n=this.item.subscription.getCommandPosition();this.currKeyValues=null;for(var r=new ue(new _(1,s+1)).subtracting([i]),a=new es,o=1,h=s+1;o<h;)a.h[o++]=null;a.h[i]=Lt.StringVal(this.keyName),a.h[n]=Lt.StringVal("DELETE");var c=new Tt(this.item.itemIdx,this.item.subscription,a,r,e,new es);this.item.unrelate(this.keyName);var l=Jt.sure(this.subscription2Level);l.removeListener(Jt.sure(this.listener2Level)),Jt.sure(this.listener2Level).disable(),this.subscription2Level=null,this.listener2Level=null,this.item.strategy.client.unsubscribe(l),this.fireOnItemUpdate(c)},doDeleteExt:function(t,e){var s=Jt.sure(this.item.subscription.fetch_nFields()),i=this.item.subscription.getKeyPosition(),n=this.item.subscription.getCommandPosition(),r=s+d.count(Jt.sure(this.currKey2Values));this.currKeyValues=null,this.currKey2Values=null;for(var a=new ue(new _(1,r+1)).subtracting([i]),o=new es,h=1,c=r+1;h<c;)o.h[h++]=null;o.h[i]=Lt.StringVal(this.keyName),o.h[n]=Lt.StringVal("DELETE");var l=new Tt(this.item.itemIdx,this.item.subscription,o,a,e,new es);this.item.unrelate(this.keyName);var u=Jt.sure(this.subscription2Level);u.removeListener(Jt.sure(this.listener2Level)),Jt.sure(this.listener2Level).disable(),this.subscription2Level=null,this.listener2Level=null,this.item.strategy.client.unsubscribe(u),this.fireOnItemUpdate(l)},doLightDelete:function(t,e){var s=Jt.sure(this.item.subscription.fetch_nFields()),i=this.item.subscription.getKeyPosition(),n=this.item.subscription.getCommandPosition();this.currKeyValues=null;for(var r=new ue(new _(1,s+1)),a=new es,o=1,h=s+1;o<h;)a.h[o++]=null;a.h[i]=t.h[i],a.h[n]=t.h[n],this.fireOnItemUpdate(new Tt(this.item.itemIdx,this.item.subscription,a,r,e,new es))},doDelete1LevelOnly:function(t,e){var s=Jt.sure(this.item.subscription.fetch_nFields()),i=this.item.subscription.getKeyPosition(),n=this.item.subscription.getCommandPosition();this.currKeyValues=null;for(var r=new ue(new _(1,s+1)).subtracting([i]),a=new es,o=1,h=s+1;o<h;)a.h[o++]=null;a.h[i]=t.h[i],a.h[n]=t.h[n],this.fireOnItemUpdate(new Tt(this.item.itemIdx,this.item.subscription,a,r,e,new es))},doChangeRequestedMaxFrequency:function(){Jt.sure(this.subscription2Level).setRequestedMaxFrequency(Ie.toString(this.item.strategy.requestedMaxFrequency))},doSetRealMaxFrequency:function(t){this.realMaxFrequency=t},doUnsetRealMaxFrequency:function(){this.realMaxFrequency=null},genOnRealMaxFrequency2LevelAdded:function(){this.item.strategy.evtOnRealMaxFrequency2LevelAdded(this.realMaxFrequency)},genOnRealMaxFrequency2LevelRemoved:function(){this.item.strategy.evtOnRealMaxFrequency2LevelRemoved()},doUnsubscribe:function(){if(null==this.subscription2Level)throw new Yt("Assertion failure: subscription2Level != null");if(null==this.listener2Level)throw new Yt("Assertion failure: listener2Level != null");var t=this.subscription2Level;t.removeListener(this.listener2Level),this.listener2Level.disable(),this.subscription2Level=null,this.listener2Level=null,this.item.strategy.client.unsubscribe(t)},notify2LevelIllegalArgument:function(){this.listener2Level=null,this.subscription2Level=null,this.item.subscription.fireOnSubscriptionError2Level(this.keyName,14,"The received key value is not a valid name for an Item",this.item.m_subId,this.item.itemIdx)},notify2LevelSubscriptionError:function(t,e){this.listener2Level=null,this.subscription2Level=null,this.item.subscription.fireOnSubscriptionError2Level(this.keyName,t,e,this.item.m_subId,this.item.itemIdx)},notify2LevelLostUpdates:function(t){this.item.subscription.fireOnLostUpdates2Level(this.keyName,t,this.item.m_subId,this.item.itemIdx)},fireOnItemUpdate:function(t){this.item.subscription.fireOnItemUpdate(t,this.item.m_subId)},create2LevelSubscription:function(){this.listener2Level=new It(this);var t=this.item.subscription,e=new x("MERGE",null,null),s=[this.keyName];if(!ke.allValidNames(s))return null;e.setItems(s.slice());var i=t.getCommandSecondLevelFields();return null!=i?e.setFields(i):e.setFieldSchema(t.getCommandSecondLevelFieldSchema()),e.setDataAdapter(t.getCommandSecondLevelDataAdapter()),e.setRequestedSnapshot(xe.toString(Re.SnpYes)),e.setRequestedMaxFrequency(Ie.toString(this.item.strategy.requestedMaxFrequency)),e.addListener(Jt.sure(this.listener2Level)),e.setInternal(),e},isDelete:function(t){var e=this.item.subscription.getCommandPosition();return"DELETE"==Dt.toString(t.h[e])},goto:function(t){this.s_m=t,this.traceEvent("goto")},traceEvent:function(t){if(Ps.isTraceEnabled()){var e=this.item.m_subId,s=this.item.itemIdx;Ps.isTraceEnabled()&&Ps.trace("sub#key#"+t+"("+e+":"+s+":"+this.keyName+") in "+this.s_m)}},__class__:Ct};var It=function(t){this.m_disabled=!1,this.key=t};It.__name__=!0,It.__interfaces__=[r],It.prototype={disable:function(){var t=this;this.key.lock.synchronized((function(){return t.m_disabled=!0}))},synchronized:function(t){var e=this;this.key.lock.synchronized((function(){e.m_disabled||t()}))},onSubscriptionError:function(t,e){var s=this;this.synchronized((function(){s.key.evtOnSubscriptionError2Level(t,e)}))},onItemUpdate:function(t){var e=this;this.synchronized((function(){e.key.evtUpdate2Level(t)}))},onItemLostUpdates:function(t,e,s){var i=this;this.synchronized((function(){i.key.evtOnItemLostUpdates2Level(s)}))},onRealMaxFrequency:function(t){var e=this;this.synchronized((function(){var s,i=e.key;if(null==t)s=null;else if(null==t){var n=parseFloat(t);s=isNaN(n)?null:Le.RFreqLimited(n)}else if("unlimited"==t)s=Le.RFreqUnlimited;else{n=parseFloat(t);s=isNaN(n)?null:Le.RFreqLimited(n)}i.evtOnRealMaxFrequency2Level(s)}))},onUnsubscription:function(){var t=this;this.synchronized((function(){t.key.evtOnUnsubscription2Level()}))},onClearSnapshot:function(t,e){},onCommandSecondLevelItemLostUpdates:function(t,e){},onCommandSecondLevelSubscriptionError:function(t,e,s){},onEndOfSnapshot:function(t,e){},onListenEnd:function(t){},onListenStart:function(t){},onSubscription:function(){},__class__:It};var Lt=h["com.lightstreamer.client.internal.update.CurrFieldVal"]={__ename__:!0,__constructs__:null,StringVal:(i=function(t){return{_hx_index:0,string:t,__enum__:"com.lightstreamer.client.internal.update.CurrFieldVal",toString:o}},i._hx_name="StringVal",i.__params__=["string"],i),JsonVal:(i=function(t){return{_hx_index:1,json:t,__enum__:"com.lightstreamer.client.internal.update.CurrFieldVal",toString:o}},i._hx_name="JsonVal",i.__params__=["json"],i)};Lt.__constructs__=[Lt.StringVal,Lt.JsonVal];var Dt=function(){};function Nt(t,e){if(null!=t){for(var s=new es,i=(S=e).keys();i.hasNext();){var n=i.next();switch((y=S.get(n))._hx_index){case 0:s.h[n]=t.h[n];break;case 1:var r=y.val;s.h[n]=null==r?null:Lt.StringVal(r);break;case 2:var a=y.patch,o=t.h[n];if(null==o)throw new Yt("Cannot apply the JSON patch to the field "+n+" because the field is null");switch(o._hx_index){case 0:var h=o.string,c=null;try{c=Be._new(h)}catch(t){var l=Gt.caught(t);throw Ms.isErrorEnabled()&&Ms.error(l.get_message()+"\n"+l.details()),new Yt("Cannot convert the field "+n+" to JSON")}try{var u=Lt.JsonVal(Be.apply(Jt.sure(c),a));s.h[n]=u}catch(t){var _=Gt.caught(t);throw Ms.isErrorEnabled()&&Ms.error(_.get_message()+"\n"+_.details()),new Yt("Cannot apply the JSON Patch to the field "+n)}break;case 1:var d=o.json;try{var f=Lt.JsonVal(Be.apply(d,a));s.h[n]=f}catch(t){var m=Gt.caught(t);throw Ms.isErrorEnabled()&&Ms.error(m.get_message()+"\n"+m.details()),new Yt("Cannot apply the JSON Patch to the field "+n)}}break;case 3:var g=y.patch,p=t.h[n];if(null==p)throw new Yt("Cannot apply the TLCP-diff to the field "+n+" because the field is null");switch(p._hx_index){case 0:var v=Lt.StringVal(new We(p.string,g).decode());s.h[n]=v;break;case 1:throw new Yt("Cannot apply the TLCP-diff to the field "+n+" because the field is JSON")}}}return s}var S;for(s=new es,i=(S=e).keys();i.hasNext();){var y;n=i.next();switch((y=S.get(n))._hx_index){case 0:throw new Yt("Cannot set the field "+n+" because the first update is UNCHANGED");case 1:r=y.val;s.h[n]=null==r?null:Lt.StringVal(r);break;case 2:throw new Yt("Cannot set the field "+n+" because the first update is a JSONPatch");case 3:throw new Yt("Cannot set the field "+n+" because the first update is a TLCP-diff")}}return s}function Ot(t,e){if(null!=t){for(var s=new ue,i=(r=e).keys();i.hasNext();){var n=i.next();r.get(n),Dt.toString(t.h[n])!=Dt.toString(e.h[n])&&s.insert(n)}return s}var r;for(s=new ue,i=(r=e).keys();i.hasNext();){n=i.next();r.get(n),s.insert(n)}return s}function kt(t){if(null!=t){for(var e=new es,s=0;s<t.length;){var i=t[s++];e.h[s-1+1]=i}return e}return null}function Pt(t,e){for(var s=1,i=d.count(t)+1;s<i;){var n=s++;if(t.h[n]==e)return n}return null}Dt.__name__=!0,Dt.toString=function(t){if(null==t)return null;switch(t._hx_index){case 0:return t.string;case 1:return Be.toString(t.json)}};var Mt=function(){this.store=new Je};Mt.__name__=!0,Mt.prototype={addCookies:function(t,e){if(0!=e.length){Bs.isDebugEnabled()&&(this.logCookies("Before adding cookies for "+t,this.store.getCookies(je.All)),this.logCookies2("Cookies to be added for "+t,e));var s=new _s(t);this.store.setCookies(e,s.hostname,s.pathname),Bs.isDebugEnabled()&&this.logCookies("After adding cookies for "+t,this.store.getCookies(je.All))}},getCookies:function(t){var e;if(null==t)e=je.All;else{var s=new _s(t);e=new je(s.hostname,s.pathname)}for(var i=this.store.getCookies(e),n=new Array(i.length),r=0,a=i.length;r<a;){var o=r++;n[o]=i[o].toString()}return n},getCookieHeader:function(t){for(var e=new _s(t),s=this.store.getCookies(new je(e.hostname,e.pathname)),i="",n=0;n<s.length;){var r=s[n];++n,r.secure&&"https:"!=e.protocol||(""!=i&&(i+="; "),i+=r.toValueString())}return""!=i&&Bs.isDebugEnabled()&&Bs.debug("Cookie: "+i),""!=i?ss.Some(i):ss.None},clearCookies:function(){for(var t=this.store.getCookies(je.All),e=0;e<t.length;)t[e++].expiration_date=0;this.store.setCookies(t)},logCookies:function(t,e){for(var s=0;s<e.length;)t+="\r\n    "+e[s++].toString();Bs.isDebugEnabled()&&Bs.debug(t)},logCookies2:function(t,e){for(var s=0;s<e.length;)t+="\r\n    "+e[s++];Bs.isDebugEnabled()&&Bs.debug(t)},__class__:Mt};var Ft=function(){};Ft.__name__=!0,Ft.prototype={submit:function(t){global.setImmediate(t)},schedule:function(t,e){return new qt(global.setTimeout(t,e))},stop:function(){},__class__:Ft};var qt=function(t){this.handle=t};qt.__name__=!0,qt.prototype={isCanceled:function(){return null==this.handle},cancel:function(){null!=this.handle&&(global.clearTimeout(this.handle),this.handle=null)},__class__:qt};var At=function(){};At.__name__=!0,At.prototype={toString:function(){return"{}"},__class__:At};var Wt=function(){};Wt.__name__=!0,Wt.__isInterface__=!0,Wt.prototype={__class__:Wt};var Bt=function(t,e,s,i,n,r,a){this.isCanceled=!1,this.reader=new _e;var o=this;if(Os.isDebugEnabled()&&Os.debug("HTTP sending: "+t+" "+e+" headers("+(null==s?"null":is.stringify(s.h))+")"),this.xhr=new fs,this.xhr.open("POST",t),this.xhr.withCredentials=i,null!=s)for(var h=s.h,c=Object.keys(h),l=c.length,u=0;u<l;){var _=c[u++];this.xhr.setRequestHeader(_,h[_])}var d=Mt.instance.getCookieHeader(t);0==d._hx_index&&(this.xhr.setDisableHeaderCheck(!0),this.xhr.setRequestHeader("Cookie",d.v),this.xhr.setDisableHeaderCheck(!1)),this.xhr.setRequestHeader("Content-Type","text/plain; charset=utf-8"),this.xhr.send(e),this.xhr.onreadystatechange=function(){if(!o.isCanceled){var e=o.xhr.readyState;if(2==e){var s=o.xhr.getResponseHeader("Set-Cookie");null!=s&&Mt.instance.addCookies(t,s);var i=o.xhr.status;0==i||i>=200&&i<300||(Os.isDebugEnabled()&&Os.debug("HTTP event: error(HTTP code "+i+")"),r(o,"Unexpected HTTP code: "+i),o.xhr.abort())}else if(e>2){for(var h=3==e?o.reader.extractNewData(o.xhr.responseText,!1):o.reader.extractNewData(o.xhr.responseText,!0),c=0;c<h.length;){var l=h[c];if(++c,o.isCanceled)return;""!=l&&(Os.isDebugEnabled()&&Os.debug("HTTP event: text("+l+")"),n(o,l))}4==e&&(Os.isDebugEnabled()&&Os.debug("HTTP event: complete"),a(o))}}},this.xhr.onerror=function(){o.isCanceled||(Os.isDebugEnabled()&&Os.debug("HTTP event: error(Network error)"),r(o,"Network error"))}};Bt.__name__=!0,Bt.__interfaces__=[Wt],Bt.prototype={dispose:function(){Os.isDebugEnabled()&&Os.debug("HTTP disposing"),this.isCanceled=!0,this.xhr.abort()},isDisposed:function(){return this.isCanceled},__class__:Bt};var Ht={_new:function(){return new is},set:function(t,e,s){null!=s&&(t.h[e]=null==s?"null":m.string(s))}},Ut=function(){this.values=[],this.nRemoved=0};Ut.__name__=!0,Ut.prototype={get_length:function(){return this.values.length-this.nRemoved},compact:function(){this.nRemoved>this.values.length/2&&(this.nRemoved=0,this.values=this.copy().values)},push:function(t){this.values.push(new Vt(t))},remove:function(t){for(var e=0,s=this.values.length;e<s;){var i=e++;if(this.values[i].item==t&&this.values[i].isValid){this.nRemoved++,this.values[i].isValid=!1;break}}},filter:function(t){for(var e=new Ut,s=new Kt(this);s.hasNext();){var i=s.next();t(i)&&e.values.push(new Vt(i))}return e},map:function(t){for(var e=new Ut,s=new Kt(this);s.hasNext();){var i=t(s.next());e.values.push(new Vt(i))}return e},exists:function(t){return d.exists(this,t)},find:function(t){return d.find(this,t)},contains:function(t){return d.has(this,t)},iterator:function(){return new Kt(this)},copy:function(){for(var t=new Ut,e=new Kt(this);e.hasNext();){var s=e.next();t.values.push(new Vt(s))}return t},toString:function(){for(var t=0,e=this.values.length-this.nRemoved,s="[",i=new Kt(this);i.hasNext();)s+=m.string(i.next())+(t!=e-1?", ":""),++t;return s+"]"},__class__:Ut};var Vt=function(t){this.isValid=!0,this.item=t};Vt.__name__=!0,Vt.prototype={__class__:Vt};var Kt=function(t){this.a=t,this.index=0};Kt.__name__=!0,Kt.prototype={hasNext:function(){for(var t=this.index,e=this.a.values.length;t<e;)if(this.a.values[t++].isValid)return!0;return!1},next:function(){for(var t=this.index,e=this.a.values.length;t<e;){var s=t++;if(this.a.values[s].isValid)return this.index=s+1,this.a.values[s].item}throw new Gt("No such element")},__class__:Kt};var Gt=function(t,e,s){Error.call(this,t),this.message=t,this.__previousException=e,this.__nativeException=null!=s?s:this,this.__skipStack=0;var i=Error.prepareStackTrace;if(Error.prepareStackTrace=function(t){return t.stack},s instanceof Error)this.stack=s.stack;else{var n=null;if(Error.captureStackTrace)Error.captureStackTrace(this,Gt),n=this;else if(void 0===(n=new Error).stack){try{throw n}catch(t){}this.__skipStack++}this.stack=n.stack}Error.prepareStackTrace=i};Gt.__name__=!0,Gt.caught=function(t){return t instanceof Gt?t:t instanceof Error?new Gt(t.message,null,t):new ts(t,null,t)},Gt.thrown=function(t){if(t instanceof Gt)return t.get_native();if(t instanceof Error)return t;var e=new ts(t);return e.__skipStack++,e},Gt.__super__=Error,Gt.prototype=c(Error.prototype,{toString:function(){return this.get_message()},details:function(){if(null==this.get_previous()){var t="Exception: "+this.toString(),e=this.get_stack();return t+(null==e?"null":Ze.toString(e))}for(var s="",i=this,n=null;null!=i;){if(null==n){s="Exception: "+i.get_message()+(null==(t=i.get_stack())?"null":Ze.toString(t))+s}else{var r=Ze.subtract(i.get_stack(),n.get_stack());s="Exception: "+i.get_message()+(null==r?"null":Ze.toString(r))+"\n\nNext "+s}n=i,i=i.get_previous()}return s},__shiftStack:function(){this.__skipStack++},get_message:function(){return this.message},get_previous:function(){return this.__previousException},get_native:function(){return this.__nativeException},get_stack:function(){var t=this.__exceptionStack;if(null==t){var e=Xe.toHaxe(Xe.normalize(this.stack),this.__skipStack);return this.setProperty("__exceptionStack",e),e}return t},setProperty:function(t,e){try{Object.defineProperty(this,t,{value:e})}catch(s){this[t]=e}},__class__:Gt});var zt=function(t,e,s){Gt.call(this,t,e,s),this.__skipStack++};zt.__name__=!0,zt.__super__=Gt,zt.prototype=c(Gt.prototype,{__class__:zt});var Yt=function(t,e,s){Gt.call(this,t,e,s),this.__skipStack++};Yt.__name__=!0,Yt.__super__=Gt,Yt.prototype=c(Gt.prototype,{__class__:Yt});var Qt={fromHaxeMap:function(t){return Qt.fromMapToDynamicAccess(t)},toHaxeMap:function(t){return Qt.toHaxe(t)},fromMapToDynamicAccess:function(t){for(var e={},s=t.h,i=Object.keys(s),n=i.length,r=0;r<n;){var a=i[r++];e[a]=s[a]}return e},toHaxe:function(t){for(var e=new is,s=f.fields(t),i=0;i<s.length;){var n=s[i++];e.h[n]=t[n]}return e},toDynamicAccess:function(t){return f.copy(t)}},jt={fromHaxeArray:function(t){return t.slice()},toHaxeArray:function(t){return jt.copy(t,t)},_new:function(t){return t.slice()},toHaxe:function(t){return jt.copy(t,t)},copy:function(t,e){for(var s=[],i=0,n=e.length;i<n;)s[i]=e[i],++i;return s}},Jt=function(){};Jt.__name__=!0,Jt.sure=function(t){if(null==t)throw Gt.thrown("null pointer in .sure() call");return t},Jt.or=function(t,e){return null==t?e:t};var $t=function(){};$t.__name__=!0,$t.__isInterface__=!0,$t.prototype={__class__:$t};var Zt=function(){this._innerMap=new es,this._orderedKeys=new Ut};Zt.__name__=!0,Zt.__interfaces__=[$t],Zt.prototype={compact:function(){this._orderedKeys.compact()},set:function(t,e){this._innerMap.h.hasOwnProperty(t)||this._orderedKeys.values.push(new Vt(t)),this._innerMap.h[t]=e},get:function(t){return this._innerMap.h[t]},exists:function(t){return this._innerMap.h.hasOwnProperty(t)},remove:function(t){var e=this._innerMap.remove(t);return e&&this._orderedKeys.remove(t),e},keys:function(){return new Kt(this._orderedKeys)},iterator:function(){return new Xt(this)},keyValueIterator:function(){return new hs(this)},copy:function(){var t=new Zt;return t._orderedKeys=this._orderedKeys.copy(),t._innerMap=this._innerMap.copy(),t},get_length:function(){var t=this._orderedKeys;return t.values.length-t.nRemoved},keysCopy:function(){return this._orderedKeys.copy()},clear:function(){this._orderedKeys=new Ut,this._innerMap=new es},toString:function(){for(var t=0,e=this._orderedKeys,s=e.values.length-e.nRemoved,i="[",n=new Kt(this._orderedKeys);n.hasNext();){var r=n.next();i+=r+" => "+m.string(this._innerMap.h[r])+(t!=s-1?", ":""),++t}return i+"]"},__class__:Zt};var Xt=function(t){this.map=t,this.it=new Kt(t._orderedKeys)};Xt.__name__=!0,Xt.prototype={hasNext:function(){return this.it.hasNext()},next:function(){var t=this.map,e=this.it.next();return t._innerMap.h[e]},__class__:Xt};var te=function(){};te.__name__=!0,te.__isInterface__=!0,te.prototype={__class__:te};var ee=function(){};ee.__name__=!0,ee.__isInterface__=!0,ee.prototype={__class__:ee};var se=h["com.lightstreamer.internal.ReachabilityStatus"]={__ename__:!0,__constructs__:null,RSReachable:{_hx_name:"RSReachable",_hx_index:0,__enum__:"com.lightstreamer.internal.ReachabilityStatus",toString:o},RSNotReachable:{_hx_name:"RSNotReachable",_hx_index:1,__enum__:"com.lightstreamer.internal.ReachabilityStatus",toString:o}};se.__constructs__=[se.RSReachable,se.RSNotReachable];var ie=function(){};ie.__name__=!0,ie.__isInterface__=!0,ie.prototype={__class__:ie};var ne=h["com.lightstreamer.internal.PageState"]={__ename__:!0,__constructs__:null,Frozen:{_hx_name:"Frozen",_hx_index:0,__enum__:"com.lightstreamer.internal.PageState",toString:o},Resumed:{_hx_name:"Resumed",_hx_index:1,__enum__:"com.lightstreamer.internal.PageState",toString:o}};ne.__constructs__=[ne.Frozen,ne.Resumed];var re=function(){};re.__name__=!0,re.__isInterface__=!0,re.prototype={__class__:re};var ae=function(t){this.connectionOptions=t.connectionOptions};ae.__name__=!0,ae.__interfaces__=[re],ae.prototype={createWsClient:function(t,e,s,i,n){return new Ae(t,e,s,i,n)},createHttpClient:function(t,e,s,i,n,r){return new Bt(t,e,s,this.connectionOptions.isCookieHandlingRequired(),i,n,r)},createCtrlClient:function(t,e,s,i,n,r){return this.createHttpClient(t,e,s,i,n,r)},createReachabilityManager:function(t){return new he},createTimer:function(t,e,s){return new me(t,e,s)},randomMillis:function(t){return m.random(t)},createPageLifecycleFactory:function(t){return new I},__class__:ae};var oe=function(){};oe.__name__=!0,oe.prototype={acquire:function(){},release:function(){},synchronized:function(t){var e=null,s=null;try{s=t()}catch(t){e=Gt.caught(t)}if(null!=e)throw Gt.thrown(e);return s},__class__:oe};var he=function(){};he.__name__=!0,he.__interfaces__=[ie],he.prototype={startListening:function(t){},stopListening:function(){},__class__:he};var ce=function(t,e){this.key=t,this.val=e};ce.__name__=!0,ce.prototype={toEncodedPair:function(){var t=this.key,e=encodeURIComponent(t)+"=";t=this.val;return e+encodeURIComponent(t)},toString:function(){return this.key+"="+this.val},__class__:ce};var le=function(){this.params=[]};le.__name__=!0,le.prototype={LS_reqId:function(t){this.addParamAny("LS_reqId",t)},LS_message:function(t){this.addParamString("LS_message",t)},LS_sequence:function(t){this.addParamString("LS_sequence",t)},LS_msg_prog:function(t){this.addParamAny("LS_msg_prog",t)},LS_max_wait:function(t){this.addParamAny("LS_max_wait",t)},LS_outcome:function(t){this.addParamBool("LS_outcome",t)},LS_ack:function(t){this.addParamBool("LS_ack",t)},LS_op:function(t){this.addParamString("LS_op",t)},LS_subId:function(t){this.addParamAny("LS_subId",t)},LS_mode:function(t){this.addParamString("LS_mode",t)},LS_group:function(t){this.addParamString("LS_group",t)},LS_schema:function(t){this.addParamString("LS_schema",t)},LS_data_adapter:function(t){this.addParamString("LS_data_adapter",t)},LS_requested_max_frequency:function(t){this.addParamString("LS_requested_max_frequency",t)},LS_requested_max_frequency_Float:function(t){this.addParamAny("LS_requested_max_frequency",t)},LS_requested_buffer_size:function(t){this.addParamString("LS_requested_buffer_size",t)},LS_requested_buffer_size_Int:function(t){this.addParamAny("LS_requested_buffer_size",t)},LS_cause:function(t){this.addParamString("LS_cause",t)},LS_keepalive_millis:function(t){this.addParamAny("LS_keepalive_millis",t)},LS_inactivity_millis:function(t){this.addParamAny("LS_inactivity_millis",t)},LS_requested_max_bandwidth:function(t){this.addParamString("LS_requested_max_bandwidth",t)},LS_requested_max_bandwidth_Float:function(t){this.addParamAny("LS_requested_max_bandwidth",t)},LS_adapter_set:function(t){this.addParamString("LS_adapter_set",t)},LS_user:function(t){this.addParamString("LS_user",t)},LS_password:function(t){this.addParamString("LS_password",t)},LS_cid:function(t){this.addParamString("LS_cid",t)},LS_old_session:function(t){this.addParamString("LS_old_session",t)},LS_session:function(t){this.addParamString("LS_session",t)},LS_send_sync:function(t){this.addParamBool("LS_send_sync",t)},LS_polling:function(t){this.addParamBool("LS_polling",t)},LS_polling_millis:function(t){this.addParamAny("LS_polling_millis",t)},LS_idle_millis:function(t){this.addParamAny("LS_idle_millis",t)},LS_content_length:function(t){this.addParamAny("LS_content_length",t)},LS_ttl_millis:function(t){this.addParamString("LS_ttl_millis",t)},LS_recovery_from:function(t){this.addParamAny("LS_recovery_from",t)},LS_close_socket:function(t){this.addParamBool("LS_close_socket",t)},LS_selector:function(t){this.addParamString("LS_selector",t)},LS_snapshot:function(t){this.addParamBool("LS_snapshot",t)},LS_snapshot_Int:function(t){this.addParamAny("LS_snapshot",t)},addParamString:function(t,e){this.params.push(new ce(t,e))},addParamAny:function(t,e){this.addParamString(t,""+(null==e?"null":m.string(e)))},addParamBool:function(t,e){this.addParamString(t,e?"true":"false")},getEncodedString:function(){for(var t=this.params,e=new Array(t.length),s=0,i=t.length;s<i;){var n=s++;e[n]=t[n].toEncodedPair()}return e.join("&")},toString:function(){return this.params.join(" ")},__class__:le};var ue=function(t){if(this.values=[],null!=t)for(;t.hasNext();)this.insert(t.next())};ue.__name__=!0,ue.prototype={count:function(){return this.values.length},insert:function(t){-1==this.values.indexOf(t)&&this.values.push(t)},contains:function(t){return-1!=this.values.indexOf(t)},remove:function(t){u.remove(this.values,t)},removeAll:function(){this.values.splice(0,this.values.length)},copy:function(){return new ue(this.iterator())},union:function(t){for(var e=new ue,s=0,i=this.values;s<i.length;)e.insert(i[s++]);for(s=0;s<t.length;)e.insert(t[s++]);return e},subtracting:function(t){for(var e=new ue,s=0,i=this.values;s<i.length;){var n=i[s];++s,-1==t.indexOf(n)&&e.insert(n)}return e},iterator:function(){return new os(this.values)},toArray:function(){return this.values},__class__:ue};var _e=function(){this.progress=0};_e.__name__=!0,_e.prototype={extractNewData:function(t,e){var s;if(e)s=t.length;else{if((s=t.lastIndexOf("\r\n"))<0)return[];s+=2}if(s<=this.progress)return[];var i=t.substring(this.progress,s);return this.progress=s,i.split("\r\n")},streamProgress:function(t){return this.extractNewData(t,!1)},streamComplete:function(t){return this.extractNewData(t,!0)},__class__:_e};var de={_new:function(t){return t},toMillis:function(t){return t},toLong:function(t){return t}},fe={_new:function(t){return t},now:function(){var t=process.hrtime();return t[0]+t[1]/1e9},plus:function(t,e){return 1e3*t+e},minus:function(t,e){return 1e3*(t-e)},toFloat:function(t){return t}},me=function(t,e,s){var i=this;this.task=new qt(global.setTimeout((function(){s(i)}),e))};me.__name__=!0,me.__interfaces__=[ee],me.prototype={cancel:function(){this.task.cancel()},isCanceled:function(){return null==this.task.handle},__class__:me};var ge=h["com.lightstreamer.internal.FieldValue"]={__ename__:!0,__constructs__:null,unchanged:{_hx_name:"unchanged",_hx_index:0,__enum__:"com.lightstreamer.internal.FieldValue",toString:o},changed:(i=function(t){return{_hx_index:1,val:t,__enum__:"com.lightstreamer.internal.FieldValue",toString:o}},i._hx_name="changed",i.__params__=["val"],i),jsonPatch:(i=function(t){return{_hx_index:2,patch:t,__enum__:"com.lightstreamer.internal.FieldValue",toString:o}},i._hx_name="jsonPatch",i.__params__=["patch"],i),diffPatch:(i=function(t){return{_hx_index:3,patch:t,__enum__:"com.lightstreamer.internal.FieldValue",toString:o}},i._hx_name="diffPatch",i.__params__=["patch"],i)};ge.__constructs__=[ge.unchanged,ge.changed,ge.jsonPatch,ge.diffPatch];var pe={_new:function(t){return t},fromIntGt0:function(t){if(t<=0)throw new zt("value must be greater than zero");return t},fromIntGtEq0:function(t){if(t<0)throw new zt("value must be greater than or equal to zero");return t},gti:function(t,e){return t>e},gt:function(t,e){return t>e},lt:function(t,e){return t<e},plus:function(t,e){return t+e},minus:function(t,e){return t-e},toInt:function(t){return t}},ve={_new:function(t){return t},fromIntGt0:function(t){if(t<=0)throw new zt("value must be greater than zero");return t}},Se={fromString:function(t){if(null==t)return null;switch(t){case"HTTP":return"HTTP";case"HTTP-POLLING":return"HTTP-POLLING";case"HTTP-STREAMING":return"HTTP-STREAMING";case"WS":return"WS";case"WS-POLLING":return"WS-POLLING";case"WS-STREAMING":return"WS-STREAMING";default:throw new zt("The given value is not valid. Use one of: HTTP-STREAMING, HTTP-POLLING, WS-STREAMING, WS-POLLING, WS, HTTP or null")}}},ye={_new:function(t){return t},fromString:function(t){if(null==t)return null;if(p.startsWith(t,"http://")||p.startsWith(t,"https://"))return t;throw new zt("address is malformed")}},be=h["com.lightstreamer.internal.RequestedMaxBandwidth"]={__ename__:!0,__constructs__:null,BWLimited:(i=function(t){return{_hx_index:0,bw:t,__enum__:"com.lightstreamer.internal.RequestedMaxBandwidth",toString:o}},i._hx_name="BWLimited",i.__params__=["bw"],i),BWUnlimited:{_hx_name:"BWUnlimited",_hx_index:1,__enum__:"com.lightstreamer.internal.RequestedMaxBandwidth",toString:o}};be.__constructs__=[be.BWLimited,be.BWUnlimited];var Ee=function(){};Ee.__name__=!0,Ee.fromString=function(t){var e;if("unlimited"==t.toLowerCase())return be.BWUnlimited;if(e=parseFloat(t),!isNaN(e)&&e>0)return be.BWLimited(e);throw new zt('The given value is a not valid value for RequestedMaxBandwidth. Use a positive number or the string "unlimited"')},Ee.toString=function(t){switch(t._hx_index){case 0:var e=t.bw;return null==e?"null":""+e;case 1:return"unlimited"}};var we=h["com.lightstreamer.internal.RequestedBufferSize"]={__ename__:!0,__constructs__:null,BSLimited:(i=function(t){return{_hx_index:0,size:t,__enum__:"com.lightstreamer.internal.RequestedBufferSize",toString:o}},i._hx_name="BSLimited",i.__params__=["size"],i),BSUnlimited:{_hx_name:"BSUnlimited",_hx_index:1,__enum__:"com.lightstreamer.internal.RequestedBufferSize",toString:o}};we.__constructs__=[we.BSLimited,we.BSUnlimited];var Te=function(){};Te.__name__=!0,Te.fromString=function(t){if(null==t)return null;var e;if("unlimited"==t.toLowerCase())return we.BSUnlimited;if(null!=(e=m.parseInt(t))&&e>0)return we.BSLimited(e);throw new zt("The given value is not valid for this setting; use null, 'unlimited' or a positive integer instead")},Te.toString=function(t){if(null==t)return null;switch(t._hx_index){case 0:var e=t.size;return null==e?"null":""+e;case 1:return"unlimited"}},Te.extEquals=function(t,e){return null==t?null==e:null!=e&&v.enumEq(t,e)};var Re=h["com.lightstreamer.internal.RequestedSnapshot"]={__ename__:!0,__constructs__:null,SnpYes:{_hx_name:"SnpYes",_hx_index:0,__enum__:"com.lightstreamer.internal.RequestedSnapshot",toString:o},SnpNo:{_hx_name:"SnpNo",_hx_index:1,__enum__:"com.lightstreamer.internal.RequestedSnapshot",toString:o},SnpLength:(i=function(t){return{_hx_index:2,len:t,__enum__:"com.lightstreamer.internal.RequestedSnapshot",toString:o}},i._hx_name="SnpLength",i.__params__=["len"],i)};Re.__constructs__=[Re.SnpYes,Re.SnpNo,Re.SnpLength];var xe=function(){};xe.__name__=!0,xe.fromString=function(t){if(null==t)return null;var e;switch(t.toLowerCase()){case"no":return Re.SnpNo;case"yes":return Re.SnpYes;default:if(null!=(e=m.parseInt(t))&&e>0)return Re.SnpLength(e);throw new zt("The given value is not valid for this setting; use null, 'yes', 'no' or a positive number instead")}},xe.toString=function(t){if(null==t)return null;switch(t._hx_index){case 0:return"yes";case 1:return"no";case 2:var e=t.len;return null==e?"null":""+e}};var Ce=h["com.lightstreamer.internal.RequestedMaxFrequency"]={__ename__:!0,__constructs__:null,FreqLimited:(i=function(t){return{_hx_index:0,max:t,__enum__:"com.lightstreamer.internal.RequestedMaxFrequency",toString:o}},i._hx_name="FreqLimited",i.__params__=["max"],i),FreqUnlimited:{_hx_name:"FreqUnlimited",_hx_index:1,__enum__:"com.lightstreamer.internal.RequestedMaxFrequency",toString:o},FreqUnfiltered:{_hx_name:"FreqUnfiltered",_hx_index:2,__enum__:"com.lightstreamer.internal.RequestedMaxFrequency",toString:o}};Ce.__constructs__=[Ce.FreqLimited,Ce.FreqUnlimited,Ce.FreqUnfiltered];var Ie=function(){};Ie.__name__=!0,Ie.fromString=function(t){if(null==t)return null;var e;switch(t.toLowerCase()){case"unfiltered":return Ce.FreqUnfiltered;case"unlimited":return Ce.FreqUnlimited;default:if(e=parseFloat(t),!isNaN(e)&&e>0)return Ce.FreqLimited(e);throw new zt("The given value is not valid for this setting; use null, 'unlimited', 'unfiltered' or a positive number instead")}},Ie.toString=function(t){if(null==t)return null;switch(t._hx_index){case 0:var e=t.max;return null==e?"null":""+e;case 1:return"unlimited";case 2:return"unfiltered"}},Ie.extEquals=function(t,e){return null==t?null==e:null!=e&&v.enumEq(t,e)};var Le=h["com.lightstreamer.internal.RealMaxFrequency"]={__ename__:!0,__constructs__:null,RFreqLimited:(i=function(t){return{_hx_index:0,freq:t,__enum__:"com.lightstreamer.internal.RealMaxFrequency",toString:o}},i._hx_name="RFreqLimited",i.__params__=["freq"],i),RFreqUnlimited:{_hx_name:"RFreqUnlimited",_hx_index:1,__enum__:"com.lightstreamer.internal.RealMaxFrequency",toString:o}};Le.__constructs__=[Le.RFreqLimited,Le.RFreqUnlimited];var De=h["com.lightstreamer.internal.RealMaxBandwidth"]={__ename__:!0,__constructs__:null,BWLimited:(i=function(t){return{_hx_index:0,bw:t,__enum__:"com.lightstreamer.internal.RealMaxBandwidth",toString:o}},i._hx_name="BWLimited",i.__params__=["bw"],i),BWUnlimited:{_hx_name:"BWUnlimited",_hx_index:1,__enum__:"com.lightstreamer.internal.RealMaxBandwidth",toString:o},BWUnmanaged:{_hx_name:"BWUnmanaged",_hx_index:2,__enum__:"com.lightstreamer.internal.RealMaxBandwidth",toString:o}};De.__constructs__=[De.BWLimited,De.BWUnlimited,De.BWUnmanaged];var Ne=function(){};Ne.__name__=!0,Ne.toString=function(t){if(null==t)return null;switch(t._hx_index){case 0:var e=t.bw;return null==e?"null":""+e;case 1:return"unlimited";case 2:return"unmanaged"}},Ne.eq=function(t,e){return null==t?null==e:null!=e&&v.enumEq(t,e)};var Oe={fromString:function(t){switch(t){case"COMMAND":return"COMMAND";case"DISTINCT":return"DISTINCT";case"MERGE":return"MERGE";case"RAW":return"RAW";default:throw new zt("The given value is not a valid subscription mode. Admitted values are MERGE, DISTINCT, RAW, COMMAND")}}},ke={_new:function(t){return t},getPos:function(t,e){var s=t.indexOf(e);return-1!=s?s+1:-1},allValidNames:function(t){return!d.exists(t,(function(t){return new l("^$| |^\\d+$","").match(t)}))},fromArray:function(t){if(null==t)return null;if(0==t.length)throw new zt("Item List is empty");if(ke.allValidNames(t))return t;throw new zt("Item List is invalid")}},Pe={_new:function(t){return t},getPos:function(t,e){var s=t.indexOf(e);return-1!=s?s+1:-1},hasKeyField:function(t){return-1!=t.indexOf("key")},hasCommandField:function(t){return-1!=t.indexOf("command")},fromArray:function(t){if(null==t)return null;if(0==t.length)throw new zt("Field List is empty");if(d.exists(t,(function(t){return new l("^$| ","").match(t)})))throw new zt("Field List is invalid");return t}},Me={};function Fe(t,e){return null==t?null==e:null!=e&&v.enumEq(t,e)}Me._new=function(t){return t},Me.fromString=function(t){if(null==t)return null;if(""==t)throw new zt("The value is empty");return t};var qe=function(t,e){var s=t.indexOf("://");-1!=s?(this._protocol=t.substring(0,s)+":",t=t.substring(s+3)):this._protocol="";var i=t.indexOf("/");-1!=i?(this._pathname=t.substring(i),t=t.substring(0,i)):this._pathname="/";var n=this.extractPortStart(t);-1!=n?(this._port=t.substring(n),this._hostname=t.substring(0,n-1)):(this._port="",this._hostname=t),null!=e&&this.set_pathname(e)};qe.__name__=!0,qe.build=function(t,e){if(null!=e){var s=p.endsWith(t,"/"),i=p.startsWith(e,"/");t+=s?i?e.substring(1):e:i?e:"/"+e}return t},qe.completeControlLink=function(t,e){var s=new qe(e),i=new qe(t);return""==i.get_protocol()&&i.set_protocol(s.get_protocol()),""==i.get_port()&&i.set_port(s.get_port()),i.get_href()},qe.prototype={get_protocol:function(){return this._protocol},set_protocol:function(t){return""==t||p.endsWith(t,":")||(t+=":"),this._protocol=t,this._protocol},get_hostname:function(){return this._hostname},set_hostname:function(t){return this._hostname=t,this._hostname},get_port:function(){return this._port},set_port:function(t){return this._port=t,this._port},get_pathname:function(){return this._pathname},set_pathname:function(t){return p.startsWith(t,"/")||(t="/"+t),this._pathname=t,this._pathname},get_href:function(){var t=this._hostname;return""!=this._protocol&&(t=this._protocol+"//"+t),""!=this._port&&(t+=":"+this._port),""!=this.get_pathname()&&(t+=this._pathname),t},toString:function(){return this.get_href()},extractPortStart:function(t){var e=t.indexOf(":");return e<=-1?-1:t.indexOf("]")>-1?(e=t.indexOf("]:"))<=-1?-1:e+2:e!=t.lastIndexOf(":")?-1:e+1},__class__:qe};var Ae=function(t,e,s,i,n){this.isCanceled=!1;var r=this;p.startsWith(t,"https://")?t=p.replace(t,"https://","wss://"):p.startsWith(t,"http://")&&(t=p.replace(t,"http://","ws://")),Os.isDebugEnabled()&&Os.debug("WS connecting: "+t);var a={perMessageDeflate:!1};if(null!=e){a.headers={};for(var o=e.h,h=Object.keys(o),c=h.length,l=0;l<c;){var u=h[l++];a.headers[u]=o[u]}}var _=Mt.instance.getCookieHeader(t);0==_._hx_index&&(null==a.headers&&(a.headers={}),a.headers.Cookie=_.v),this.ws=new ds(t,Rs,a),this.ws.on("open",(function(){r.isCanceled||(Os.isDebugEnabled()&&Os.debug("WS event: open"),s(r))})),this.ws.on("message",(function(t){if(!r.isCanceled){var e=r.ws;if("nodebuffer"!=e.binaryType)throw Gt.thrown("Cannot get buffer when bufferType is "+e.binaryType);for(var s=0,n=t.toString("utf8").split("\r\n");s<n.length;){var a=n[s];if(++s,r.isCanceled)return;""!=a&&(Os.isDebugEnabled()&&Os.debug("WS event: text("+a+")"),i(r,a))}}})),this.ws.on("error",(function(t){if(!r.isCanceled){var e="Network error: "+t.name+" - "+t.message;Os.isDebugEnabled()&&Os.debug("WS event: error("+e+")",t),n(r,e),r.ws.terminate()}})),this.ws.on("close",(function(t,e){if(!r.isCanceled){var s="unexpected disconnection: "+t+" - "+e;Os.isDebugEnabled()&&Os.debug("WS event: error("+s+")"),n(r,s),r.ws.terminate()}})),this.ws.on("upgrade",(function(e){if(!r.isCanceled){var s=r.getCookies(e.headers);null!=s&&Mt.instance.addCookies(t,s)}}))};Ae.__name__=!0,Ae.__interfaces__=[te],Ae.prototype={getCookies:function(t){for(var e=f.fields(t),s=0;s<e.length;){var i=e[s++];if("set-cookie"==i.toLowerCase())return t[i]}return null},send:function(t){Os.isDebugEnabled()&&Os.debug("WS sending: "+t),this.ws.send(t,null,null)},dispose:function(){Os.isDebugEnabled()&&Os.debug("WS disposing"),this.isCanceled=!0,this.ws.terminate()},isDisposed:function(){return this.isCanceled},__class__:Ae};var We=function(t,e){this.buf=new g,this.basePos=0,this.diffPos=0,this.diff=e,this.base=t};We.__name__=!0,We.apply=function(t,e){return new We(t,e).decode()},We.prototype={decode:function(){try{for(;this.diffPos!=this.diff.length&&(this.applyCopy(),this.diffPos!=this.diff.length)&&(this.applyAdd(),this.diffPos!=this.diff.length);)this.applyDel();return this.buf.b}catch(t){throw new Gt("Bad TLCP-diff",Gt.caught(t))}},applyCopy:function(){var t=this.decodeVarint();t>0&&(this.appendToBuf(this.base,this.basePos,t),this.basePos+=t)},applyAdd:function(){var t=this.decodeVarint();t>0&&(this.appendToBuf(this.diff,this.diffPos,t),this.diffPos+=t)},applyDel:function(){var t=this.decodeVarint();t>0&&(this.basePos+=t)},decodeVarint:function(){for(var t=0;;){var e=this.charAt(this.diff,this.diffPos);if(this.diffPos+=1,e>=97&&e<123)return 26*t+(e-97);if(!(e>=65&&e<91))throw new Gt("The code point "+e+" is not in the range A-Z");t=26*t+(e-65)}},appendToBuf:function(t,e,s){if(!(e+s<=t.length))throw new Gt("Index out of range: startIndex="+e+" count="+s+" length="+t.length);this.buf.b+=u.substr(t,e,null==s?null:s)},charAt:function(t,e){if(e<t.length)return u.cca(t.charAt(e),0);throw new Gt("Index out of range: pos="+e+" length="+t.length)},__class__:We};var Be={_new:function(t){return JSON.parse(t)},apply:function(t,e){return He.apply_patch(t,e)},toString:function(t){return JSON.stringify(t)}},He=require("jsonpatch"),Ue=function(){};Ue.__name__=!0,Ue.__interfaces__=[t],Ue.prototype={__class__:Ue};var Ve=a.LSConsoleLogLevel=function(){};Ve.__name__=!0,Ve.prototype={__class__:Ve};var Ke=a.LSConsoleLoggerProvider=function(t){this.level=t};Ke.__name__=!0,Ke.__interfaces__=[e],Ke.prototype={getLogger:function(t){return new Ge(this.level,t)},__class__:Ke};var Ge=function(t,e){this.level=t,this.category=e,this.traceEnabled=t<=Ve.TRACE,this.debugEnabled=t<=Ve.DEBUG,this.infoEnabled=t<=Ve.INFO,this.warnEnabled=t<=Ve.WARN,this.errorEnabled=t<=Ve.ERROR,this.fatalEnabled=t<=Ve.FATAL};Ge.__name__=!0,Ge.__super__=Ue,Ge.prototype=c(Ue.prototype,{printLog:function(t){s.console.log(t)},format:function(t,e){return u.dateStr(new Date)+"|"+t+"|"+this.category+"|"+e},logFatal:function(t){s.console.log(t)},logError:function(t){s.console.log(t)},logWarn:function(t){s.console.log(t)},logInfo:function(t){s.console.log(t)},logDebug:function(t){s.console.log(t)},logTrace:function(t){s.console.log(t)},fatal:function(t,e){if(this.fatalEnabled){var i=this.format("FATAL",t);if(s.console.log(i),null!=e){i=Gt.caught(e).details();s.console.log(i)}}},error:function(t,e){if(this.errorEnabled){var i=this.format("ERROR",t);if(s.console.log(i),null!=e){i=Gt.caught(e).details();s.console.log(i)}}},warn:function(t,e){if(this.warnEnabled){var i=this.format("WARN ",t);if(s.console.log(i),null!=e){i=Gt.caught(e).details();s.console.log(i)}}},info:function(t,e){if(this.infoEnabled){var i=this.format("INFO ",t);if(s.console.log(i),null!=e){i=Gt.caught(e).details();s.console.log(i)}}},debug:function(t,e){if(this.debugEnabled){var i=this.format("DEBUG",t);if(s.console.log(i),null!=e){i=Gt.caught(e).details();s.console.log(i)}}},trace:function(t,e){if(this.traceEnabled){var i=this.format("TRACE",t);if(s.console.log(i),null!=e){i=Gt.caught(e).details();s.console.log(i)}}},isFatalEnabled:function(){return this.fatalEnabled},isErrorEnabled:function(){return this.errorEnabled},isWarnEnabled:function(){return this.warnEnabled},isInfoEnabled:function(){return this.infoEnabled},isDebugEnabled:function(){return this.debugEnabled},isTraceEnabled:function(){return this.traceEnabled},__class__:Ge});var ze=function(){};ze.__name__=!0,ze.__super__=Ue,ze.prototype=c(Ue.prototype,{fatal:function(t,e){},error:function(t,e){},warn:function(t,e){},info:function(t,e){},debug:function(t,e){},trace:function(t,e){},isFatalEnabled:function(){return!1},isErrorEnabled:function(){return!1},isWarnEnabled:function(){return!1},isInfoEnabled:function(){return!1},isDebugEnabled:function(){return!1},isTraceEnabled:function(){return!1},__class__:ze});var Ye=function(){};Ye.__name__=!0,Ye.getLogger=function(t){return Ye.lock.synchronized((function(){var e=Ye.logInstances.h[t];if(null==e){var s=new Qe(null==Ye.currentLoggerProvider?Ye.emptyLogger:Ye.currentLoggerProvider.getLogger(t));Ye.logInstances.h[t]=s,e=s}return e}))},Ye.setLoggerProvider=function(t){Ye.lock.synchronized((function(){Ye.currentLoggerProvider=t;for(var e=Ye.logInstances.h,s=Object.keys(e),i=s.length,n=0;n<i;){var r=s[n++];e[r].wrappedLogger=null==Ye.currentLoggerProvider?Ye.emptyLogger:Ye.currentLoggerProvider.getLogger(r)}}))},Ye.newLogger=function(t){return null==Ye.currentLoggerProvider?Ye.emptyLogger:Ye.currentLoggerProvider.getLogger(t)};var Qe=function(t){this.wrappedLogger=t};Qe.__name__=!0,Qe.__super__=Ue,Qe.prototype=c(Ue.prototype,{fatal:function(t,e){this.wrappedLogger.fatal(t,e)},error:function(t,e){this.wrappedLogger.error(t,e)},warn:function(t,e){this.wrappedLogger.warn(t,e)},info:function(t,e){this.wrappedLogger.info(t,e)},debug:function(t,e){this.wrappedLogger.debug(t,e)},trace:function(t,e){this.wrappedLogger.trace(t,e)},isFatalEnabled:function(){return this.wrappedLogger.isFatalEnabled()},isErrorEnabled:function(){return this.wrappedLogger.isErrorEnabled()},isWarnEnabled:function(){return this.wrappedLogger.isWarnEnabled()},isInfoEnabled:function(){return this.wrappedLogger.isInfoEnabled()},isDebugEnabled:function(){return this.wrappedLogger.isDebugEnabled()},isTraceEnabled:function(){return this.wrappedLogger.isTraceEnabled()},__class__:Qe});var je=require("cookiejar").CookieAccessInfo,Je=require("cookiejar").CookieJar,$e=h["haxe.StackItem"]={__ename__:!0,__constructs__:null,CFunction:{_hx_name:"CFunction",_hx_index:0,__enum__:"haxe.StackItem",toString:o},Module:(i=function(t){return{_hx_index:1,m:t,__enum__:"haxe.StackItem",toString:o}},i._hx_name="Module",i.__params__=["m"],i),FilePos:(i=function(t,e,s,i){return{_hx_index:2,s:t,file:e,line:s,column:i,__enum__:"haxe.StackItem",toString:o}},i._hx_name="FilePos",i.__params__=["s","file","line","column"],i),Method:(i=function(t,e){return{_hx_index:3,classname:t,method:e,__enum__:"haxe.StackItem",toString:o}},i._hx_name="Method",i.__params__=["classname","method"],i),LocalFunction:(i=function(t){return{_hx_index:4,v:t,__enum__:"haxe.StackItem",toString:o}},i._hx_name="LocalFunction",i.__params__=["v"],i)};$e.__constructs__=[$e.CFunction,$e.Module,$e.FilePos,$e.Method,$e.LocalFunction];var Ze={toString:function(t){for(var e=new g,s=0,i=t;s<i.length;){var n=i[s++];e.b+="\nCalled from ",Ze.itemToString(e,n)}return e.b},subtract:function(t,e){for(var s=-1,i=-1;++i<t.length;){for(var n=0,r=e.length;n<r;)if(Ze.equalItems(t[i],e[n++])){if(s<0&&(s=i),++i>=t.length)break}else s=-1;if(s>=0)break}return s>=0?t.slice(0,s):t},equalItems:function(t,e){if(null==t)return null==e;switch(t._hx_index){case 0:return null!=e&&0==e._hx_index;case 1:return null!=e&&(1==e._hx_index&&t.m==e.m);case 2:return null!=e&&(2==e._hx_index&&(t.file==e.file&&t.line==e.line&&t.column==e.column&&Ze.equalItems(t.s,e.s)));case 3:return null!=e&&(3==e._hx_index&&(t.classname==e.classname&&t.method==e.method));case 4:return null!=e&&(4==e._hx_index&&t.v==e.v)}},itemToString:function(t,e){switch(e._hx_index){case 0:t.b+="a C function";break;case 1:var s=e.m;t.b=(t.b+="module ")+(null==s?"null":""+s);break;case 2:s=e.s;var i=e.file,n=e.line,r=e.column;null!=s&&(Ze.itemToString(t,s),t.b+=" ("),t.b=(t.b+=null==i?"null":""+i)+" line ",t.b+=null==n?"null":""+n,null!=r&&(t.b=(t.b+=" column ")+(null==r?"null":""+r)),null!=s&&(t.b+=")");break;case 3:s=e.classname,i=e.method;t.b=(t.b+=m.string(null==s?"<unknown>":s))+".",t.b+=null==i?"null":""+i;break;case 4:s=e.v;t.b=(t.b+="local function #")+(null==s?"null":""+s)}}},Xe=function(){};Xe.__name__=!0,Xe.toHaxe=function(t,e){if(null==e&&(e=0),null==t)return[];if("string"==typeof t){var s=t.split("\n");"Error"==s[0]&&s.shift();for(var i=[],n=0,r=s.length;n<r;){var a=n++;if(!(e>a)){var o=s[a],h=o.match(/^    at ([$A-Za-z0-9_. ]+) \(([^)]+):([0-9]+):([0-9]+)\)$/);if(null!=h){var c=h[1].split(".");"$hxClasses"==c[0]&&c.shift();var l=c.pop(),u=h[2],_=m.parseInt(h[3]),d=m.parseInt(h[4]);i.push($e.FilePos("Anonymous function"==l?$e.LocalFunction():"Global code"==l?null:$e.Method(c.join("."),l),u,_,d))}else i.push($e.Module(p.trim(o)))}}return i}return e>0&&Array.isArray(t)?t.slice(e):t},Xe.normalize=function(t,e){if(null==e&&(e=0),Array.isArray(t)&&e>0)return t.slice(e);if("string"==typeof t){switch(t.substring(0,6)){case"Error\n":case"Error:":++e}return Xe.skipLines(t,e)}return t},Xe.skipLines=function(t,e,s){for(null==s&&(s=0);;){if(e>0){if((s=t.indexOf("\n",s))<0)return"";e=--e,s+=1;continue}return t.substring(s)}};var ts=function(t,e,s){Gt.call(this,String(t),e,s),this.value=t,this.__skipStack++};ts.__name__=!0,ts.__super__=Gt,ts.prototype=c(Gt.prototype,{__class__:ts});var es=function(){this.h={}};es.__name__=!0,es.__interfaces__=[$t],es.prototype={get:function(t){return this.h[t]},remove:function(t){return!!this.h.hasOwnProperty(t)&&(delete this.h[t],!0)},keys:function(){var t=[];for(var e in this.h)this.h.hasOwnProperty(e)&&t.push(+e);return new os(t)},iterator:function(){return{ref:this.h,it:this.keys(),hasNext:function(){return this.it.hasNext()},next:function(){var t=this.it.next();return this.ref[t]}}},copy:function(){for(var t=new es,e=this.keys();e.hasNext();){var s=e.next();t.h[s]=this.h[s]}return t},__class__:es};var ss=h["haxe.ds.Option"]={__ename__:!0,__constructs__:null,Some:(i=function(t){return{_hx_index:0,v:t,__enum__:"haxe.ds.Option",toString:o}},i._hx_name="Some",i.__params__=["v"],i),None:{_hx_name:"None",_hx_index:1,__enum__:"haxe.ds.Option",toString:o}};ss.__constructs__=[ss.Some,ss.None];var is=function(){this.h=Object.create(null)};is.__name__=!0,is.__interfaces__=[$t],is.createCopy=function(t){var e=new is;for(var s in t)e.h[s]=t[s];return e},is.stringify=function(t){var e="[",s=!0;for(var i in t)s?s=!1:e+=",",e+=i+" => "+m.string(t[i]);return e+"]"},is.prototype={get:function(t){return this.h[t]},keys:function(){return new ns(this.h)},iterator:function(){return new rs(this.h)},__class__:is};var ns=function(t){this.h=t,this.keys=Object.keys(t),this.length=this.keys.length,this.current=0};ns.__name__=!0,ns.prototype={hasNext:function(){return this.current<this.length},next:function(){return this.keys[this.current++]},__class__:ns};var rs=function(t){this.h=t,this.keys=Object.keys(t),this.length=this.keys.length,this.current=0};rs.__name__=!0,rs.prototype={hasNext:function(){return this.current<this.length},next:function(){return this.h[this.keys[this.current++]]},__class__:rs};var as=h["haxe.io.Error"]={__ename__:!0,__constructs__:null,Blocked:{_hx_name:"Blocked",_hx_index:0,__enum__:"haxe.io.Error",toString:o},Overflow:{_hx_name:"Overflow",_hx_index:1,__enum__:"haxe.io.Error",toString:o},OutsideBounds:{_hx_name:"OutsideBounds",_hx_index:2,__enum__:"haxe.io.Error",toString:o},Custom:(i=function(t){return{_hx_index:3,e:t,__enum__:"haxe.io.Error",toString:o}},i._hx_name="Custom",i.__params__=["e"],i)};as.__constructs__=[as.Blocked,as.Overflow,as.OutsideBounds,as.Custom];var os=function(t){this.current=0,this.array=t};os.__name__=!0,os.prototype={hasNext:function(){return this.current<this.array.length},next:function(){return this.array[this.current++]},__class__:os};var hs=function(t){this.map=t,this.keys=t.keys()};hs.__name__=!0,hs.prototype={hasNext:function(){return this.keys.hasNext()},next:function(){var t=this.keys.next();return{value:this.map.get(t),key:t}},__class__:hs};var cs=function(t,e,s){Gt.call(this,t,s),this.pos=e,this.__skipStack++};cs.__name__=!0,cs.__super__=Gt,cs.prototype=c(Gt.prototype,{__class__:cs});var ls=function(){};ls.__name__=!0,ls.getClass=function(t){if(null==t)return null;if(t instanceof Array)return Array;var e=t.__class__;if(null!=e)return e;var s=ls.__nativeClassName(t);return null!=s?ls.__resolveNativeClass(s):null},ls.__string_rec=function(t,e){if(null==t)return"null";if(e.length>=5)return"<...>";var s=typeof t;switch("function"==s&&(t.__name__||t.__ename__)&&(s="object"),s){case"function":return"<function>";case"object":if(t.__enum__){var i=h[t.__enum__].__constructs__[t._hx_index],n=i._hx_name;return i.__params__?(e+="\t",n+"("+function(s){for(var n=[],r=0,a=i.__params__;r<a.length;){var o=a[r];r+=1,n.push(ls.__string_rec(t[o],e))}return n}().join(",")+")"):n}if(t instanceof Array){var r="[";e+="\t";for(var a=0,o=t.length;a<o;){var c=a++;r+=(c>0?",":"")+ls.__string_rec(t[c],e)}return r+="]"}var l;try{l=t.toString}catch(a){return"???"}if(null!=l&&l!=Object.toString&&"function"==typeof l){var u=t.toString();if("[object Object]"!=u)return u}r="{\n";e+="\t";var _=null!=t.hasOwnProperty,d=null;for(d in t)_&&!t.hasOwnProperty(d)||"prototype"!=d&&"__class__"!=d&&"__super__"!=d&&"__interfaces__"!=d&&"__properties__"!=d&&(2!=r.length&&(r+=", \n"),r+=e+d+" : "+ls.__string_rec(t[d],e));return r+="\n"+(e=e.substring(1))+"}";case"string":return t;default:return String(t)}},ls.__interfLoop=function(t,e){for(;;){if(null==t)return!1;if(t==e)return!0;var s=t.__interfaces__;if(null!=s)for(var i=0,n=s.length;i<n;){var r=s[i++];if(r==e||ls.__interfLoop(r,e))return!0}t=t.__super__}},ls.__instanceof=function(t,e){if(null==e)return!1;switch(e){case Array:return t instanceof Array;case ys:return"boolean"==typeof t;case vs:return null!=t;case Ss:return"number"==typeof t;case ps:return"number"==typeof t&&(0|t)===t;case String:return"string"==typeof t;default:if(null==t)return!1;if("function"==typeof e){if(ls.__downcastCheck(t,e))return!0}else if("object"==typeof e&&ls.__isNativeObj(e)&&t instanceof e)return!0;return e==bs&&null!=t.__name__||(e==Es&&null!=t.__ename__||null!=t.__enum__&&h[t.__enum__]==e)}},ls.__downcastCheck=function(t,e){return t instanceof e||!!e.__isInterface__&&ls.__interfLoop(ls.getClass(t),e)},ls.__cast=function(t,e){if(null==t||ls.__instanceof(t,e))return t;throw Gt.thrown("Cannot cast "+m.string(t)+" to "+m.string(e))},ls.__nativeClassName=function(t){var e=ls.__toStr.call(t).slice(8,-1);return"Object"==e||"Function"==e||"Math"==e||"JSON"==e?null:e},ls.__isNativeObj=function(t){return null!=ls.__nativeClassName(t)},ls.__resolveNativeClass=function(t){return s[t]};var us=function(){};us.__name__=!0,us.sliceImpl=function(t,e){var s=new Uint8Array(this,t,null==e?null:e-t),i=new Uint8Array(s.byteLength);return i.set(s),i.buffer};var _s=require("url").URL,ds=require("ws"),fs=require("xmlhttprequest").XMLHttpRequest;function ms(t){return t instanceof Array?new os(t):t.iterator()}function gs(t,e){return null==e?null:(null==e.__id__&&(e.__id__=s.$haxeUID++),null==t.hx__closures__?t.hx__closures__={}:i=t.hx__closures__[e.__id__],null==i&&(i=e.bind(t),t.hx__closures__[e.__id__]=i),i);var i}s.$haxeUID|=0,"undefined"!=typeof performance&&"function"==typeof performance.now&&(u.now=performance.now.bind(performance)),Object.defineProperty(String.prototype,"__class__",{value:String,enumerable:!1,writable:!0}),String.__name__=!0,Array.__name__=!0,Date.prototype.__class__=Date,Date.__name__="Date";var ps={},vs={},Ss=Number,ys=Boolean,bs={},Es={};ls.__toStr={}.toString,null==ArrayBuffer.prototype.slice&&(ArrayBuffer.prototype.slice=us.sliceImpl);var ws=null,Ts="TLCP-2.5.0",Rs=Ts+".lightstreamer.com",xs="tqGko0tg4pkpW3EAM3O4hwLri8M4OC63i7x",Cs="";w.LIB_NAME="nodejs_client",w.LIB_VERSION="9.2.2 build 20250131",L.frz_globalPageLifecycle=I.newLoggingInstance();var Is=new TextDecoder;ct.EOL_LEN=ct.lengthOfBytes("\r\n");var Ls="The Subscription was initiated using a Field Schema: the field names are not available",Ds="The field position is out of bounds",Ns="The field name is unknown";Mt.instance=new Mt,At.instance=new At,pe.ZERO=0,Se.WS="WS",Se.WS_STREAMING="WS-STREAMING",Se.WS_POLLING="WS-POLLING",Se.HTTP="HTTP",Se.HTTP_STREAMING="HTTP-STREAMING",Se.HTTP_POLLING="HTTP-POLLING",Oe.Merge="MERGE",Oe.Distinct="DISTINCT",Oe.Command="COMMAND",Oe.Raw="RAW",We.VARINT_RADIX=26,Ve.TRACE=0,Ve.DEBUG=10,Ve.INFO=20,Ve.WARN=30,Ve.ERROR=40,Ve.FATAL=50,Ye.lock=new oe,Ye.logInstances=new is,Ye.emptyLogger=new ze;var Os=Ye.getLogger("lightstreamer.stream"),ks=Ye.getLogger("lightstreamer.protocol"),Ps=Ye.getLogger("lightstreamer.internal"),Ms=Ye.getLogger("lightstreamer.session"),Fs=Ye.getLogger("lightstreamer.actions"),qs=Ye.getLogger("lightstreamer.reachability"),As=Ye.getLogger("lightstreamer.subscriptions"),Ws=Ye.getLogger("lightstreamer.messages"),Bs=Ye.getLogger("lightstreamer.cookies"),Hs=Ye.getLogger("lightstreamer.page")}("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:void 0);var o=a.LSLightstreamerClient,h=a.LSSubscription,c=a.LSConsoleLogLevel,l=a.LSConsoleLoggerProvider,u=function(t){this.delegate=t};u.prototype={setContentLength:function(t){this.delegate.setContentLength(t)},getContentLength:function(){return this.delegate.getContentLength()},setIdleTimeout:function(t){this.delegate.setIdleTimeout(t)},getIdleTimeout:function(){return this.delegate.getIdleTimeout()},setKeepaliveInterval:function(t){this.delegate.setKeepaliveInterval(t)},getKeepaliveInterval:function(){return this.delegate.getKeepaliveInterval()},setRequestedMaxBandwidth:function(t){this.delegate.setRequestedMaxBandwidth(t)},getRequestedMaxBandwidth:function(){return this.delegate.getRequestedMaxBandwidth()},getRealMaxBandwidth:function(){return this.delegate.getRealMaxBandwidth()},setPollingInterval:function(t){this.delegate.setPollingInterval(t)},getPollingInterval:function(){return this.delegate.getPollingInterval()},setReconnectTimeout:function(t){this.delegate.setReconnectTimeout(t)},getReconnectTimeout:function(){return this.delegate.getReconnectTimeout()},setStalledTimeout:function(t){this.delegate.setStalledTimeout(t)},getStalledTimeout:function(){return this.delegate.getStalledTimeout()},setRetryDelay:function(t){this.delegate.setRetryDelay(t)},getRetryDelay:function(){return this.delegate.getRetryDelay()},setFirstRetryMaxDelay:function(t){this.delegate.setFirstRetryMaxDelay(t)},getFirstRetryMaxDelay:function(){return this.delegate.getFirstRetryMaxDelay()},setSlowingEnabled:function(t){this.delegate.setSlowingEnabled(t)},isSlowingEnabled:function(){return this.delegate.isSlowingEnabled()},setForcedTransport:function(t){this.delegate.setForcedTransport(t)},getForcedTransport:function(){return this.delegate.getForcedTransport()},setServerInstanceAddressIgnored:function(t){this.delegate.setServerInstanceAddressIgnored(t)},isServerInstanceAddressIgnored:function(){return this.delegate.isServerInstanceAddressIgnored()},setCookieHandlingRequired:function(t){this.delegate.setCookieHandlingRequired(t)},isCookieHandlingRequired:function(){return this.delegate.isCookieHandlingRequired()},setReverseHeartbeatInterval:function(t){this.delegate.setReverseHeartbeatInterval(t)},getReverseHeartbeatInterval:function(){return this.delegate.getReverseHeartbeatInterval()},setHttpExtraHeaders:function(t){this.delegate.setHttpExtraHeaders(t)},getHttpExtraHeaders:function(){return this.delegate.getHttpExtraHeaders()},setHttpExtraHeadersOnSessionCreationOnly:function(t){this.delegate.setHttpExtraHeadersOnSessionCreationOnly(t)},isHttpExtraHeadersOnSessionCreationOnly:function(){return this.delegate.isHttpExtraHeadersOnSessionCreationOnly()},setSessionRecoveryTimeout:function(t){this.delegate.setSessionRecoveryTimeout(t)},getSessionRecoveryTimeout:function(){return this.delegate.getSessionRecoveryTimeout()}};var _=function(t){this.delegate=t};_.prototype={setServerAddress:function(t){this.delegate.setServerAddress(t)},getServerAddress:function(){return this.delegate.getServerAddress()},setAdapterSet:function(t){this.delegate.setAdapterSet(t)},getAdapterSet:function(){return this.delegate.getAdapterSet()},setUser:function(t){this.delegate.setUser(t)},getUser:function(){return this.delegate.getUser()},setPassword:function(t){this.delegate.setPassword(t)},getServerInstanceAddress:function(){return this.delegate.getServerInstanceAddress()},getServerSocketName:function(){return this.delegate.getServerSocketName()},getSessionId:function(){return this.delegate.getSessionId()},getClientIp:function(){return this.delegate.getClientIp()}};var d=function(t,e){this.delegate=new o(t,e),this.connectionOptions=new u(this.delegate.connectionOptions),this.connectionDetails=new _(this.delegate.connectionDetails)};d.addCookies=function(t,e){o.addCookies(t,e)},d.getCookies=function(t){return o.getCookies(t)},d.setLoggerProvider=function(t){o.setLoggerProvider(t)},d.LIB_NAME=o.LIB_NAME,d.LIB_VERSION=o.LIB_VERSION,d.prototype={connect:function(){this.delegate.connect()},disconnect:function(){this.delegate.disconnect()},getStatus:function(){return this.delegate.getStatus()},sendMessage:function(t,e,s,i,n){this.delegate.sendMessage(t,e,s,i,n)},getSubscriptions:function(){return this.delegate.getSubscriptionWrappers()},subscribe:function(t){this.delegate.subscribe(t.delegate)},unsubscribe:function(t){this.delegate.unsubscribe(t.delegate)},addListener:function(t){this.delegate.addListener(t)},removeListener:function(t){this.delegate.removeListener(t)},getListeners:function(){return this.delegate.getListeners()}};var f=function(t,e,s){this.delegate=new h(t,e,s,this)};f.prototype={isActive:function(){return this.delegate.isActive()},isSubscribed:function(){return this.delegate.isSubscribed()},setItems:function(t){this.delegate.setItems(t)},getItems:function(){return this.delegate.getItems()},setItemGroup:function(t){this.delegate.setItemGroup(t)},getItemGroup:function(){return this.delegate.getItemGroup()},setFields:function(t){this.delegate.setFields(t)},getFields:function(){return this.delegate.getFields()},setFieldSchema:function(t){this.delegate.setFieldSchema(t)},getFieldSchema:function(){return this.delegate.getFieldSchema()},getMode:function(){return this.delegate.getMode()},setDataAdapter:function(t){this.delegate.setDataAdapter(t)},getDataAdapter:function(){return this.delegate.getDataAdapter()},setSelector:function(t){this.delegate.setSelector(t)},getSelector:function(){return this.delegate.getSelector()},setRequestedMaxFrequency:function(t){this.delegate.setRequestedMaxFrequency(t)},getRequestedMaxFrequency:function(){return this.delegate.getRequestedMaxFrequency()},setRequestedBufferSize:function(t){this.delegate.setRequestedBufferSize(t)},getRequestedBufferSize:function(){return this.delegate.getRequestedBufferSize()},setRequestedSnapshot:function(t){this.delegate.setRequestedSnapshot(t)},getRequestedSnapshot:function(){return this.delegate.getRequestedSnapshot()},setCommandSecondLevelFields:function(t){this.delegate.setCommandSecondLevelFields(t)},getCommandSecondLevelFields:function(){return this.delegate.getCommandSecondLevelFields()},setCommandSecondLevelFieldSchema:function(t){this.delegate.setCommandSecondLevelFieldSchema(t)},getCommandSecondLevelFieldSchema:function(){return this.delegate.getCommandSecondLevelFieldSchema()},setCommandSecondLevelDataAdapter:function(t){this.delegate.setCommandSecondLevelDataAdapter(t)},getCommandSecondLevelDataAdapter:function(){return this.delegate.getCommandSecondLevelDataAdapter()},getValue:function(t,e){return this.delegate.getValue(t,e)},getCommandValue:function(t,e,s){return this.delegate.getCommandValue(t,e,s)},getKeyPosition:function(){return this.delegate.getKeyPosition()},getCommandPosition:function(){return this.delegate.getCommandPosition()},addListener:function(t){this.delegate.addListener(t)},removeListener:function(t){this.delegate.removeListener(t)},getListeners:function(){return this.delegate.getListeners()}};var m=function(){};m.TRACE=c.TRACE,m.DEBUG=c.DEBUG,m.INFO=c.INFO,m.WARN=c.WARN,m.ERROR=c.ERROR,m.FATAL=c.FATAL;var g=function(t){this.delegate=new l(t)};g.prototype.getLogger=function(t){return this.delegate.getLogger(t)},exports.ClientListener=s,exports.ClientMessageListener=i,exports.ConsoleLogLevel=m,exports.ConsoleLoggerProvider=g,exports.ItemUpdate=n,exports.LightstreamerClient=d,exports.Logger=t,exports.LoggerProvider=e,exports.Subscription=f,exports.SubscriptionListener=r;
//# sourceMappingURL=lightstreamer-node.min.js.map
